================================================================================
üì¶ REPOSITORY SETUP
================================================================================

üìÇ Repository not found, cloning...

================================================================================
üîÑ Cloning repository
================================================================================
‚úÖ Cloning repository - Complete

üìç Current directory: /kaggle/working/integrated-pipeline
üìù Latest commit: 141dca1 Add Kaggle pull and run scripts

================================================================================
üîç VERIFYING TASK 12 IMPLEMENTATION
================================================================================
  ‚úÖ TASK_12_COMPLETE.md
  ‚úÖ TASK_12_PERFORMANCE_REPORTING_VERIFICATION.md
  ‚úÖ PERFORMANCE_REPORTING_QUICK_REFERENCE.md
  ‚úÖ .kiro/specs/model-training-fixes/tasks.md

‚úÖ All Task 12 files present

üîç Verifying reporting methods...
  ‚úÖ generate_summary_report() method found
  ‚úÖ _generate_symbol_markdown_report() method found

================================================================================
üì¶ INSTALLING DEPENDENCIES
================================================================================

Installing packages (this may take a few minutes)...
  ‚úÖ torch
  ‚úÖ scikit-fuzzy
  ‚úÖ xgboost
  ‚úÖ scikit-learn
  ‚úÖ imbalanced-learn
  ‚úÖ pandas
  ‚úÖ numpy
  ‚úÖ joblib
  ‚úÖ matplotlib
  ‚úÖ seaborn

‚úÖ Dependencies installed

================================================================================
üîß ENVIRONMENT SETUP
================================================================================
‚úÖ Added /kaggle/working/integrated-pipeline to Python path

================================================================================
üöÄ RUNNING COMPLETE PIPELINE
================================================================================

This will:
  1. Run data preparation pipeline
  2. Train all models for all symbols
  3. Select best models per symbol
  4. Generate performance reports (Task 12)
  5. Save deployment manifest

================================================================================


================================================================================
üöÄ KAGGLE SMC PIPELINE - COMPLETE EXECUTION
================================================================================

‚ö†Ô∏è  Removing existing repository...

üì• Cloning repository from GitHub...
   URL: https://github.com/Morriase/integrated-pipeline.git
   Target: /kaggle/working/integrated-pipeline
‚úÖ Repository cloned successfully

================================================================================
üìÇ Verifying Dataset
================================================================================
‚úÖ Dataset verified: 68 CSV files found

================================================================================
üì¶ Installing Dependencies
================================================================================
‚ö†Ô∏è  torch - failed
‚ö†Ô∏è  scikit-fuzzy - failed
‚ö†Ô∏è  xgboost - failed
‚ö†Ô∏è  scikit-learn - failed
‚ö†Ô∏è  imbalanced-learn - failed
‚ö†Ô∏è  pandas - failed
‚ö†Ô∏è  numpy - failed
‚ö†Ô∏è  joblib - failed
‚ö†Ô∏è  matplotlib - failed
‚ö†Ô∏è  seaborn - failed

‚ö†Ô∏è  Failed packages: torch, scikit-fuzzy, xgboost, scikit-learn, imbalanced-learn, pandas, numpy, joblib, matplotlib, seaborn
Continuing anyway - some may already be installed...

================================================================================
üêç Setting up Python Environment
================================================================================
Working directory: /kaggle/working/integrated-pipeline
Python path: /kaggle/working/integrated-pipeline
‚úÖ Environment ready

================================================================================
üìä RUNNING DATA PIPELINE
================================================================================

================================================================================
COMPLETE SMC DATA PIPELINE WORKFLOW
================================================================================

================================================================================
STEP 1: CONSOLIDATING MT5 EXPORT FILES
================================================================================

üìä Configuration: FULL (All symbols, all timeframes)
================================================================================
MT5 DATA CONSOLIDATION
================================================================================

üìÇ Found 68 CSV files in /kaggle/input/ob-ai-model-2-dataset/Data/mt5_exports
  ‚úì AUDJPY   M15 : 10,000 rows | 2025-05-16 16:45:00 to 2025-10-09 20:30:00
  ‚úì XAUUSD   M5  : 10,000 rows | 2025-08-20 04:00:00 to 2025-10-09 20:35:00
  ‚úì GBPUSD   M15 : 10,000 rows | 2025-05-16 15:45:00 to 2025-10-09 19:45:00
  ‚úì AUDUSD   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì USDCAD   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDJPY   H4  : 10,000 rows | 2019-05-09 16:00:00 to 2025-10-09 20:00:00
  ‚úì EURUSD   M30 : 10,000 rows | 2024-12-19 12:00:00 to 2025-10-09 19:30:00
  ‚úì USDCAD   M15 : 10,000 rows | 2025-05-16 16:00:00 to 2025-10-09 20:00:00
  ‚úì USDCHF   M5  : 10,000 rows | 2025-08-21 20:10:00 to 2025-10-09 19:55:00
  ‚úì AUDNZD   D1  : 6,524 rows | 2000-03-30 00:00:00 to 2025-10-09 00:00:00
  ‚úì EURUSD   H1  : 10,000 rows | 2024-03-04 03:00:00 to 2025-10-09 19:00:00
  ‚úì AUDCHF   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDUSD   M30 : 10,000 rows | 2024-12-19 12:30:00 to 2025-10-09 20:00:00
  ‚úì EURUSD   H4  : 10,000 rows | 2019-05-09 16:00:00 to 2025-10-09 16:00:00
  ‚úì USDJPY   M30 : 10,000 rows | 2024-12-19 12:30:00 to 2025-10-09 20:00:00
  ‚úì AUDCHF   M1  : 10,000 rows | 2025-09-30 19:57:00 to 2025-10-09 20:28:00
  ‚úì AUDNZD   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì AUDUSD   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDCAD   M30 : 10,000 rows | 2024-12-19 12:00:00 to 2025-10-09 20:00:00
  ‚úì AUDCHF   M5  : 10,000 rows | 2025-08-21 21:15:00 to 2025-10-09 20:25:00
  ‚úì AUDCAD   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì GBPUSD   M30 : 10,000 rows | 2024-12-19 12:00:00 to 2025-10-09 19:30:00
  ‚úì AUDNZD   M15 : 10,000 rows | 2025-05-16 16:30:00 to 2025-10-09 20:15:00
  ‚úì USDCAD   M30 : 10,000 rows | 2024-12-19 12:30:00 to 2025-10-09 20:00:00
  ‚úì USDCHF   M30 : 10,000 rows | 2024-12-19 12:00:00 to 2025-10-09 19:30:00
  ‚úì AUDCHF   M30 : 10,000 rows | 2024-12-19 12:30:00 to 2025-10-09 20:00:00
  ‚úì EURUSD   M1  : 10,000 rows | 2025-09-30 19:12:00 to 2025-10-09 19:52:00
  ‚úì AUDCAD   M15 : 10,000 rows | 2025-05-16 16:00:00 to 2025-10-09 20:15:00
  ‚úì AUDNZD   M30 : 10,000 rows | 2024-12-19 12:00:00 to 2025-10-09 20:00:00
  ‚úì USDJPY   M5  : 10,000 rows | 2025-08-21 20:25:00 to 2025-10-09 20:00:00
  ‚úì GBPUSD   M5  : 10,000 rows | 2025-08-21 20:10:00 to 2025-10-09 19:50:00
  ‚úì AUDCHF   D1  : 6,545 rows | 2000-03-30 00:00:00 to 2025-10-09 00:00:00
  ‚úì USDCAD   M5  : 10,000 rows | 2025-08-21 20:10:00 to 2025-10-09 20:05:00
  ‚úì XAUUSD   M30 : 10,000 rows | 2024-12-04 15:30:00 to 2025-10-09 20:30:00
  ‚úì XAUUSD   M1  : 10,000 rows | 2025-09-30 13:13:00 to 2025-10-09 20:37:00
  ‚úì USDCAD   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì GBPUSD   H1  : 10,000 rows | 2024-03-04 03:00:00 to 2025-10-09 19:00:00
  ‚úì AUDCAD   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDNZD   M5  : 10,000 rows | 2025-08-21 21:10:00 to 2025-10-09 20:15:00
  ‚úì AUDCAD   D1  : 6,614 rows | 2000-03-30 00:00:00 to 2025-10-09 00:00:00
  ‚úì USDCAD   M1  : 10,000 rows | 2025-09-30 18:07:00 to 2025-10-09 20:06:00
  ‚úì USDJPY   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDUSD   M5  : 10,000 rows | 2025-08-21 20:20:00 to 2025-10-09 20:10:00
  ‚úì USDCHF   M1  : 10,000 rows | 2025-09-30 18:54:00 to 2025-10-09 19:57:00
  ‚úì AUDUSD   M15 : 10,000 rows | 2025-05-16 16:15:00 to 2025-10-09 20:00:00
  ‚úì EURUSD   D1  : 6,637 rows | 2000-03-29 00:00:00 to 2025-10-09 00:00:00
  ‚úì XAUUSD   M15 : 10,000 rows | 2025-05-09 16:15:00 to 2025-10-09 20:30:00
  ‚úì AUDJPY   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì USDCHF   H4  : 10,000 rows | 2019-05-09 16:00:00 to 2025-10-09 16:00:00
  ‚úì AUDNZD   M1  : 10,000 rows | 2025-09-30 20:02:00 to 2025-10-09 20:17:00
  ‚úì USDJPY   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì GBPUSD   H4  : 10,000 rows | 2019-05-09 16:00:00 to 2025-10-09 16:00:00
  ‚úì AUDCAD   M1  : 10,000 rows | 2025-09-30 19:49:00 to 2025-10-09 20:23:00
  ‚úì USDCHF   H1  : 10,000 rows | 2024-03-04 03:00:00 to 2025-10-09 19:00:00
  ‚úì EURUSD   M5  : 10,000 rows | 2025-08-21 20:35:00 to 2025-10-09 19:50:00
  ‚úì AUDJPY   M5  : 10,000 rows | 2025-08-21 21:05:00 to 2025-10-09 20:30:00
  ‚úì AUDJPY   M1  : 10,000 rows | 2025-09-30 20:10:00 to 2025-10-09 20:33:00
  ‚úì AUDCAD   M5  : 10,000 rows | 2025-08-21 21:00:00 to 2025-10-09 20:20:00
  ‚úì USDJPY   M1  : 10,000 rows | 2025-09-30 18:59:00 to 2025-10-09 20:02:00
  ‚úì AUDNZD   H1  : 10,000 rows | 2024-03-04 04:00:00 to 2025-10-09 20:00:00
  ‚úì AUDUSD   M1  : 10,000 rows | 2025-09-30 18:31:00 to 2025-10-09 20:11:00
  ‚úì USDCHF   M15 : 10,000 rows | 2025-05-16 15:45:00 to 2025-10-09 19:45:00
  ‚úì AUDCHF   H4  : 10,000 rows | 2019-05-09 20:00:00 to 2025-10-09 20:00:00
  ‚úì EURUSD   M15 : 10,000 rows | 2025-05-16 16:00:00 to 2025-10-09 19:45:00
  ‚úì AUDCHF   M15 : 10,000 rows | 2025-05-16 16:30:00 to 2025-10-09 20:15:00
  ‚úì AUDJPY   M30 : 10,000 rows | 2024-12-19 12:30:00 to 2025-10-09 20:30:00
  ‚úì USDJPY   M15 : 10,000 rows | 2025-05-16 16:15:00 to 2025-10-09 20:00:00
  ‚úì GBPUSD   M1  : 10,000 rows | 2025-09-30 18:24:00 to 2025-10-09 19:52:00

üîó Consolidating 68 files...

üìä Consolidated Data Summary:
  Total rows: 666,320
  Symbols: 11
  Timeframes: 7
  Date range: 2000-03-29 00:00:00 to 2025-10-09 20:37:00

  Symbol breakdown:
    AUDCAD  : 66,614 rows
    AUDCHF  : 66,545 rows
    AUDJPY  : 60,000 rows
    AUDNZD  : 66,524 rows
    AUDUSD  : 60,000 rows
    EURUSD  : 66,637 rows
    GBPUSD  : 60,000 rows
    USDCAD  : 60,000 rows
    USDCHF  : 60,000 rows
    USDJPY  : 60,000 rows
    XAUUSD  : 40,000 rows

  Timeframe breakdown:
    D1  : 26,320 rows
    H1  : 100,000 rows
    H4  : 100,000 rows
    M1  : 110,000 rows
    M15 : 110,000 rows
    M30 : 110,000 rows
    M5  : 110,000 rows

üíæ Saved consolidated data:
  File: /kaggle/working/consolidated_ohlc_data.csv
  Size: 39.09 MB
  Processed: 68 files
  Skipped: 0 files

‚úÖ Consolidation complete!

üéØ Next step: Run data_preparation_pipeline.py with input: /kaggle/working/consolidated_ohlc_data.csv

‚è±Ô∏è Step 1 completed in 6.82 seconds

================================================================================
STEP 2: PROCESSING SMC FEATURES WITH FUZZY LOGIC
================================================================================
üß† Fuzzy Logic SMC Detection Active
   Quality threshold: 0.2

================================================================================
INSTITUTIONAL-GRADE SMC DATA PREPARATION PIPELINE
With Fuzzy Logic Integration
================================================================================

üìÇ Loading raw data from: /kaggle/working/consolidated_ohlc_data.csv
‚úì Loaded 666,320 rows
  Symbols: 11
  Timeframes: ['D1', 'H1', 'H4', 'M1', 'M15', 'M30', 'M5']
  Date range: 2000-03-29 00:00:00 to 2025-10-09 20:37:00

üîß Processing SMC features for all symbols and timeframes...

  Phase 1: Processing individual timeframes...
  Processing AUDCAD D1...
    ‚úì Valid entries: 220, Labeled: 220
  Processing AUDCAD H1...
    ‚úì Valid entries: 292, Labeled: 292
  Processing AUDCAD H4...
    ‚úì Valid entries: 306, Labeled: 306
  Processing AUDCAD M1...
    ‚úì Valid entries: 397, Labeled: 397
  Processing AUDCAD M15...
    ‚úì Valid entries: 353, Labeled: 353
  Processing AUDCAD M30...
    ‚úì Valid entries: 329, Labeled: 329
  Processing AUDCAD M5...
    ‚úì Valid entries: 319, Labeled: 319
  Processing AUDCHF D1...
    ‚úì Valid entries: 217, Labeled: 217
  Processing AUDCHF H1...
    ‚úì Valid entries: 343, Labeled: 343
  Processing AUDCHF H4...
    ‚úì Valid entries: 363, Labeled: 363
  Processing AUDCHF M1...
    ‚úì Valid entries: 370, Labeled: 370
  Processing AUDCHF M15...
    ‚úì Valid entries: 389, Labeled: 389
  Processing AUDCHF M30...
    ‚úì Valid entries: 359, Labeled: 359
  Processing AUDCHF M5...
    ‚úì Valid entries: 329, Labeled: 329
  Processing AUDJPY D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing AUDJPY H1...
    ‚úì Valid entries: 365, Labeled: 365
  Processing AUDJPY H4...
    ‚úì Valid entries: 345, Labeled: 345
  Processing AUDJPY M1...
    ‚úì Valid entries: 421, Labeled: 421
  Processing AUDJPY M15...
    ‚úì Valid entries: 345, Labeled: 345
  Processing AUDJPY M30...
    ‚úì Valid entries: 349, Labeled: 349
  Processing AUDJPY M5...
    ‚úì Valid entries: 311, Labeled: 311
  Processing AUDNZD D1...
    ‚úì Valid entries: 215, Labeled: 215
  Processing AUDNZD H1...
    ‚úì Valid entries: 267, Labeled: 267
  Processing AUDNZD H4...
    ‚úì Valid entries: 321, Labeled: 321
  Processing AUDNZD M1...
    ‚úì Valid entries: 279, Labeled: 279
  Processing AUDNZD M15...
    ‚úì Valid entries: 259, Labeled: 259
  Processing AUDNZD M30...
    ‚úì Valid entries: 269, Labeled: 269
  Processing AUDNZD M5...
    ‚úì Valid entries: 255, Labeled: 255
  Processing AUDUSD D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing AUDUSD H1...
    ‚úì Valid entries: 377, Labeled: 377
  Processing AUDUSD H4...
    ‚úì Valid entries: 382, Labeled: 382
  Processing AUDUSD M1...
    ‚úì Valid entries: 478, Labeled: 478
  Processing AUDUSD M15...
    ‚úì Valid entries: 377, Labeled: 377
  Processing AUDUSD M30...
    ‚úì Valid entries: 376, Labeled: 376
  Processing AUDUSD M5...
    ‚úì Valid entries: 334, Labeled: 334
  Processing EURUSD D1...
    ‚úì Valid entries: 254, Labeled: 254
  Processing EURUSD H1...
    ‚úì Valid entries: 340, Labeled: 340
  Processing EURUSD H4...
    ‚úì Valid entries: 377, Labeled: 377
  Processing EURUSD M1...
    ‚úì Valid entries: 472, Labeled: 472
  Processing EURUSD M15...
    ‚úì Valid entries: 337, Labeled: 337
  Processing EURUSD M30...
    ‚úì Valid entries: 343, Labeled: 343
  Processing EURUSD M5...
    ‚úì Valid entries: 345, Labeled: 345
  Processing GBPUSD D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing GBPUSD H1...
    ‚úì Valid entries: 316, Labeled: 316
  Processing GBPUSD H4...
    ‚úì Valid entries: 371, Labeled: 371
  Processing GBPUSD M1...
    ‚úì Valid entries: 513, Labeled: 513
  Processing GBPUSD M15...
    ‚úì Valid entries: 304, Labeled: 304
  Processing GBPUSD M30...
    ‚úì Valid entries: 359, Labeled: 359
  Processing GBPUSD M5...
    ‚úì Valid entries: 387, Labeled: 387
  Processing USDCAD D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing USDCAD H1...
    ‚úì Valid entries: 290, Labeled: 290
  Processing USDCAD H4...
    ‚úì Valid entries: 382, Labeled: 382
  Processing USDCAD M1...
    ‚úì Valid entries: 546, Labeled: 546
  Processing USDCAD M15...
    ‚úì Valid entries: 304, Labeled: 304
  Processing USDCAD M30...
    ‚úì Valid entries: 333, Labeled: 333
  Processing USDCAD M5...
    ‚úì Valid entries: 347, Labeled: 347
  Processing USDCHF D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing USDCHF H1...
    ‚úì Valid entries: 321, Labeled: 321
  Processing USDCHF H4...
    ‚úì Valid entries: 334, Labeled: 334
  Processing USDCHF M1...
    ‚úì Valid entries: 535, Labeled: 535
  Processing USDCHF M15...
    ‚úì Valid entries: 318, Labeled: 318
  Processing USDCHF M30...
    ‚úì Valid entries: 365, Labeled: 365
  Processing USDCHF M5...
    ‚úì Valid entries: 380, Labeled: 380
  Processing USDJPY D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing USDJPY H1...
    ‚úì Valid entries: 345, Labeled: 345
  Processing USDJPY H4...
    ‚úì Valid entries: 383, Labeled: 383
  Processing USDJPY M1...
    ‚úì Valid entries: 507, Labeled: 507
  Processing USDJPY M15...
    ‚úì Valid entries: 405, Labeled: 405
  Processing USDJPY M30...
    ‚úì Valid entries: 400, Labeled: 400
  Processing USDJPY M5...
    ‚úì Valid entries: 342, Labeled: 342
  Processing XAUUSD D1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing XAUUSD H1...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing XAUUSD H4...
    ‚ö†Ô∏è Insufficient data (0 rows), skipping
  Processing XAUUSD M1...
    ‚úì Valid entries: 427, Labeled: 427
  Processing XAUUSD M15...
    ‚úì Valid entries: 400, Labeled: 400
  Processing XAUUSD M30...
    ‚úì Valid entries: 397, Labeled: 397
  Processing XAUUSD M5...
    ‚úì Valid entries: 373, Labeled: 373

  Phase 2: Adding multi-timeframe confluence...

‚úì Processing complete: 478,353 total rows

üîç Validating Pipeline Output...

======================================================================
  ‚úì OB Detection
  ‚úì OB Displacement
  ‚úì FVG Detection
  ‚úì Market Structure
  ‚úì TBM Labeling
  ‚úì MTF Confluence
  ‚úì Regime Classification
  ‚úì Feature Standardization
  ‚úì Fuzzy Logic
  ‚úì Has Labeled Data
======================================================================

‚úÖ All validation checks passed!

üìä INSTITUTIONAL-GRADE SMC PIPELINE SUMMARY
================================================================================

üìà Dataset Overview:
  Total rows: 478,353
  Symbols: 11
  Timeframes: ['M15', nan, 'H1', 'H4']
  Date range: 2019-05-09 16:00:00 to 2025-10-09 20:30:00

üèõÔ∏è SMC Structures Detected (Fuzzy Logic):
  Order Blocks (Bullish): 19,843.0
  Order Blocks (Bearish): 19,998.0
  Fair Value Gaps (Bullish): 11,652.0
  Fair Value Gaps (Bearish): 11,808.0

üìê Market Structure (BOS & ChoCH):
  BOS Wick Breaks: 104,139.0
  BOS Close Breaks (High Conviction): 49,937.0
  BOS Commitment Flags: 49,937.0
  ChoCH Detected: 20,535.0

üß† Fuzzy Logic Quality Scores:
  Order Block Quality:
    Average: 0.546
    Min: 0.200, Max: 1.000
    Median: 0.521
  Fair Value Gap Quality:
    Average: 0.611
    Min: 0.200, Max: 1.000
    Median: 0.621

üîó Multi-Timeframe Confluence:
  Setups with HTF OB Confluence: 0
  Setups with HTF FVG Confluence: 0
  Setups with HTF Trend Alignment: 168,353

‚úÖ Valid Setups (After Regime Filtering):
  Valid Bullish OBs: 2,396
  Valid Bearish OBs: 2,281
  Valid Bullish FVGs: 3,020
  Valid Bearish FVGs: 2,951

üéØ Triple Barrier Method (TBM) Labels:
  Total labeled entries: 10,611
    Loss    :  4,365 ( 41.1%)
    Timeout :    815 (  7.7%)
    Win     :  5,431 ( 51.2%)

  Win Rate (excl. timeouts): 55.4%
  Loss Rate (excl. timeouts): 44.6%
  Average Bars to Hit Target: 4.4

üåê Market Regime Distribution (Fuzzy Logic):
  Normal              :  115,950 ( 24.2%)
  Low_Vol             :   91,964 ( 19.2%)
  High_Vol            :   39,267 (  8.2%)
  Low_Vol_Chop        :   37,568 (  7.9%)
  High_Vol_Trend      :   25,251 (  5.3%)

üìä Feature Engineering (ATR Normalization + Z-Score):
  Z-Score Standardized Features: 9
    - OB_Displacement_Mag_ZScore
    - ATR_ZScore
    - OB_Displacement_ATR_ZScore
    - Displacement_Mag_ZScore
    - OB_Size_ATR_ZScore
    ... and 4 more

================================================================================

‚úÖ PIPELINE VALIDATION:
  ‚úì Order Block Detection (with displacement validation)
  ‚úì Fair Value Gap Detection (with mitigation tracking)
  ‚úì Market Structure (BOS & ChoCH)
  ‚úì Triple Barrier Method Labeling
  ‚úì Multi-Timeframe Confluence
  ‚úì Contextual Filtering & Regime Classification
  ‚úì ATR Normalization + Z-Score Standardization
  ‚úì Fuzzy Logic Integration (adaptive thresholds)

================================================================================

üíæ Saving processed data to: /kaggle/working/processed_smc_data.csv
‚úì Saved full dataset: 478,353 rows (200.71 MB)

üìä Splitting data with fuzzy quality stratification...
  AUDCAD: Stratified by fuzzy quality (3 strata)
  ‚ö†Ô∏è Skipping nan - insufficient data
  AUDCHF: Stratified by fuzzy quality (3 strata)
  AUDJPY: Stratified by fuzzy quality (3 strata)
  AUDNZD: Stratified by fuzzy quality (3 strata)
  AUDUSD: Stratified by fuzzy quality (3 strata)
  EURUSD: Stratified by fuzzy quality (3 strata)
  GBPUSD: Stratified by fuzzy quality (3 strata)
‚úì Saved test split: 16,518 rows (10.09 MB)

üîç Validating fuzzy quality distribution across splits...

  OB_Quality_Fuzzy:
    Split    Mean     Std      Q25      Q50      Q75     
    --------------------------------------------------------
    train    0.072    0.197    0.000    0.000    0.000   
    val      0.072    0.198    0.000    0.000    0.000   
    test     0.072    0.197    0.000    0.000    0.000   

  FVG_Quality_Fuzzy:
    Split    Mean     Std      Q25      Q50      Q75     
    --------------------------------------------------------
    train    0.049    0.178    0.000    0.000    0.000   
    val      0.051    0.181    0.000    0.000    0.000   
    test     0.052    0.182    0.000    0.000    0.000   

  HTF_Confluence_Quality:
    Split    Mean     Std      Q25      Q50      Q75     
    --------------------------------------------------------
    train    0.000    0.000    0.000    0.000    0.000   
    val      0.000    0.000    0.000    0.000    0.000   
    test     0.000    0.000    0.000    0.000    0.000   

  Distribution Consistency Check:
    ‚úì OB_Quality_Fuzzy: Train-Test difference = 0.4%
    ‚úì FVG_Quality_Fuzzy: Train-Test difference = 5.2%
    ‚ö†Ô∏è HTF_Confluence_Quality: Train-Test difference = nan%
‚úì Saved quality statistics
‚úì Saved feature list: 58 features

‚úÖ Pipeline complete! Data ready for ML training.

================================================================================
PIPELINE COMPLETE!
================================================================================

‚è±Ô∏è Execution Time:
  Step 1 (Consolidation): 6.82s
  Step 2 (SMC Processing): 1905.64s
  Total: 1912.46s (31.87 minutes)

üìÅ Output Files:

  Consolidated Data:
    /kaggle/working/consolidated_ohlc_data.csv

  Processed Data:
    /kaggle/working/processed_smc_data.csv
    /kaggle/working/processed_smc_data_train.csv
    /kaggle/working/processed_smc_data_val.csv
    /kaggle/working/processed_smc_data_test.csv
    /kaggle/working/processed_smc_data_feature_list.txt
    /kaggle/working/processed_smc_data_quality_stats.txt

üéØ Next Steps:
  1. Review the summary report above
  2. Check feature_list.txt for ML features
  3. Load train/val/test splits for model training
  4. Train your ML model (Random Forest, XGBoost, Neural Network)
  5. Predict TBM_Label (-1=Loss, 0=Timeout, 1=Win)

‚úÖ All done! Your data is ready for ML training.

‚úÖ Data pipeline completed
   Processed: 478,353 rows

================================================================================
ü§ñ TRAINING ALL MODELS
================================================================================

üîç Checking data availability...
  ‚úì Train data: /kaggle/working/processed_smc_data_train.csv
  ‚úì Val data:   /kaggle/working/processed_smc_data_val.csv
  ‚úì Test data:  /kaggle/working/processed_smc_data_test.csv

üìä Available symbols: ['AUDCAD', 'AUDCHF', 'AUDJPY', 'AUDNZD', 'AUDUSD', 'EURUSD', 'GBPUSD', 'USDCAD', 'USDCHF', 'USDJPY', 'XAUUSD']

üìä Training 11 symbols: ['AUDCAD', 'AUDCHF', 'AUDJPY', 'AUDNZD', 'AUDUSD', 'EURUSD', 'GBPUSD', 'USDCAD', 'USDCHF', 'USDJPY', 'XAUUSD']

################################################################################
# TRAINING: AUDCAD
################################################################################

################################################################################
# Training All Models for AUDCAD
################################################################################

üå≤ Starting RandomForest training for AUDCAD...

================================================================================
Training Random Forest for AUDCAD
================================================================================

üìÇ Loading data for AUDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 225 samples
  Val:   46 samples
  Test:  59 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for AUDCAD...
  Training samples: 225
  Features: 57

  üìä Dataset has 225 samples (< 300), applying augmentation...
  Augmented: 225 ‚Üí 460 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for AUDCAD...
  Training samples: 368
  Features: 57

  Train accuracy: 0.848
  Val accuracy:   0.804
  Train-Val gap:  0.043
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0843
    TBM_Reward_Per_Trade_ATR                : 0.0662
    TBM_Risk_Per_Trade_ATR                  : 0.0588
    TBM_Bars_to_Hit                         : 0.0586
    FVG_Distance_to_Price_ATR_ZScore        : 0.0511
    FVG_Distance_to_Price_ATR               : 0.0410
    FVG_Depth_ATR_ZScore                    : 0.0409
    FVG_Size_Fuzzy_Score                    : 0.0406
    FVG_Mitigated                           : 0.0400
    Distance_to_Entry_ATR                   : 0.0378
  Fold 1/5: Accuracy=0.804, F1=0.803

üå≤ Training Random Forest for AUDCAD...
  Training samples: 368
  Features: 57

  Train accuracy: 0.845
  Val accuracy:   0.696
  Train-Val gap:  0.149
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    TBM_Reward_Per_Trade_ATR                : 0.0795
    TBM_Risk_Per_Trade_ATR                  : 0.0751
    OB_Age                                  : 0.0732
    TBM_Bars_to_Hit                         : 0.0602
    FVG_Distance_to_Price_ATR_ZScore        : 0.0601
    FVG_Distance_to_Price_ATR               : 0.0474
    FVG_Depth_ATR_ZScore                    : 0.0461
    FVG_Size_Fuzzy_Score                    : 0.0444
    FVG_Depth_ATR                           : 0.0398
    FVG_Mitigated                           : 0.0382
  Fold 2/5: Accuracy=0.696, F1=0.693

üå≤ Training Random Forest for AUDCAD...
  Training samples: 368
  Features: 57

  Train accuracy: 0.829
  Val accuracy:   0.717
  Train-Val gap:  0.111
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    TBM_Reward_Per_Trade_ATR                : 0.0786
    TBM_Risk_Per_Trade_ATR                  : 0.0759
    OB_Age                                  : 0.0742
    TBM_Bars_to_Hit                         : 0.0585
    FVG_Distance_to_Price_ATR_ZScore        : 0.0450
    Distance_to_Entry_ATR                   : 0.0437
    FVG_Quality_Fuzzy                       : 0.0412
    FVG_Mitigated                           : 0.0412
    Displacement_Mag_ZScore                 : 0.0405
    FVG_Size_Fuzzy_Score                    : 0.0393
  Fold 3/5: Accuracy=0.717, F1=0.714

üå≤ Training Random Forest for AUDCAD...
  Training samples: 368
  Features: 57

  Train accuracy: 0.845
  Val accuracy:   0.783
  Train-Val gap:  0.062
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    TBM_Reward_Per_Trade_ATR                : 0.0901
    TBM_Risk_Per_Trade_ATR                  : 0.0797
    TBM_Bars_to_Hit                         : 0.0718
    OB_Age                                  : 0.0653
    FVG_Distance_to_Price_ATR_ZScore        : 0.0502
    Distance_to_Entry_ATR                   : 0.0448
    FVG_Distance_to_Price_ATR               : 0.0415
    FVG_Depth_ATR_ZScore                    : 0.0378
    FVG_Mitigated                           : 0.0337
    FVG_Quality_Fuzzy                       : 0.0330
  Fold 4/5: Accuracy=0.783, F1=0.781

üå≤ Training Random Forest for AUDCAD...
  Training samples: 368
  Features: 57

  Train accuracy: 0.842
  Val accuracy:   0.783
  Train-Val gap:  0.060
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    TBM_Reward_Per_Trade_ATR                : 0.0827
    TBM_Risk_Per_Trade_ATR                  : 0.0805
    TBM_Bars_to_Hit                         : 0.0554
    FVG_Depth_ATR_ZScore                    : 0.0501
    OB_Age                                  : 0.0480
    FVG_Size_Fuzzy_Score                    : 0.0449
    Distance_to_Entry_ATR                   : 0.0414
    FVG_Distance_to_Price_ATR_ZScore        : 0.0397
    FVG_Depth_ATR                           : 0.0359
    FVG_Distance_to_Price_ATR               : 0.0351
  Fold 5/5: Accuracy=0.783, F1=0.783

  Cross-Validation Results:
    Mean Accuracy: 0.757 ¬± 0.042
    Min Accuracy:  0.696
    Max Accuracy:  0.804
    Range:         0.109
    Mean F1-Score: 0.755 ¬± 0.043
    ‚úÖ STABLE: Std dev 0.042 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.696 (deviation: -0.061)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: AUDCAD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for AUDCAD...

================================================================================
Training XGBoost for AUDCAD
================================================================================

üìÇ Loading data for AUDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 225 samples
  Val:   46 samples
  Test:  59 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for AUDCAD...
  Training samples: 225
  Features: 57

  Train accuracy: 0.938
  Val accuracy:   0.630
  Best iteration: 200

  Top 10 Most Important Features:
    TBM_Reward_Per_Trade_ATR                : 0.1055
    OB_Age                                  : 0.0966
    TBM_Bars_to_Hit                         : 0.0496
    OB_Displacement_Fuzzy_Score             : 0.0464
    FVG_Size_Fuzzy_Score                    : 0.0430
    TBM_Risk_Per_Trade_ATR                  : 0.0395
    FVG_Distance_to_Price_ATR               : 0.0330
    OB_Body_Fuzzy_Score                     : 0.0310
    FVG_Bearish                             : 0.0305
    OB_Size_ATR                             : 0.0274

üìä Evaluating on Validation set...

  Accuracy: 0.630
  Precision (macro): 0.597
  Recall (macro): 0.600
  F1-Score (macro): 0.598

  Win Rate (excl. timeouts):
    Predicted: 63.0%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           8         8
  True Win            9        21

  Overfitting Analysis:
    Training Accuracy: 0.938
    Validation Accuracy: 0.630
    Train-Val Gap: 0.307
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.627
  Precision (macro): 0.632
  Recall (macro): 0.625
  F1-Score (macro): 0.622

  Win Rate (excl. timeouts):
    Predicted: 61.0%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          15        14
  True Win            8        22

üíæ Model pickle saved to /kaggle/working/AUDCAD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/AUDCAD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.2s

üß† Starting Neural Network training for AUDCAD...

================================================================================
Training Neural Network for AUDCAD
================================================================================

üìÇ Loading data for AUDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 225 samples
  Val:   46 samples
  Test:  59 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for AUDCAD...
  Device: cuda
  Training samples: 225
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 460
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7406, Train Acc: 0.796 | Val Loss: 0.9110, Val Acc: 0.717
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6504, Train Acc: 0.887 | Val Loss: 0.8999, Val Acc: 0.761
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6266, Train Acc: 0.904 | Val Loss: 0.9122, Val Acc: 0.783

  Early stopping at epoch 37 (patience=30)
Learning curves saved to: models/trained/AUDCAD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDCAD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚úì HEALTHY
Train-Val Gap: 12.61% (Threshold: 15%)
Total Epochs: 37
Training Duration: 0:00:03.752880

Final Metrics:
  Train Accuracy: 0.9087
  Val Accuracy:   0.7826
  Train Loss:     0.6089
  Val Loss:       0.9163

Best Epoch (Highest Val Accuracy):
  Epoch:          8
  Train Accuracy: 0.7478
  Val Accuracy:   0.7826
  Train Loss:     0.7494
  Val Loss:       0.8575
============================================================


  Final Train Accuracy: 0.909
  Final Val Accuracy:   0.783
  Train-Val Gap:        0.126 (12.6%)

üìä Evaluating on Validation set...

  Accuracy: 0.783
  Precision (macro): 0.772
  Recall (macro): 0.731
  F1-Score (macro): 0.743

  Win Rate (excl. timeouts):
    Predicted: 73.9%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           9         7
  True Win            3        27

üìä Evaluating on Test set...

  Accuracy: 0.627
  Precision (macro): 0.636
  Recall (macro): 0.625
  F1-Score (macro): 0.618

  Win Rate (excl. timeouts):
    Predicted: 64.4%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14        15
  True Win            7        23

üíæ Model pickle saved to /kaggle/working/AUDCAD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/AUDCAD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/AUDCAD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 7.7s

üîÑ Starting LSTM training for AUDCAD...

================================================================================
Training LSTM for AUDCAD
================================================================================

üìÇ Loading data for AUDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 225 samples
  Val:   46 samples
  Test:  59 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for AUDCAD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 225
  Features: 57
  Creating sequences...
  Sequence shape: (205, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6069, Train Acc: 0.659 | Val Loss: 0.7823, Val Acc: 0.577
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.4465, Train Acc: 0.810 | Val Loss: 1.5507, Val Acc: 0.615
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.4518, Train Acc: 0.893 | Val Loss: 1.3100, Val Acc: 0.692

  Early stopping at epoch 35

  Final Train Accuracy: 0.941
  Final Val Accuracy:   0.615
  Train-Val Gap:        0.326 (32.6%)

üìä Evaluating on Validation set...

  Accuracy: 0.543
  Precision (macro): 0.610
  Recall (macro): 0.606
  F1-Score (macro): 0.543

  Win Rate (excl. timeouts):
    Predicted: 32.6%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         3
  True Win           18        12

üìä Evaluating on Test set...

  Accuracy: 0.407
  Precision (macro): 0.383
  Recall (macro): 0.411
  F1-Score (macro): 0.371

  Win Rate (excl. timeouts):
    Predicted: 25.4%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          19        10
  True Win           25         5

üíæ Model pickle saved to /kaggle/working/AUDCAD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/AUDCAD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/AUDCAD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.3s

================================================================================
Symbol AUDCAD Training Summary:
  Total Duration: 19.8s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: AUDCHF
################################################################################

################################################################################
# Training All Models for AUDCHF
################################################################################

üå≤ Starting RandomForest training for AUDCHF...

================================================================================
Training Random Forest for AUDCHF
================================================================================

üìÇ Loading data for AUDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 254 samples
  Val:   55 samples
  Test:  45 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for AUDCHF...
  Training samples: 254
  Features: 57

  üìä Dataset has 254 samples (< 300), applying augmentation...
  Augmented: 254 ‚Üí 528 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for AUDCHF...
  Training samples: 422
  Features: 57

  Train accuracy: 0.872
  Val accuracy:   0.736
  Train-Val gap:  0.136
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1045
    TBM_Risk_Per_Trade_ATR                  : 0.0947
    TBM_Bars_to_Hit                         : 0.0879
    TBM_Reward_Per_Trade_ATR                : 0.0774
    Distance_to_Entry_ATR                   : 0.0554
    FVG_Distance_to_Price_ATR_ZScore        : 0.0522
    FVG_Size_Fuzzy_Score                    : 0.0359
    FVG_Distance_to_Price_ATR               : 0.0358
    FVG_Depth_ATR                           : 0.0330
    FVG_Quality_Fuzzy                       : 0.0324
  Fold 1/5: Accuracy=0.736, F1=0.734

üå≤ Training Random Forest for AUDCHF...
  Training samples: 422
  Features: 57

  Train accuracy: 0.858
  Val accuracy:   0.726
  Train-Val gap:  0.131
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0880
    TBM_Bars_to_Hit                         : 0.0855
    TBM_Risk_Per_Trade_ATR                  : 0.0734
    TBM_Reward_Per_Trade_ATR                : 0.0637
    FVG_Distance_to_Price_ATR_ZScore        : 0.0470
    Distance_to_Entry_ATR                   : 0.0421
    FVG_Depth_ATR                           : 0.0413
    FVG_Size_Fuzzy_Score                    : 0.0401
    FVG_Depth_ATR_ZScore                    : 0.0361
    FVG_Distance_to_Price_ATR               : 0.0317
  Fold 2/5: Accuracy=0.726, F1=0.722

üå≤ Training Random Forest for AUDCHF...
  Training samples: 422
  Features: 57

  Train accuracy: 0.877
  Val accuracy:   0.764
  Train-Val gap:  0.113
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0943
    TBM_Risk_Per_Trade_ATR                  : 0.0777
    TBM_Bars_to_Hit                         : 0.0668
    TBM_Reward_Per_Trade_ATR                : 0.0607
    FVG_Distance_to_Price_ATR_ZScore        : 0.0525
    Distance_to_Entry_ATR                   : 0.0453
    FVG_Depth_ATR_ZScore                    : 0.0437
    FVG_Distance_to_Price_ATR               : 0.0385
    FVG_Depth_ATR                           : 0.0377
    FVG_Size_Fuzzy_Score                    : 0.0299
  Fold 3/5: Accuracy=0.764, F1=0.764

üå≤ Training Random Forest for AUDCHF...
  Training samples: 423
  Features: 57

  Train accuracy: 0.853
  Val accuracy:   0.819
  Train-Val gap:  0.034
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0995
    TBM_Bars_to_Hit                         : 0.0860
    TBM_Risk_Per_Trade_ATR                  : 0.0564
    TBM_Reward_Per_Trade_ATR                : 0.0528
    FVG_Distance_to_Price_ATR_ZScore        : 0.0481
    FVG_Depth_ATR                           : 0.0429
    FVG_Depth_ATR_ZScore                    : 0.0408
    FVG_Size_Fuzzy_Score                    : 0.0363
    FVG_Distance_to_Price_ATR               : 0.0334
    FVG_Quality_Fuzzy                       : 0.0314
  Fold 4/5: Accuracy=0.819, F1=0.817

üå≤ Training Random Forest for AUDCHF...
  Training samples: 423
  Features: 57

  Train accuracy: 0.870
  Val accuracy:   0.848
  Train-Val gap:  0.022
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1105
    TBM_Reward_Per_Trade_ATR                : 0.0747
    TBM_Risk_Per_Trade_ATR                  : 0.0726
    TBM_Bars_to_Hit                         : 0.0648
    FVG_Distance_to_Price_ATR_ZScore        : 0.0555
    Distance_to_Entry_ATR                   : 0.0487
    FVG_Depth_ATR                           : 0.0400
    FVG_Depth_ATR_ZScore                    : 0.0377
    FVG_Quality_Fuzzy                       : 0.0332
    BOS_Dist_ATR_ZScore                     : 0.0308
  Fold 5/5: Accuracy=0.848, F1=0.848

  Cross-Validation Results:
    Mean Accuracy: 0.779 ¬± 0.047
    Min Accuracy:  0.726
    Max Accuracy:  0.848
    Range:         0.121
    Mean F1-Score: 0.777 ¬± 0.048
    ‚úÖ STABLE: Std dev 0.047 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.726 (deviation: -0.052)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: AUDCHF
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for AUDCHF...

================================================================================
Training XGBoost for AUDCHF
================================================================================

üìÇ Loading data for AUDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 254 samples
  Val:   55 samples
  Test:  45 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for AUDCHF...
  Training samples: 254
  Features: 57

  Train accuracy: 0.976
  Val accuracy:   0.473
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1075
    TBM_Reward_Per_Trade_ATR                : 0.0560
    OB_Displacement_ATR                     : 0.0511
    FVG_Distance_to_Price_ATR_ZScore        : 0.0453
    TBM_Bars_to_Hit                         : 0.0392
    Overbought_Fuzzy                        : 0.0372
    FVG_Depth_ATR_ZScore                    : 0.0327
    Bullish_Trend_Fuzzy                     : 0.0310
    FVG_Quality_Fuzzy                       : 0.0301
    TBM_Risk_Per_Trade_ATR                  : 0.0293

üìä Evaluating on Validation set...

  Accuracy: 0.473
  Precision (macro): 0.478
  Recall (macro): 0.477
  F1-Score (macro): 0.470

  Win Rate (excl. timeouts):
    Predicted: 47.3%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11        11
  True Win           18        15

  Overfitting Analysis:
    Training Accuracy: 0.976
    Validation Accuracy: 0.473
    Train-Val Gap: 0.504
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.711
  Precision (macro): 0.714
  Recall (macro): 0.714
  F1-Score (macro): 0.711

  Win Rate (excl. timeouts):
    Predicted: 53.3%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          16         8
  True Win            5        16

üíæ Model pickle saved to /kaggle/working/AUDCHF_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/AUDCHF_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.2s

üß† Starting Neural Network training for AUDCHF...

================================================================================
Training Neural Network for AUDCHF
================================================================================

üìÇ Loading data for AUDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 254 samples
  Val:   55 samples
  Test:  45 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for AUDCHF...
  Device: cuda
  Training samples: 254
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 528
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7971, Train Acc: 0.701 | Val Loss: 1.0082, Val Acc: 0.527
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6959, Train Acc: 0.839 | Val Loss: 1.0367, Val Acc: 0.491
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6529, Train Acc: 0.875 | Val Loss: 1.1559, Val Acc: 0.527

  Early stopping at epoch 38 (patience=30)
Learning curves saved to: models/trained/AUDCHF_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDCHF_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 34.55% (Threshold: 15%)
Total Epochs: 38
Training Duration: 0:00:03.175030

Final Metrics:
  Train Accuracy: 0.9091
  Val Accuracy:   0.5636
  Train Loss:     0.6092
  Val Loss:       1.1541

Best Epoch (Highest Val Accuracy):
  Epoch:          5
  Train Accuracy: 0.6913
  Val Accuracy:   0.6182
  Train Loss:     0.8109
  Val Loss:       0.9534
============================================================


  Final Train Accuracy: 0.909
  Final Val Accuracy:   0.564
  Train-Val Gap:        0.345 (34.5%)

üìä Evaluating on Validation set...

  Accuracy: 0.564
  Precision (macro): 0.552
  Recall (macro): 0.553
  F1-Score (macro): 0.552

  Win Rate (excl. timeouts):
    Predicted: 56.4%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11        11
  True Win           13        20

üìä Evaluating on Test set...

  Accuracy: 0.622
  Precision (macro): 0.625
  Recall (macro): 0.625
  F1-Score (macro): 0.622

  Win Rate (excl. timeouts):
    Predicted: 53.3%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14        10
  True Win            7        14

üíæ Model pickle saved to /kaggle/working/AUDCHF_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/AUDCHF_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/AUDCHF_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.2s

üîÑ Starting LSTM training for AUDCHF...

================================================================================
Training LSTM for AUDCHF
================================================================================

üìÇ Loading data for AUDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 254 samples
  Val:   55 samples
  Test:  45 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for AUDCHF...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 254
  Features: 57
  Creating sequences...
  Sequence shape: (234, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.6274, Train Acc: 0.645 | Val Loss: 0.6568, Val Acc: 0.543
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.5203, Train Acc: 0.714 | Val Loss: 0.8362, Val Acc: 0.600
  Epoch 30/200 - LR: 0.005208 - Train Loss: 0.2749, Train Acc: 0.923 | Val Loss: 2.5959, Val Acc: 0.486
‚ö†Ô∏è Epoch 35: Severe overfitting detected (train=95.73%, val=42.86%)

  Early stopping at epoch 35

  ‚ö†Ô∏è Training Warnings (1):
    - Epoch 35: Severe overfitting detected (train=95.73%, val=42.86%)

  Final Train Accuracy: 0.957
  Final Val Accuracy:   0.429
  Train-Val Gap:        0.529 (52.9%)

üìä Evaluating on Validation set...

  Accuracy: 0.455
  Precision (macro): 0.523
  Recall (macro): 0.515
  F1-Score (macro): 0.432

  Win Rate (excl. timeouts):
    Predicted: 20.0%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18         4
  True Win           26         7

üìä Evaluating on Test set...

  Accuracy: 0.489
  Precision (macro): 0.457
  Recall (macro): 0.470
  F1-Score (macro): 0.434

  Win Rate (excl. timeouts):
    Predicted: 22.2%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18         6
  True Win           17         4

üíæ Model pickle saved to /kaggle/working/AUDCHF_LSTM.pkl
üíæ Metadata saved to /kaggle/working/AUDCHF_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/AUDCHF_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.9s

================================================================================
Symbol AUDCHF Training Summary:
  Total Duration: 16.6s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: AUDJPY
################################################################################

################################################################################
# Training All Models for AUDJPY
################################################################################

üå≤ Starting RandomForest training for AUDJPY...

================================================================================
Training Random Forest for AUDJPY
================================================================================

üìÇ Loading data for AUDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 220 samples
  Val:   45 samples
  Test:  51 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for AUDJPY...
  Training samples: 220
  Features: 57

  üìä Dataset has 220 samples (< 300), applying augmentation...
  Augmented: 220 ‚Üí 492 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for AUDJPY...
  Training samples: 393
  Features: 57

  Train accuracy: 0.880
  Val accuracy:   0.788
  Train-Val gap:  0.093
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0879
    TBM_Risk_Per_Trade_ATR                  : 0.0828
    TBM_Reward_Per_Trade_ATR                : 0.0745
    Distance_to_Entry_ATR                   : 0.0616
    Displacement_Mag_ZScore                 : 0.0466
    OB_Displacement_ATR_ZScore              : 0.0452
    TBM_Bars_to_Hit                         : 0.0383
    FVG_Distance_to_Price_ATR_ZScore        : 0.0297
    Trend_Strength                          : 0.0293
    FVG_Distance_to_Price_ATR               : 0.0279
  Fold 1/5: Accuracy=0.788, F1=0.788

üå≤ Training Random Forest for AUDJPY...
  Training samples: 393
  Features: 57

  Train accuracy: 0.880
  Val accuracy:   0.717
  Train-Val gap:  0.163
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1002
    TBM_Risk_Per_Trade_ATR                  : 0.0933
    Distance_to_Entry_ATR                   : 0.0878
    TBM_Reward_Per_Trade_ATR                : 0.0794
    TBM_Bars_to_Hit                         : 0.0312
    FVG_Distance_to_Price_ATR_ZScore        : 0.0294
    FVG_Distance_to_Price_ATR               : 0.0277
    OB_Displacement_Fuzzy_Score             : 0.0263
    OB_Bearish                              : 0.0234
    FVG_Size_Fuzzy_Score                    : 0.0234
  Fold 2/5: Accuracy=0.717, F1=0.715

üå≤ Training Random Forest for AUDJPY...
  Training samples: 394
  Features: 57

  Train accuracy: 0.906
  Val accuracy:   0.827
  Train-Val gap:  0.080
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0861
    TBM_Risk_Per_Trade_ATR                  : 0.0793
    TBM_Reward_Per_Trade_ATR                : 0.0711
    Distance_to_Entry_ATR                   : 0.0634
    FVG_Distance_to_Price_ATR_ZScore        : 0.0389
    TBM_Bars_to_Hit                         : 0.0372
    FVG_Distance_to_Price_ATR               : 0.0332
    atr                                     : 0.0308
    FVG_Depth_ATR_ZScore                    : 0.0306
    OB_Bearish                              : 0.0283
  Fold 3/5: Accuracy=0.827, F1=0.827

üå≤ Training Random Forest for AUDJPY...
  Training samples: 394
  Features: 57

  Train accuracy: 0.883
  Val accuracy:   0.755
  Train-Val gap:  0.128
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1030
    TBM_Risk_Per_Trade_ATR                  : 0.0844
    TBM_Reward_Per_Trade_ATR                : 0.0794
    Distance_to_Entry_ATR                   : 0.0624
    TBM_Bars_to_Hit                         : 0.0397
    Displacement_Mag_ZScore                 : 0.0374
    OB_Displacement_ATR_ZScore              : 0.0369
    FVG_Distance_to_Price_ATR_ZScore        : 0.0300
    FVG_Distance_to_Price_ATR               : 0.0289
    FVG_Depth_ATR_ZScore                    : 0.0249
  Fold 4/5: Accuracy=0.755, F1=0.755

üå≤ Training Random Forest for AUDJPY...
  Training samples: 394
  Features: 57

  Train accuracy: 0.896
  Val accuracy:   0.837
  Train-Val gap:  0.059
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1293
    TBM_Risk_Per_Trade_ATR                  : 0.0736
    TBM_Reward_Per_Trade_ATR                : 0.0711
    Distance_to_Entry_ATR                   : 0.0613
    TBM_Bars_to_Hit                         : 0.0424
    FVG_Distance_to_Price_ATR_ZScore        : 0.0312
    FVG_Depth_ATR_ZScore                    : 0.0275
    atr                                     : 0.0255
    Trend_Strength                          : 0.0252
    FVG_Distance_to_Price_ATR               : 0.0251
  Fold 5/5: Accuracy=0.837, F1=0.835

  Cross-Validation Results:
    Mean Accuracy: 0.785 ¬± 0.045
    Min Accuracy:  0.717
    Max Accuracy:  0.837
    Range:         0.120
    Mean F1-Score: 0.784 ¬± 0.045
    ‚úÖ STABLE: Std dev 0.045 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.717 (deviation: -0.068)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: AUDJPY
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for AUDJPY...

================================================================================
Training XGBoost for AUDJPY
================================================================================

üìÇ Loading data for AUDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 220 samples
  Val:   45 samples
  Test:  51 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for AUDJPY...
  Training samples: 220
  Features: 57

  Train accuracy: 0.945
  Val accuracy:   0.689
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1402
    TBM_Risk_Per_Trade_ATR                  : 0.0459
    TBM_Reward_Per_Trade_ATR                : 0.0445
    OB_Bullish                              : 0.0413
    OB_Body_Fuzzy_Score                     : 0.0403
    OB_Displacement_Fuzzy_Score             : 0.0373
    OB_Bullish_Valid                        : 0.0354
    OB_Displacement_ATR                     : 0.0342
    FVG_Distance_to_Price_ATR               : 0.0340
    TBM_Bars_to_Hit                         : 0.0321

üìä Evaluating on Validation set...

  Accuracy: 0.689
  Precision (macro): 0.685
  Recall (macro): 0.680
  F1-Score (macro): 0.681

  Win Rate (excl. timeouts):
    Predicted: 60.0%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12         8
  True Win            6        19

  Overfitting Analysis:
    Training Accuracy: 0.945
    Validation Accuracy: 0.689
    Train-Val Gap: 0.257
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.647
  Precision (macro): 0.644
  Recall (macro): 0.644
  F1-Score (macro): 0.644

  Win Rate (excl. timeouts):
    Predicted: 54.9%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         9
  True Win            9        19

üíæ Model pickle saved to /kaggle/working/AUDJPY_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/AUDJPY_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for AUDJPY...

================================================================================
Training Neural Network for AUDJPY
================================================================================

üìÇ Loading data for AUDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 220 samples
  Val:   45 samples
  Test:  51 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for AUDJPY...
  Device: cuda
  Training samples: 220
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 492
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7636, Train Acc: 0.766 | Val Loss: 0.8049, Val Acc: 0.689
  Epoch 20/200 - LR: 0.005000 - Train Loss: 0.7165, Train Acc: 0.799 | Val Loss: 0.8118, Val Acc: 0.711
  Epoch 30/200 - LR: 0.002500 - Train Loss: 0.6348, Train Acc: 0.880 | Val Loss: 0.8836, Val Acc: 0.689
  Epoch 40/200 - LR: 0.000625 - Train Loss: 0.6268, Train Acc: 0.902 | Val Loss: 0.8892, Val Acc: 0.689

  Early stopping at epoch 44 (patience=30)
Learning curves saved to: models/trained/AUDJPY_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDJPY_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 21.15% (Threshold: 15%)
Total Epochs: 44
Training Duration: 0:00:03.288015

Final Metrics:
  Train Accuracy: 0.9004
  Val Accuracy:   0.6889
  Train Loss:     0.6231
  Val Loss:       0.8918

Best Epoch (Highest Val Accuracy):
  Epoch:          11
  Train Accuracy: 0.7480
  Val Accuracy:   0.7333
  Train Loss:     0.7639
  Val Loss:       0.8084
============================================================


  Final Train Accuracy: 0.900
  Final Val Accuracy:   0.689
  Train-Val Gap:        0.212 (21.2%)

üìä Evaluating on Validation set...

  Accuracy: 0.689
  Precision (macro): 0.693
  Recall (macro): 0.695
  F1-Score (macro): 0.689

  Win Rate (excl. timeouts):
    Predicted: 46.7%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          15         5
  True Win            9        16

üìä Evaluating on Test set...

  Accuracy: 0.686
  Precision (macro): 0.683
  Recall (macro): 0.683
  F1-Score (macro): 0.683

  Win Rate (excl. timeouts):
    Predicted: 54.9%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          15         8
  True Win            8        20

üíæ Model pickle saved to /kaggle/working/AUDJPY_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/AUDJPY_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/AUDJPY_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.3s

üîÑ Starting LSTM training for AUDJPY...

================================================================================
Training LSTM for AUDJPY
================================================================================

üìÇ Loading data for AUDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 220 samples
  Val:   45 samples
  Test:  51 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for AUDJPY...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 220
  Features: 57
  Creating sequences...
  Sequence shape: (200, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6297, Train Acc: 0.675 | Val Loss: 0.6810, Val Acc: 0.640
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.4313, Train Acc: 0.790 | Val Loss: 1.0569, Val Acc: 0.560
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.3561, Train Acc: 0.920 | Val Loss: 4.1193, Val Acc: 0.440
‚ö†Ô∏è Epoch 32: Exploding gradient detected (norm=10.83 > 10.0)

  Early stopping at epoch 34

  ‚ö†Ô∏è Training Warnings (1):
    - Epoch 32: Exploding gradient detected (norm=10.83 > 10.0)

  Final Train Accuracy: 0.950
  Final Val Accuracy:   0.400
  Train-Val Gap:        0.550 (55.0%)

üìä Evaluating on Validation set...

  Accuracy: 0.489
  Precision (macro): 0.542
  Recall (macro): 0.525
  F1-Score (macro): 0.450

  Win Rate (excl. timeouts):
    Predicted: 17.8%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          17         3
  True Win           20         5

üìä Evaluating on Test set...

  Accuracy: 0.471
  Precision (macro): 0.489
  Recall (macro): 0.491
  F1-Score (macro): 0.457

  Win Rate (excl. timeouts):
    Predicted: 29.4%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          16         7
  True Win           20         8

üíæ Model pickle saved to /kaggle/working/AUDJPY_LSTM.pkl
üíæ Metadata saved to /kaggle/working/AUDJPY_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/AUDJPY_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.0s

================================================================================
Symbol AUDJPY Training Summary:
  Total Duration: 15.8s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: AUDNZD
################################################################################

################################################################################
# Training All Models for AUDNZD
################################################################################

üå≤ Starting RandomForest training for AUDNZD...

================================================================================
Training Random Forest for AUDNZD
================================================================================

üìÇ Loading data for AUDNZD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 162 samples
  Val:   31 samples
  Test:  41 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for AUDNZD...
  Training samples: 162
  Features: 57

  üìä Dataset has 162 samples (< 300), applying augmentation...
  Augmented: 162 ‚Üí 510 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for AUDNZD...
  Training samples: 408
  Features: 57

  Train accuracy: 0.902
  Val accuracy:   0.735
  Train-Val gap:  0.167
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1066
    TBM_Risk_Per_Trade_ATR                  : 0.0677
    TBM_Reward_Per_Trade_ATR                : 0.0635
    BOS_Dist_ATR_ZScore                     : 0.0496
    Distance_to_Entry_ATR                   : 0.0426
    FVG_Distance_to_Price_ATR_ZScore        : 0.0337
    FVG_Distance_to_Price_ATR               : 0.0290
    Trend_Bias_Indicator_ZScore             : 0.0278
    TBM_Bars_to_Hit                         : 0.0270
    BOS_Dist_ATR                            : 0.0261
  Fold 1/5: Accuracy=0.735, F1=0.732

üå≤ Training Random Forest for AUDNZD...
  Training samples: 408
  Features: 57

  Train accuracy: 0.873
  Val accuracy:   0.696
  Train-Val gap:  0.176
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1057
    TBM_Reward_Per_Trade_ATR                : 0.0706
    TBM_Risk_Per_Trade_ATR                  : 0.0634
    Distance_to_Entry_ATR                   : 0.0464
    BOS_Dist_ATR_ZScore                     : 0.0389
    Trend_Bias_Indicator                    : 0.0324
    OB_Size_ATR_ZScore                      : 0.0273
    Displacement_Mag_ZScore                 : 0.0258
    Trend_Strength                          : 0.0255
    ATR_ZScore                              : 0.0249
  Fold 2/5: Accuracy=0.696, F1=0.695

üå≤ Training Random Forest for AUDNZD...
  Training samples: 408
  Features: 57

  Train accuracy: 0.885
  Val accuracy:   0.833
  Train-Val gap:  0.051
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1134
    Distance_to_Entry_ATR                   : 0.0627
    TBM_Risk_Per_Trade_ATR                  : 0.0562
    TBM_Reward_Per_Trade_ATR                : 0.0547
    BOS_Dist_ATR_ZScore                     : 0.0396
    Trend_Bias_Indicator                    : 0.0352
    TBM_Bars_to_Hit                         : 0.0351
    OB_Size_ATR_ZScore                      : 0.0324
    FVG_Depth_ATR_ZScore                    : 0.0270
    FVG_Distance_to_Price_ATR               : 0.0268
  Fold 3/5: Accuracy=0.833, F1=0.833

üå≤ Training Random Forest for AUDNZD...
  Training samples: 408
  Features: 57

  Train accuracy: 0.870
  Val accuracy:   0.775
  Train-Val gap:  0.096
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1065
    TBM_Risk_Per_Trade_ATR                  : 0.0734
    TBM_Reward_Per_Trade_ATR                : 0.0685
    Distance_to_Entry_ATR                   : 0.0654
    OB_Size_ATR_ZScore                      : 0.0369
    FVG_Distance_to_Price_ATR_ZScore        : 0.0312
    BOS_Dist_ATR_ZScore                     : 0.0298
    TBM_Bars_to_Hit                         : 0.0285
    FVG_Quality_Fuzzy                       : 0.0258
    Trend_Bias_Indicator                    : 0.0257
  Fold 4/5: Accuracy=0.775, F1=0.774

üå≤ Training Random Forest for AUDNZD...
  Training samples: 408
  Features: 57

  Train accuracy: 0.897
  Val accuracy:   0.775
  Train-Val gap:  0.123
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0896
    TBM_Reward_Per_Trade_ATR                : 0.0652
    TBM_Risk_Per_Trade_ATR                  : 0.0630
    BOS_Dist_ATR_ZScore                     : 0.0533
    Distance_to_Entry_ATR                   : 0.0417
    Trend_Bias_Indicator                    : 0.0331
    Trend_Strength                          : 0.0281
    OB_Size_ATR                             : 0.0280
    OB_Size_ATR_ZScore                      : 0.0277
    FVG_Distance_to_Price_ATR               : 0.0275
  Fold 5/5: Accuracy=0.775, F1=0.774

  Cross-Validation Results:
    Mean Accuracy: 0.763 ¬± 0.046
    Min Accuracy:  0.696
    Max Accuracy:  0.833
    Range:         0.137
    Mean F1-Score: 0.762 ¬± 0.047
    ‚úÖ STABLE: Std dev 0.046 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.696 (deviation: -0.067)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: AUDNZD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for AUDNZD...

================================================================================
Training XGBoost for AUDNZD
================================================================================

üìÇ Loading data for AUDNZD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 162 samples
  Val:   31 samples
  Test:  41 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for AUDNZD...
  Training samples: 162
  Features: 57

  Train accuracy: 0.963
  Val accuracy:   0.710
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1060
    TBM_Reward_Per_Trade_ATR                : 0.0630
    FVG_Distance_to_Price_ATR               : 0.0452
    BOS_Dist_ATR_ZScore                     : 0.0413
    TBM_Risk_Per_Trade_ATR                  : 0.0402
    FVG_Depth_ATR_ZScore                    : 0.0377
    OB_Quality_Fuzzy                        : 0.0347
    Bullish_Trend_Fuzzy                     : 0.0335
    FVG_Distance_to_Price_ATR_ZScore        : 0.0332
    BOS_Commitment_Flag                     : 0.0329

üìä Evaluating on Validation set...

  Accuracy: 0.710
  Precision (macro): 0.716
  Recall (macro): 0.716
  F1-Score (macro): 0.710

  Win Rate (excl. timeouts):
    Predicted: 45.2%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11         3
  True Win            6        11

  Overfitting Analysis:
    Training Accuracy: 0.963
    Validation Accuracy: 0.710
    Train-Val Gap: 0.253
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.756
  Precision (macro): 0.755
  Recall (macro): 0.758
  F1-Score (macro): 0.755

  Win Rate (excl. timeouts):
    Predicted: 51.2%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         4
  True Win            6        17

üíæ Model pickle saved to /kaggle/working/AUDNZD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/AUDNZD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for AUDNZD...

================================================================================
Training Neural Network for AUDNZD
================================================================================

üìÇ Loading data for AUDNZD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 162 samples
  Val:   31 samples
  Test:  41 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for AUDNZD...
  Device: cuda
  Training samples: 162
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 510
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7639, Train Acc: 0.773 | Val Loss: 0.9291, Val Acc: 0.742
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6636, Train Acc: 0.884 | Val Loss: 0.9476, Val Acc: 0.613
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6439, Train Acc: 0.890 | Val Loss: 0.9225, Val Acc: 0.645

  Early stopping at epoch 33 (patience=30)
Learning curves saved to: models/trained/AUDNZD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDNZD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 27.05% (Threshold: 15%)
Total Epochs: 33
Training Duration: 0:00:02.619758

Final Metrics:
  Train Accuracy: 0.9157
  Val Accuracy:   0.6452
  Train Loss:     0.6165
  Val Loss:       0.8957

Best Epoch (Highest Val Accuracy):
  Epoch:          9
  Train Accuracy: 0.7725
  Val Accuracy:   0.7419
  Train Loss:     0.7639
  Val Loss:       0.9291
============================================================


  Final Train Accuracy: 0.916
  Final Val Accuracy:   0.645
  Train-Val Gap:        0.271 (27.1%)

üìä Evaluating on Validation set...

  Accuracy: 0.645
  Precision (macro): 0.651
  Recall (macro): 0.651
  F1-Score (macro): 0.645

  Win Rate (excl. timeouts):
    Predicted: 45.2%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          10         4
  True Win            7        10

üìä Evaluating on Test set...

  Accuracy: 0.610
  Precision (macro): 0.601
  Recall (macro): 0.598
  F1-Score (macro): 0.598

  Win Rate (excl. timeouts):
    Predicted: 61.0%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           9         9
  True Win            7        16

üíæ Model pickle saved to /kaggle/working/AUDNZD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/AUDNZD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/AUDNZD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 3.6s

üîÑ Starting LSTM training for AUDNZD...

================================================================================
Training LSTM for AUDNZD
================================================================================

üìÇ Loading data for AUDNZD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 162 samples
  Val:   31 samples
  Test:  41 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for AUDNZD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 162
  Features: 57
  Creating sequences...
  Sequence shape: (142, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7174, Train Acc: 0.592 | Val Loss: 0.7290, Val Acc: 0.455
  Epoch 20/200 - LR: 0.002808 - Train Loss: 0.5053, Train Acc: 0.725 | Val Loss: 0.6144, Val Acc: 0.636
  Epoch 30/200 - LR: 0.005214 - Train Loss: 0.4252, Train Acc: 0.894 | Val Loss: 2.4462, Val Acc: 0.545
‚ö†Ô∏è Epoch 32: Severe overfitting detected (train=95.07%, val=45.45%)
‚ö†Ô∏è Epoch 37: Severe overfitting detected (train=96.48%, val=45.45%)
‚ö†Ô∏è Epoch 38: Severe overfitting detected (train=96.48%, val=27.27%)
  Epoch 40/200 - LR: 0.007616 - Train Loss: 0.2599, Train Acc: 0.965 | Val Loss: 2.1385, Val Acc: 0.727
‚ö†Ô∏è Epoch 44: Severe overfitting detected (train=95.77%, val=54.55%)
‚ö†Ô∏è Epoch 49: Severe overfitting detected (train=95.07%, val=45.45%)
‚ö†Ô∏è Epoch 50: Severe overfitting detected (train=95.77%, val=27.27%)
  Epoch 50/200 - LR: 0.009369 - Train Loss: 0.1257, Train Acc: 0.958 | Val Loss: 8.4279, Val Acc: 0.273
‚ö†Ô∏è Epoch 51: Severe overfitting detected (train=96.48%, val=36.36%)
‚ö†Ô∏è Epoch 52: Severe overfitting detected (train=95.77%, val=27.27%)
‚ö†Ô∏è Epoch 53: Severe overfitting detected (train=96.48%, val=18.18%)
‚ö†Ô∏è Epoch 55: Severe overfitting detected (train=99.30%, val=36.36%)
‚ö†Ô∏è Epoch 56: Exploding gradient detected (norm=11.33 > 10.0)
‚ö†Ô∏è Epoch 56: Severe overfitting detected (train=98.59%, val=36.36%)
‚ö†Ô∏è Epoch 57: Severe overfitting detected (train=97.18%, val=36.36%)

  Early stopping at epoch 57

  ‚ö†Ô∏è Training Warnings (13):
    - Epoch 32: Severe overfitting detected (train=95.07%, val=45.45%)
    - Epoch 37: Severe overfitting detected (train=96.48%, val=45.45%)
    - Epoch 38: Severe overfitting detected (train=96.48%, val=27.27%)
    - Epoch 44: Severe overfitting detected (train=95.77%, val=54.55%)
    - Epoch 49: Severe overfitting detected (train=95.07%, val=45.45%)
    - Epoch 50: Severe overfitting detected (train=95.77%, val=27.27%)
    - Epoch 51: Severe overfitting detected (train=96.48%, val=36.36%)
    - Epoch 52: Severe overfitting detected (train=95.77%, val=27.27%)
    - Epoch 53: Severe overfitting detected (train=96.48%, val=18.18%)
    - Epoch 55: Severe overfitting detected (train=99.30%, val=36.36%)
    - Epoch 56: Exploding gradient detected (norm=11.33 > 10.0)
    - Epoch 56: Severe overfitting detected (train=98.59%, val=36.36%)
    - Epoch 57: Severe overfitting detected (train=97.18%, val=36.36%)

  Final Train Accuracy: 0.972
  Final Val Accuracy:   0.364
  Train-Val Gap:        0.608 (60.8%)

üìä Evaluating on Validation set...

  Accuracy: 0.452
  Precision (macro): 0.467
  Recall (macro): 0.475
  F1-Score (macro): 0.430

  Win Rate (excl. timeouts):
    Predicted: 25.8%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          10         4
  True Win           13         4

üìä Evaluating on Test set...

  Accuracy: 0.537
  Precision (macro): 0.562
  Recall (macro): 0.557
  F1-Score (macro): 0.532

  Win Rate (excl. timeouts):
    Predicted: 34.1%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         5
  True Win           14         9

üíæ Model pickle saved to /kaggle/working/AUDNZD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/AUDNZD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/AUDNZD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.9s

================================================================================
Symbol AUDNZD Training Summary:
  Total Duration: 16.1s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: AUDUSD
################################################################################

################################################################################
# Training All Models for AUDUSD
################################################################################

üå≤ Starting RandomForest training for AUDUSD...

================================================================================
Training Random Forest for AUDUSD
================================================================================

üìÇ Loading data for AUDUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 239 samples
  Val:   53 samples
  Test:  54 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for AUDUSD...
  Training samples: 239
  Features: 57

  üìä Dataset has 239 samples (< 300), applying augmentation...
  Augmented: 239 ‚Üí 516 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for AUDUSD...
  Training samples: 412
  Features: 57

  Train accuracy: 0.854
  Val accuracy:   0.779
  Train-Val gap:  0.076
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1342
    FVG_Distance_to_Price_ATR_ZScore        : 0.0627
    FVG_Size_Fuzzy_Score                    : 0.0537
    FVG_Distance_to_Price_ATR               : 0.0509
    TBM_Bars_to_Hit                         : 0.0467
    FVG_Depth_ATR_ZScore                    : 0.0460
    FVG_Depth_ATR                           : 0.0397
    FVG_Quality_Fuzzy                       : 0.0378
    Displacement_Mag_ZScore                 : 0.0319
    TBM_Reward_Per_Trade_ATR                : 0.0317
  Fold 1/5: Accuracy=0.779, F1=0.773

üå≤ Training Random Forest for AUDUSD...
  Training samples: 413
  Features: 57

  Train accuracy: 0.884
  Val accuracy:   0.786
  Train-Val gap:  0.097
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1048
    FVG_Distance_to_Price_ATR_ZScore        : 0.0615
    FVG_Size_Fuzzy_Score                    : 0.0569
    TBM_Bars_to_Hit                         : 0.0555
    FVG_Depth_ATR_ZScore                    : 0.0483
    FVG_Depth_ATR                           : 0.0437
    FVG_Distance_to_Price_ATR               : 0.0433
    FVG_Quality_Fuzzy                       : 0.0423
    TBM_Reward_Per_Trade_ATR                : 0.0393
    TBM_Risk_Per_Trade_ATR                  : 0.0360
  Fold 2/5: Accuracy=0.786, F1=0.785

üå≤ Training Random Forest for AUDUSD...
  Training samples: 413
  Features: 57

  Train accuracy: 0.891
  Val accuracy:   0.825
  Train-Val gap:  0.066
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1110
    FVG_Distance_to_Price_ATR_ZScore        : 0.0583
    TBM_Risk_Per_Trade_ATR                  : 0.0513
    TBM_Bars_to_Hit                         : 0.0488
    FVG_Distance_to_Price_ATR               : 0.0480
    FVG_Size_Fuzzy_Score                    : 0.0418
    TBM_Reward_Per_Trade_ATR                : 0.0385
    FVG_Depth_ATR_ZScore                    : 0.0377
    FVG_Mitigated                           : 0.0330
    FVG_Depth_ATR                           : 0.0322
  Fold 3/5: Accuracy=0.825, F1=0.825

üå≤ Training Random Forest for AUDUSD...
  Training samples: 413
  Features: 57

  Train accuracy: 0.884
  Val accuracy:   0.709
  Train-Val gap:  0.175
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1166
    FVG_Distance_to_Price_ATR_ZScore        : 0.0565
    FVG_Distance_to_Price_ATR               : 0.0519
    FVG_Quality_Fuzzy                       : 0.0438
    FVG_Size_Fuzzy_Score                    : 0.0435
    TBM_Bars_to_Hit                         : 0.0427
    FVG_Depth_ATR                           : 0.0403
    TBM_Reward_Per_Trade_ATR                : 0.0383
    FVG_Depth_ATR_ZScore                    : 0.0376
    TBM_Risk_Per_Trade_ATR                  : 0.0373
  Fold 4/5: Accuracy=0.709, F1=0.708

üå≤ Training Random Forest for AUDUSD...
  Training samples: 413
  Features: 57

  Train accuracy: 0.879
  Val accuracy:   0.757
  Train-Val gap:  0.122
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1107
    TBM_Bars_to_Hit                         : 0.0666
    FVG_Distance_to_Price_ATR_ZScore        : 0.0520
    FVG_Distance_to_Price_ATR               : 0.0475
    FVG_Size_Fuzzy_Score                    : 0.0467
    FVG_Quality_Fuzzy                       : 0.0453
    FVG_Depth_ATR                           : 0.0422
    FVG_Depth_ATR_ZScore                    : 0.0387
    FVG_Mitigated                           : 0.0380
    TBM_Reward_Per_Trade_ATR                : 0.0377
  Fold 5/5: Accuracy=0.757, F1=0.757

  Cross-Validation Results:
    Mean Accuracy: 0.771 ¬± 0.038
    Min Accuracy:  0.709
    Max Accuracy:  0.825
    Range:         0.117
    Mean F1-Score: 0.770 ¬± 0.038
    ‚úÖ STABLE: Std dev 0.038 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.709 (deviation: -0.063)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: AUDUSD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for AUDUSD...

================================================================================
Training XGBoost for AUDUSD
================================================================================

üìÇ Loading data for AUDUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 239 samples
  Val:   53 samples
  Test:  54 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for AUDUSD...
  Training samples: 239
  Features: 57

  Train accuracy: 0.962
  Val accuracy:   0.585
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1563
    OB_Bearish                              : 0.0668
    TBM_Reward_Per_Trade_ATR                : 0.0520
    FVG_Distance_to_Price_ATR               : 0.0382
    FVG_Depth_ATR_ZScore                    : 0.0349
    ChoCH_Detected                          : 0.0347
    FVG_Distance_to_Price_ATR_ZScore        : 0.0339
    Displacement_Mag_ZScore                 : 0.0315
    Trend_Bias_Indicator                    : 0.0307
    FVG_Quality_Fuzzy                       : 0.0291

üìä Evaluating on Validation set...

  Accuracy: 0.585
  Precision (macro): 0.595
  Recall (macro): 0.588
  F1-Score (macro): 0.578

  Win Rate (excl. timeouts):
    Predicted: 64.2%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12        15
  True Win            7        19

  Overfitting Analysis:
    Training Accuracy: 0.962
    Validation Accuracy: 0.585
    Train-Val Gap: 0.377
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.611
  Precision (macro): 0.592
  Recall (macro): 0.587
  F1-Score (macro): 0.587

  Win Rate (excl. timeouts):
    Predicted: 64.8%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          10        12
  True Win            9        23

üíæ Model pickle saved to /kaggle/working/AUDUSD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/AUDUSD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for AUDUSD...

================================================================================
Training Neural Network for AUDUSD
================================================================================

üìÇ Loading data for AUDUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 239 samples
  Val:   53 samples
  Test:  54 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for AUDUSD...
  Device: cuda
  Training samples: 239
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 516
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.8021, Train Acc: 0.742 | Val Loss: 1.0566, Val Acc: 0.434
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6600, Train Acc: 0.886 | Val Loss: 1.1866, Val Acc: 0.491
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6352, Train Acc: 0.880 | Val Loss: 1.1948, Val Acc: 0.547

  Early stopping at epoch 34 (patience=30)
Learning curves saved to: models/trained/AUDUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 36.07% (Threshold: 15%)
Total Epochs: 34
Training Duration: 0:00:02.861057

Final Metrics:
  Train Accuracy: 0.8702
  Val Accuracy:   0.5094
  Train Loss:     0.6899
  Val Loss:       1.1863

Best Epoch (Highest Val Accuracy):
  Epoch:          6
  Train Accuracy: 0.7519
  Val Accuracy:   0.5660
  Train Loss:     0.8168
  Val Loss:       0.9724
============================================================


  Final Train Accuracy: 0.870
  Final Val Accuracy:   0.509
  Train-Val Gap:        0.361 (36.1%)

üìä Evaluating on Validation set...

  Accuracy: 0.509
  Precision (macro): 0.510
  Recall (macro): 0.510
  F1-Score (macro): 0.509

  Win Rate (excl. timeouts):
    Predicted: 52.8%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13        14
  True Win           12        14

üìä Evaluating on Test set...

  Accuracy: 0.519
  Precision (macro): 0.508
  Recall (macro): 0.509
  F1-Score (macro): 0.508

  Win Rate (excl. timeouts):
    Predicted: 55.6%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          10        12
  True Win           14        18

üíæ Model pickle saved to /kaggle/working/AUDUSD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/AUDUSD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/AUDUSD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 3.9s

üîÑ Starting LSTM training for AUDUSD...

================================================================================
Training LSTM for AUDUSD
================================================================================

üìÇ Loading data for AUDUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 239 samples
  Val:   53 samples
  Test:  54 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for AUDUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 239
  Features: 57
  Creating sequences...
  Sequence shape: (219, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.5902, Train Acc: 0.685 | Val Loss: 0.8441, Val Acc: 0.515
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.5480, Train Acc: 0.772 | Val Loss: 1.3242, Val Acc: 0.303
  Epoch 30/200 - LR: 0.005209 - Train Loss: 0.3934, Train Acc: 0.858 | Val Loss: 1.0860, Val Acc: 0.485
‚ö†Ô∏è Epoch 32: Exploding gradient detected (norm=11.74 > 10.0)
‚ö†Ô∏è Epoch 40: Severe overfitting detected (train=96.80%, val=33.33%)
  Epoch 40/200 - LR: 0.007610 - Train Loss: 0.1366, Train Acc: 0.968 | Val Loss: 9.4669, Val Acc: 0.333
‚ö†Ô∏è Epoch 41: Severe overfitting detected (train=96.35%, val=36.36%)
‚ö†Ô∏è Epoch 43: Severe overfitting detected (train=95.43%, val=30.30%)
‚ö†Ô∏è Epoch 47: Exploding gradient detected (norm=11.83 > 10.0)
‚ö†Ô∏è Epoch 49: Severe overfitting detected (train=95.43%, val=36.36%)
  Epoch 50/200 - LR: 0.009364 - Train Loss: 0.3315, Train Acc: 0.904 | Val Loss: 1.6428, Val Acc: 0.424
‚ö†Ô∏è Epoch 53: Exploding gradient detected (norm=11.00 > 10.0)

  Early stopping at epoch 53

  ‚ö†Ô∏è Training Warnings (7):
    - Epoch 32: Exploding gradient detected (norm=11.74 > 10.0)
    - Epoch 40: Severe overfitting detected (train=96.80%, val=33.33%)
    - Epoch 41: Severe overfitting detected (train=96.35%, val=36.36%)
    - Epoch 43: Severe overfitting detected (train=95.43%, val=30.30%)
    - Epoch 47: Exploding gradient detected (norm=11.83 > 10.0)
    - Epoch 49: Severe overfitting detected (train=95.43%, val=36.36%)
    - Epoch 53: Exploding gradient detected (norm=11.00 > 10.0)

  Final Train Accuracy: 0.927
  Final Val Accuracy:   0.455
  Train-Val Gap:        0.472 (47.2%)

üìä Evaluating on Validation set...

  Accuracy: 0.453
  Precision (macro): 0.452
  Recall (macro): 0.452
  F1-Score (macro): 0.452

  Win Rate (excl. timeouts):
    Predicted: 47.2%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13        14
  True Win           15        11

üìä Evaluating on Test set...

  Accuracy: 0.463
  Precision (macro): 0.470
  Recall (macro): 0.469
  F1-Score (macro): 0.461

  Win Rate (excl. timeouts):
    Predicted: 46.3%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11        11
  True Win           18        14

üíæ Model pickle saved to /kaggle/working/AUDUSD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/AUDUSD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/AUDUSD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 9.0s

================================================================================
Symbol AUDUSD Training Summary:
  Total Duration: 18.4s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: EURUSD
################################################################################

################################################################################
# Training All Models for EURUSD
################################################################################

üå≤ Starting RandomForest training for EURUSD...

================================================================================
Training Random Forest for EURUSD
================================================================================

üìÇ Loading data for EURUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 215 samples
  Val:   57 samples
  Test:  47 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for EURUSD...
  Training samples: 215
  Features: 57

  üìä Dataset has 215 samples (< 300), applying augmentation...
  Augmented: 215 ‚Üí 452 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for EURUSD...
  Training samples: 361
  Features: 57

  Train accuracy: 0.931
  Val accuracy:   0.780
  Train-Val gap:  0.151
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1176
    OB_Displacement_Fuzzy_Score             : 0.0474
    TBM_Reward_Per_Trade_ATR                : 0.0444
    TBM_Risk_Per_Trade_ATR                  : 0.0440
    BOS_Dist_ATR_ZScore                     : 0.0433
    Distance_to_Entry_ATR                   : 0.0407
    FVG_Distance_to_Price_ATR_ZScore        : 0.0386
    OB_Size_ATR_ZScore                      : 0.0377
    FVG_Distance_to_Price_ATR               : 0.0345
    OB_Size_ATR                             : 0.0322
  Fold 1/5: Accuracy=0.780, F1=0.778

üå≤ Training Random Forest for EURUSD...
  Training samples: 361
  Features: 57

  Train accuracy: 0.920
  Val accuracy:   0.769
  Train-Val gap:  0.150
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1250
    TBM_Risk_Per_Trade_ATR                  : 0.0512
    OB_Displacement_Fuzzy_Score             : 0.0438
    TBM_Reward_Per_Trade_ATR                : 0.0424
    Distance_to_Entry_ATR                   : 0.0416
    OB_Size_ATR_ZScore                      : 0.0379
    FVG_Distance_to_Price_ATR_ZScore        : 0.0359
    BOS_Dist_ATR_ZScore                     : 0.0356
    OB_Size_ATR                             : 0.0350
    FVG_Distance_to_Price_ATR               : 0.0343
  Fold 2/5: Accuracy=0.769, F1=0.764

üå≤ Training Random Forest for EURUSD...
  Training samples: 362
  Features: 57

  Train accuracy: 0.950
  Val accuracy:   0.889
  Train-Val gap:  0.061
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1261
    OB_Displacement_Fuzzy_Score             : 0.0447
    FVG_Distance_to_Price_ATR               : 0.0424
    TBM_Risk_Per_Trade_ATR                  : 0.0421
    FVG_Distance_to_Price_ATR_ZScore        : 0.0409
    Distance_to_Entry_ATR                   : 0.0383
    TBM_Reward_Per_Trade_ATR                : 0.0348
    OB_Size_ATR_ZScore                      : 0.0329
    BOS_Dist_ATR_ZScore                     : 0.0299
    TBM_Bars_to_Hit                         : 0.0299
  Fold 3/5: Accuracy=0.889, F1=0.889

üå≤ Training Random Forest for EURUSD...
  Training samples: 362
  Features: 57

  Train accuracy: 0.903
  Val accuracy:   0.711
  Train-Val gap:  0.192
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1425
    TBM_Risk_Per_Trade_ATR                  : 0.0512
    Distance_to_Entry_ATR                   : 0.0484
    TBM_Reward_Per_Trade_ATR                : 0.0423
    FVG_Distance_to_Price_ATR               : 0.0421
    TBM_Bars_to_Hit                         : 0.0392
    FVG_Distance_to_Price_ATR_ZScore        : 0.0385
    BOS_Dist_ATR_ZScore                     : 0.0294
    OB_Size_ATR_ZScore                      : 0.0279
    OB_Displacement_Fuzzy_Score             : 0.0273
  Fold 4/5: Accuracy=0.711, F1=0.710

üå≤ Training Random Forest for EURUSD...
  Training samples: 362
  Features: 57

  Train accuracy: 0.920
  Val accuracy:   0.789
  Train-Val gap:  0.131
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1066
    OB_Displacement_Fuzzy_Score             : 0.0517
    TBM_Risk_Per_Trade_ATR                  : 0.0485
    TBM_Reward_Per_Trade_ATR                : 0.0415
    BOS_Dist_ATR_ZScore                     : 0.0343
    FVG_Distance_to_Price_ATR               : 0.0343
    OB_Size_ATR_ZScore                      : 0.0338
    Distance_to_Entry_ATR                   : 0.0337
    Trend_Bias_Indicator_ZScore             : 0.0328
    ATR_ZScore                              : 0.0306
  Fold 5/5: Accuracy=0.789, F1=0.789

  Cross-Validation Results:
    Mean Accuracy: 0.788 ¬± 0.057
    Min Accuracy:  0.711
    Max Accuracy:  0.889
    Range:         0.178
    Mean F1-Score: 0.786 ¬± 0.058
    ‚úÖ STABLE: Std dev 0.057 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.711 (deviation: -0.077)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: EURUSD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for EURUSD...

================================================================================
Training XGBoost for EURUSD
================================================================================

üìÇ Loading data for EURUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 215 samples
  Val:   57 samples
  Test:  47 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for EURUSD...
  Training samples: 215
  Features: 57

  Train accuracy: 0.963
  Val accuracy:   0.684
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1400
    FVG_Distance_to_Price_ATR               : 0.0445
    FVG_Distance_to_Price_ATR_ZScore        : 0.0442
    OB_Size_ATR                             : 0.0414
    BOS_Dist_ATR                            : 0.0370
    OB_Size_ATR_ZScore                      : 0.0365
    TBM_Reward_Per_Trade_ATR                : 0.0361
    OB_Displacement_ATR_ZScore              : 0.0344
    Bullish_Trend_Fuzzy                     : 0.0337
    FVG_Size_Fuzzy_Score                    : 0.0330

üìä Evaluating on Validation set...

  Accuracy: 0.684
  Precision (macro): 0.716
  Recall (macro): 0.737
  F1-Score (macro): 0.682

  Win Rate (excl. timeouts):
    Predicted: 42.1%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          17         2
  True Win           16        22

  Overfitting Analysis:
    Training Accuracy: 0.963
    Validation Accuracy: 0.684
    Train-Val Gap: 0.279
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.660
  Precision (macro): 0.659
  Recall (macro): 0.660
  F1-Score (macro): 0.658

  Win Rate (excl. timeouts):
    Predicted: 51.1%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         7
  True Win            9        17

üíæ Model pickle saved to /kaggle/working/EURUSD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/EURUSD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for EURUSD...

================================================================================
Training Neural Network for EURUSD
================================================================================

üìÇ Loading data for EURUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 215 samples
  Val:   57 samples
  Test:  47 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for EURUSD...
  Device: cuda
  Training samples: 215
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 452
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7920, Train Acc: 0.728 | Val Loss: 0.9027, Val Acc: 0.614
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6931, Train Acc: 0.814 | Val Loss: 0.9487, Val Acc: 0.667
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6304, Train Acc: 0.892 | Val Loss: 1.0480, Val Acc: 0.596

  Early stopping at epoch 37 (patience=30)
Learning curves saved to: models/trained/EURUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/EURUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 31.49% (Threshold: 15%)
Total Epochs: 37
Training Duration: 0:00:02.769167

Final Metrics:
  Train Accuracy: 0.8938
  Val Accuracy:   0.5789
  Train Loss:     0.6169
  Val Loss:       1.0175

Best Epoch (Highest Val Accuracy):
  Epoch:          10
  Train Accuracy: 0.7279
  Val Accuracy:   0.7018
  Train Loss:     0.7882
  Val Loss:       0.8489
============================================================


  Final Train Accuracy: 0.894
  Final Val Accuracy:   0.579
  Train-Val Gap:        0.315 (31.5%)

üìä Evaluating on Validation set...

  Accuracy: 0.579
  Precision (macro): 0.582
  Recall (macro): 0.592
  F1-Score (macro): 0.568

  Win Rate (excl. timeouts):
    Predicted: 49.1%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12         7
  True Win           17        21

üìä Evaluating on Test set...

  Accuracy: 0.553
  Precision (macro): 0.543
  Recall (macro): 0.541
  F1-Score (macro): 0.540

  Win Rate (excl. timeouts):
    Predicted: 61.7%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           9        12
  True Win            9        17

üíæ Model pickle saved to /kaggle/working/EURUSD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/EURUSD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/EURUSD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 3.8s

üîÑ Starting LSTM training for EURUSD...

================================================================================
Training LSTM for EURUSD
================================================================================

üìÇ Loading data for EURUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 215 samples
  Val:   57 samples
  Test:  47 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for EURUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 215
  Features: 57
  Creating sequences...
  Sequence shape: (195, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6232, Train Acc: 0.667 | Val Loss: 0.8108, Val Acc: 0.514
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.5305, Train Acc: 0.790 | Val Loss: 0.7655, Val Acc: 0.568
‚ö†Ô∏è Epoch 25: Exploding gradient detected (norm=19.44 > 10.0)
‚ö†Ô∏è Epoch 28: Exploding gradient detected (norm=11.37 > 10.0)
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.2951, Train Acc: 0.923 | Val Loss: 1.8634, Val Acc: 0.541

  Early stopping at epoch 34

  ‚ö†Ô∏è Training Warnings (2):
    - Epoch 25: Exploding gradient detected (norm=19.44 > 10.0)
    - Epoch 28: Exploding gradient detected (norm=11.37 > 10.0)

  Final Train Accuracy: 0.938
  Final Val Accuracy:   0.649
  Train-Val Gap:        0.290 (29.0%)

üìä Evaluating on Validation set...

  Accuracy: 0.579
  Precision (macro): 0.594
  Recall (macro): 0.605
  F1-Score (macro): 0.573

  Win Rate (excl. timeouts):
    Predicted: 45.6%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         6
  True Win           18        20

üìä Evaluating on Test set...

  Accuracy: 0.468
  Precision (macro): 0.481
  Recall (macro): 0.483
  F1-Score (macro): 0.464

  Win Rate (excl. timeouts):
    Predicted: 36.2%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         8
  True Win           17         9

üíæ Model pickle saved to /kaggle/working/EURUSD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/EURUSD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/EURUSD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.1s

================================================================================
Symbol EURUSD Training Summary:
  Total Duration: 15.5s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: GBPUSD
################################################################################

################################################################################
# Training All Models for GBPUSD
################################################################################

üå≤ Starting RandomForest training for GBPUSD...

================================================================================
Training Random Forest for GBPUSD
================================================================================

üìÇ Loading data for GBPUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 196 samples
  Val:   48 samples
  Test:  44 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for GBPUSD...
  Training samples: 196
  Features: 57

  üìä Dataset has 196 samples (< 300), applying augmentation...
  Augmented: 196 ‚Üí 642 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for GBPUSD...
  Training samples: 513
  Features: 57

  Train accuracy: 0.901
  Val accuracy:   0.760
  Train-Val gap:  0.141
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1135
    OB_Size_ATR_ZScore                      : 0.0438
    OB_Size_ATR                             : 0.0432
    Displacement_Mag_ZScore                 : 0.0389
    FVG_Distance_to_Price_ATR               : 0.0377
    FVG_Quality_Fuzzy                       : 0.0371
    TBM_Risk_Per_Trade_ATR                  : 0.0337
    FVG_Depth_ATR_ZScore                    : 0.0301
    OB_Displacement_ATR_ZScore              : 0.0300
    BOS_Dist_ATR_ZScore                     : 0.0289
  Fold 1/5: Accuracy=0.760, F1=0.759

üå≤ Training Random Forest for GBPUSD...
  Training samples: 513
  Features: 57

  Train accuracy: 0.891
  Val accuracy:   0.705
  Train-Val gap:  0.185
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1016
    FVG_Distance_to_Price_ATR               : 0.0492
    TBM_Risk_Per_Trade_ATR                  : 0.0488
    OB_Size_ATR_ZScore                      : 0.0454
    OB_Size_ATR                             : 0.0405
    Displacement_Mag_ZScore                 : 0.0357
    TBM_Reward_Per_Trade_ATR                : 0.0353
    FVG_Distance_to_Price_ATR_ZScore        : 0.0336
    FVG_Quality_Fuzzy                       : 0.0329
    Distance_to_Entry_ATR                   : 0.0310
  Fold 2/5: Accuracy=0.705, F1=0.703

üå≤ Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.905
  Val accuracy:   0.734
  Train-Val gap:  0.170
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1096
    FVG_Distance_to_Price_ATR               : 0.0602
    TBM_Risk_Per_Trade_ATR                  : 0.0390
    OB_Size_ATR_ZScore                      : 0.0382
    Displacement_Mag_ZScore                 : 0.0378
    OB_Size_ATR                             : 0.0368
    FVG_Distance_to_Price_ATR_ZScore        : 0.0367
    BOS_Dist_ATR_ZScore                     : 0.0355
    OB_Displacement_ATR_ZScore              : 0.0352
    TBM_Reward_Per_Trade_ATR                : 0.0313
  Fold 3/5: Accuracy=0.734, F1=0.734

üå≤ Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.920
  Val accuracy:   0.719
  Train-Val gap:  0.201
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1150
    OB_Size_ATR                             : 0.0493
    TBM_Reward_Per_Trade_ATR                : 0.0420
    Displacement_Mag_ZScore                 : 0.0406
    FVG_Distance_to_Price_ATR               : 0.0392
    OB_Size_ATR_ZScore                      : 0.0387
    TBM_Risk_Per_Trade_ATR                  : 0.0372
    FVG_Quality_Fuzzy                       : 0.0314
    Trend_Strength                          : 0.0297
    FVG_Depth_ATR_ZScore                    : 0.0289
  Fold 4/5: Accuracy=0.719, F1=0.718

üå≤ Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.920
  Val accuracy:   0.805
  Train-Val gap:  0.116
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1045
    OB_Size_ATR_ZScore                      : 0.0418
    TBM_Risk_Per_Trade_ATR                  : 0.0403
    FVG_Distance_to_Price_ATR               : 0.0402
    OB_Size_ATR                             : 0.0364
    Displacement_Mag_ZScore                 : 0.0327
    BOS_Dist_ATR_ZScore                     : 0.0325
    Distance_to_Entry_ATR                   : 0.0325
    FVG_Quality_Fuzzy                       : 0.0320
    FVG_Size_Fuzzy_Score                    : 0.0294
  Fold 5/5: Accuracy=0.805, F1=0.804

  Cross-Validation Results:
    Mean Accuracy: 0.745 ¬± 0.035
    Min Accuracy:  0.705
    Max Accuracy:  0.805
    Range:         0.099
    Mean F1-Score: 0.744 ¬± 0.036
    ‚úÖ STABLE: Std dev 0.035 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.705 (deviation: -0.039)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: GBPUSD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for GBPUSD...

================================================================================
Training XGBoost for GBPUSD
================================================================================

üìÇ Loading data for GBPUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 196 samples
  Val:   48 samples
  Test:  44 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for GBPUSD...
  Training samples: 196
  Features: 57

  Train accuracy: 0.949
  Val accuracy:   0.688
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1441
    OB_Size_ATR                             : 0.0536
    FVG_Quality_Fuzzy                       : 0.0380
    FVG_Distance_to_Price_ATR               : 0.0376
    BOS_Commitment_Flag                     : 0.0341
    TBM_Risk_Per_Trade_ATR                  : 0.0326
    OB_Size_ATR_ZScore                      : 0.0321
    OB_Displacement_ATR_ZScore              : 0.0313
    TBM_Bars_to_Hit                         : 0.0297
    Trend_Strength_Fuzzy                    : 0.0294

üìä Evaluating on Validation set...

  Accuracy: 0.688
  Precision (macro): 0.704
  Recall (macro): 0.701
  F1-Score (macro): 0.687

  Win Rate (excl. timeouts):
    Predicted: 41.7%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          17         4
  True Win           11        16

  Overfitting Analysis:
    Training Accuracy: 0.949
    Validation Accuracy: 0.688
    Train-Val Gap: 0.261
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.682
  Precision (macro): 0.683
  Recall (macro): 0.682
  F1-Score (macro): 0.681

  Win Rate (excl. timeouts):
    Predicted: 54.5%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         8
  True Win            6        16

üíæ Model pickle saved to /kaggle/working/GBPUSD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/GBPUSD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for GBPUSD...

================================================================================
Training Neural Network for GBPUSD
================================================================================

üìÇ Loading data for GBPUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 196 samples
  Val:   48 samples
  Test:  44 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for GBPUSD...
  Device: cuda
  Training samples: 196
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 642
‚ö†Ô∏è Epoch 9: Exploding gradient detected (norm=15.34 > 10.0)
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.8077, Train Acc: 0.731 | Val Loss: 0.9286, Val Acc: 0.625
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6777, Train Acc: 0.857 | Val Loss: 0.9384, Val Acc: 0.646
‚ö†Ô∏è Epoch 26: Exploding gradient detected (norm=20.54 > 10.0)
‚ö†Ô∏è Epoch 30: Exploding gradient detected (norm=15.54 > 10.0)
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6502, Train Acc: 0.913 | Val Loss: 1.0178, Val Acc: 0.583
‚ö†Ô∏è Epoch 31: Exploding gradient detected (norm=4875.15 > 10.0)

  Early stopping at epoch 34 (patience=30)
Learning curves saved to: models/trained/GBPUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/GBPUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 28.00% (Threshold: 15%)
Total Epochs: 34
Training Duration: 0:00:03.334028

Final Metrics:
  Train Accuracy: 0.9050
  Val Accuracy:   0.6250
  Train Loss:     0.6600
  Val Loss:       1.0290

Best Epoch (Highest Val Accuracy):
  Epoch:          4
  Train Accuracy: 0.6573
  Val Accuracy:   0.6875
  Train Loss:     0.8382
  Val Loss:       0.8643
============================================================


  ‚ö†Ô∏è Training Warnings (4):
    - Epoch 9: Exploding gradient detected (norm=15.34 > 10.0)
    - Epoch 26: Exploding gradient detected (norm=20.54 > 10.0)
    - Epoch 30: Exploding gradient detected (norm=15.54 > 10.0)
    - Epoch 31: Exploding gradient detected (norm=4875.15 > 10.0)

  Final Train Accuracy: 0.905
  Final Val Accuracy:   0.625
  Train-Val Gap:        0.280 (28.0%)

üìä Evaluating on Validation set...

  Accuracy: 0.625
  Precision (macro): 0.619
  Recall (macro): 0.619
  F1-Score (macro): 0.619

  Win Rate (excl. timeouts):
    Predicted: 56.2%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12         9
  True Win            9        18

üìä Evaluating on Test set...

  Accuracy: 0.614
  Precision (macro): 0.616
  Recall (macro): 0.614
  F1-Score (macro): 0.612

  Win Rate (excl. timeouts):
    Predicted: 56.8%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12        10
  True Win            7        15

üíæ Model pickle saved to /kaggle/working/GBPUSD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/GBPUSD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/GBPUSD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.4s

üîÑ Starting LSTM training for GBPUSD...

================================================================================
Training LSTM for GBPUSD
================================================================================

üìÇ Loading data for GBPUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 196 samples
  Val:   48 samples
  Test:  44 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for GBPUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 196
  Features: 57
  Creating sequences...
  Sequence shape: (176, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6632, Train Acc: 0.648 | Val Loss: 1.1180, Val Acc: 0.357
  Epoch 20/200 - LR: 0.002807 - Train Loss: 0.5054, Train Acc: 0.733 | Val Loss: 1.2708, Val Acc: 0.500
  Epoch 30/200 - LR: 0.005211 - Train Loss: 0.3609, Train Acc: 0.869 | Val Loss: 1.3060, Val Acc: 0.500
‚ö†Ô∏è Epoch 32: Exploding gradient detected (norm=10.24 > 10.0)

  Early stopping at epoch 33

  ‚ö†Ô∏è Training Warnings (1):
    - Epoch 32: Exploding gradient detected (norm=10.24 > 10.0)

  Final Train Accuracy: 0.932
  Final Val Accuracy:   0.393
  Train-Val Gap:        0.539 (53.9%)

üìä Evaluating on Validation set...

  Accuracy: 0.354
  Precision (macro): 0.355
  Recall (macro): 0.378
  F1-Score (macro): 0.340

  Win Rate (excl. timeouts):
    Predicted: 29.2%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          12         9
  True Win           22         5

üìä Evaluating on Test set...

  Accuracy: 0.614
  Precision (macro): 0.652
  Recall (macro): 0.614
  F1-Score (macro): 0.588

  Win Rate (excl. timeouts):
    Predicted: 25.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          19         3
  True Win           14         8

üíæ Model pickle saved to /kaggle/working/GBPUSD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/GBPUSD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/GBPUSD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 5.4s

================================================================================
Symbol GBPUSD Training Summary:
  Total Duration: 15.6s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: USDCAD
################################################################################

################################################################################
# Training All Models for USDCAD
################################################################################

üå≤ Starting RandomForest training for USDCAD...

================================================================================
Training Random Forest for USDCAD
================================================================================

üìÇ Loading data for USDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 190 samples
  Val:   48 samples
  Test:  43 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for USDCAD...
  Training samples: 190
  Features: 57

  üìä Dataset has 190 samples (< 300), applying augmentation...
  Augmented: 190 ‚Üí 720 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.878
  Val accuracy:   0.757
  Train-Val gap:  0.122
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0778
    FVG_Size_Fuzzy_Score                    : 0.0635
    FVG_Quality_Fuzzy                       : 0.0493
    TBM_Risk_Per_Trade_ATR                  : 0.0426
    Displacement_Mag_ZScore                 : 0.0392
    BOS_Wick_Confirm                        : 0.0388
    FVG_Depth_ATR_ZScore                    : 0.0377
    TBM_Reward_Per_Trade_ATR                : 0.0347
    OB_Displacement_ATR_ZScore              : 0.0319
    Distance_to_Entry_ATR                   : 0.0319
  Fold 1/5: Accuracy=0.757, F1=0.756

üå≤ Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.903
  Val accuracy:   0.826
  Train-Val gap:  0.076
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0943
    FVG_Size_Fuzzy_Score                    : 0.0714
    FVG_Quality_Fuzzy                       : 0.0453
    FVG_Depth_ATR_ZScore                    : 0.0407
    TBM_Risk_Per_Trade_ATR                  : 0.0386
    TBM_Reward_Per_Trade_ATR                : 0.0341
    FVG_Depth_ATR                           : 0.0340
    FVG_Distance_to_Price_ATR               : 0.0337
    Displacement_Mag_ZScore                 : 0.0334
    TBM_Bars_to_Hit                         : 0.0297
  Fold 2/5: Accuracy=0.826, F1=0.825

üå≤ Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.894
  Val accuracy:   0.833
  Train-Val gap:  0.061
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    FVG_Size_Fuzzy_Score                    : 0.0736
    OB_Age                                  : 0.0664
    FVG_Quality_Fuzzy                       : 0.0537
    Displacement_Mag_ZScore                 : 0.0383
    TBM_Risk_Per_Trade_ATR                  : 0.0380
    OB_Displacement_ATR_ZScore              : 0.0371
    FVG_Depth_ATR_ZScore                    : 0.0345
    FVG_Depth_ATR                           : 0.0333
    TBM_Bars_to_Hit                         : 0.0312
    Distance_to_Entry_ATR                   : 0.0303
  Fold 3/5: Accuracy=0.833, F1=0.833

üå≤ Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.901
  Val accuracy:   0.757
  Train-Val gap:  0.144
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0903
    FVG_Size_Fuzzy_Score                    : 0.0675
    FVG_Depth_ATR_ZScore                    : 0.0551
    FVG_Quality_Fuzzy                       : 0.0524
    TBM_Risk_Per_Trade_ATR                  : 0.0440
    FVG_Depth_ATR                           : 0.0420
    TBM_Bars_to_Hit                         : 0.0335
    OB_Displacement_ATR_ZScore              : 0.0331
    Distance_to_Entry_ATR                   : 0.0326
    Displacement_Mag_ZScore                 : 0.0305
  Fold 4/5: Accuracy=0.757, F1=0.753

üå≤ Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.905
  Val accuracy:   0.771
  Train-Val gap:  0.134
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.0838
    FVG_Size_Fuzzy_Score                    : 0.0498
    FVG_Depth_ATR_ZScore                    : 0.0448
    FVG_Distance_to_Price_ATR_ZScore        : 0.0383
    FVG_Quality_Fuzzy                       : 0.0363
    TBM_Reward_Per_Trade_ATR                : 0.0359
    FVG_Distance_to_Price_ATR               : 0.0345
    OB_Size_ATR_ZScore                      : 0.0337
    TBM_Bars_to_Hit                         : 0.0315
    OB_Displacement_ATR_ZScore              : 0.0311
  Fold 5/5: Accuracy=0.771, F1=0.771

  Cross-Validation Results:
    Mean Accuracy: 0.789 ¬± 0.034
    Min Accuracy:  0.757
    Max Accuracy:  0.833
    Range:         0.076
    Mean F1-Score: 0.788 ¬± 0.035
    ‚úÖ STABLE: Std dev 0.034 ‚â§ 0.10

‚ùå RandomForest training failed: 'is_stable'
   Symbol: USDCAD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for USDCAD...

================================================================================
Training XGBoost for USDCAD
================================================================================

üìÇ Loading data for USDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 190 samples
  Val:   48 samples
  Test:  43 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for USDCAD...
  Training samples: 190
  Features: 57

  Train accuracy: 0.911
  Val accuracy:   0.625
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1416
    TBM_Risk_Per_Trade_ATR                  : 0.0606
    FVG_Size_Fuzzy_Score                    : 0.0589
    TBM_Reward_Per_Trade_ATR                : 0.0551
    FVG_Quality_Fuzzy                       : 0.0459
    OB_Size_ATR                             : 0.0419
    FVG_Depth_ATR_ZScore                    : 0.0388
    RSI                                     : 0.0317
    FVG_Distance_to_Price_ATR               : 0.0312
    Displacement_Mag_ZScore                 : 0.0306

üìä Evaluating on Validation set...

  Accuracy: 0.625
  Precision (macro): 0.662
  Recall (macro): 0.670
  F1-Score (macro): 0.624

  Win Rate (excl. timeouts):
    Predicted: 60.4%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          16        15
  True Win            3        14

  Overfitting Analysis:
    Training Accuracy: 0.911
    Validation Accuracy: 0.625
    Train-Val Gap: 0.286
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.651
  Precision (macro): 0.656
  Recall (macro): 0.627
  F1-Score (macro): 0.622

  Win Rate (excl. timeouts):
    Predicted: 72.1%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           8        11
  True Win            4        20

üíæ Model pickle saved to /kaggle/working/USDCAD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/USDCAD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for USDCAD...

================================================================================
Training Neural Network for USDCAD
================================================================================

üìÇ Loading data for USDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 190 samples
  Val:   48 samples
  Test:  43 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for USDCAD...
  Device: cuda
  Training samples: 190
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 720
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7555, Train Acc: 0.760 | Val Loss: 0.8720, Val Acc: 0.646
  Epoch 20/200 - LR: 0.005000 - Train Loss: 0.6422, Train Acc: 0.882 | Val Loss: 0.8489, Val Acc: 0.708
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.5877, Train Acc: 0.933 | Val Loss: 0.9278, Val Acc: 0.688
  Epoch 40/200 - LR: 0.000625 - Train Loss: 0.5693, Train Acc: 0.938 | Val Loss: 0.9589, Val Acc: 0.688

  Early stopping at epoch 42 (patience=30)
Learning curves saved to: models/trained/USDCAD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDCAD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 28.06% (Threshold: 15%)
Total Epochs: 42
Training Duration: 0:00:04.374684

Final Metrics:
  Train Accuracy: 0.9472
  Val Accuracy:   0.6667
  Train Loss:     0.5794
  Val Loss:       0.9887

Best Epoch (Highest Val Accuracy):
  Epoch:          8
  Train Accuracy: 0.7417
  Val Accuracy:   0.7917
  Train Loss:     0.7747
  Val Loss:       0.7885
============================================================


  Final Train Accuracy: 0.947
  Final Val Accuracy:   0.667
  Train-Val Gap:        0.281 (28.1%)

üìä Evaluating on Validation set...

  Accuracy: 0.667
  Precision (macro): 0.688
  Recall (macro): 0.702
  F1-Score (macro): 0.664

  Win Rate (excl. timeouts):
    Predicted: 56.2%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18        13
  True Win            3        14

üìä Evaluating on Test set...

  Accuracy: 0.558
  Precision (macro): 0.543
  Recall (macro): 0.538
  F1-Score (macro): 0.533

  Win Rate (excl. timeouts):
    Predicted: 67.4%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           7        12
  True Win            7        17

üíæ Model pickle saved to /kaggle/working/USDCAD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/USDCAD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/USDCAD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 5.4s

üîÑ Starting LSTM training for USDCAD...

================================================================================
Training LSTM for USDCAD
================================================================================

üìÇ Loading data for USDCAD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 190 samples
  Val:   48 samples
  Test:  43 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for USDCAD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 190
  Features: 57
  Creating sequences...
  Sequence shape: (170, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6231, Train Acc: 0.676 | Val Loss: 0.9890, Val Acc: 0.321
  Epoch 20/200 - LR: 0.002807 - Train Loss: 0.4441, Train Acc: 0.788 | Val Loss: 2.0840, Val Acc: 0.393
  Epoch 30/200 - LR: 0.005211 - Train Loss: 0.2475, Train Acc: 0.888 | Val Loss: 3.4293, Val Acc: 0.464

  Early stopping at epoch 34

  Final Train Accuracy: 0.894
  Final Val Accuracy:   0.393
  Train-Val Gap:        0.501 (50.1%)

üìä Evaluating on Validation set...

  Accuracy: 0.479
  Precision (macro): 0.439
  Recall (macro): 0.437
  F1-Score (macro): 0.438

  Win Rate (excl. timeouts):
    Predicted: 37.5%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18        13
  True Win           12         5

üìä Evaluating on Test set...

  Accuracy: 0.581
  Precision (macro): 0.593
  Recall (macro): 0.592
  F1-Score (macro): 0.581

  Win Rate (excl. timeouts):
    Predicted: 41.9%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         6
  True Win           12        12

üíæ Model pickle saved to /kaggle/working/USDCAD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/USDCAD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/USDCAD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 5.4s

================================================================================
Symbol USDCAD Training Summary:
  Total Duration: 16.9s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: USDCHF
################################################################################

################################################################################
# Training All Models for USDCHF
################################################################################

üå≤ Starting RandomForest training for USDCHF...

================================================================================
Training Random Forest for USDCHF
================================================================================

üìÇ Loading data for USDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 201 samples
  Val:   46 samples
  Test:  46 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for USDCHF...
  Training samples: 201
  Features: 57

  üìä Dataset has 201 samples (< 300), applying augmentation...
  Augmented: 201 ‚Üí 464 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for USDCHF...
  Training samples: 371
  Features: 57

  Train accuracy: 0.884
  Val accuracy:   0.860
  Train-Val gap:  0.024
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1170
    FVG_Distance_to_Price_ATR_ZScore        : 0.0592
    FVG_Depth_ATR_ZScore                    : 0.0485
    FVG_Distance_to_Price_ATR               : 0.0477
    TBM_Reward_Per_Trade_ATR                : 0.0459
    TBM_Bars_to_Hit                         : 0.0454
    TBM_Risk_Per_Trade_ATR                  : 0.0407
    Displacement_Mag_ZScore                 : 0.0339
    Distance_to_Entry_ATR                   : 0.0335
    FVG_Size_Fuzzy_Score                    : 0.0316
  Fold 1/5: Accuracy=0.860, F1=0.860

üå≤ Training Random Forest for USDCHF...
  Training samples: 371
  Features: 57

  Train accuracy: 0.881
  Val accuracy:   0.774
  Train-Val gap:  0.107
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1114
    TBM_Risk_Per_Trade_ATR                  : 0.0692
    TBM_Reward_Per_Trade_ATR                : 0.0679
    FVG_Distance_to_Price_ATR_ZScore        : 0.0511
    Distance_to_Entry_ATR                   : 0.0496
    TBM_Bars_to_Hit                         : 0.0483
    FVG_Distance_to_Price_ATR               : 0.0399
    FVG_Depth_ATR_ZScore                    : 0.0378
    FVG_Size_Fuzzy_Score                    : 0.0346
    Displacement_Mag_ZScore                 : 0.0335
  Fold 2/5: Accuracy=0.774, F1=0.774

üå≤ Training Random Forest for USDCHF...
  Training samples: 371
  Features: 57

  Train accuracy: 0.903
  Val accuracy:   0.796
  Train-Val gap:  0.107
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1019
    TBM_Reward_Per_Trade_ATR                : 0.0534
    FVG_Depth_ATR_ZScore                    : 0.0486
    TBM_Bars_to_Hit                         : 0.0484
    TBM_Risk_Per_Trade_ATR                  : 0.0476
    FVG_Distance_to_Price_ATR_ZScore        : 0.0475
    FVG_Quality_Fuzzy                       : 0.0447
    FVG_Depth_ATR                           : 0.0395
    Distance_to_Entry_ATR                   : 0.0395
    OB_Size_ATR_ZScore                      : 0.0389
  Fold 3/5: Accuracy=0.796, F1=0.794

üå≤ Training Random Forest for USDCHF...
  Training samples: 371
  Features: 57

  Train accuracy: 0.879
  Val accuracy:   0.731
  Train-Val gap:  0.148
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1152
    TBM_Risk_Per_Trade_ATR                  : 0.0647
    TBM_Reward_Per_Trade_ATR                : 0.0633
    TBM_Bars_to_Hit                         : 0.0476
    Distance_to_Entry_ATR                   : 0.0428
    FVG_Depth_ATR_ZScore                    : 0.0414
    FVG_Distance_to_Price_ATR_ZScore        : 0.0410
    FVG_Size_Fuzzy_Score                    : 0.0372
    FVG_Quality_Fuzzy                       : 0.0341
    FVG_Distance_to_Price_ATR               : 0.0313
  Fold 4/5: Accuracy=0.731, F1=0.731

üå≤ Training Random Forest for USDCHF...
  Training samples: 372
  Features: 57

  Train accuracy: 0.890
  Val accuracy:   0.707
  Train-Val gap:  0.183
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1051
    TBM_Bars_to_Hit                         : 0.0678
    TBM_Risk_Per_Trade_ATR                  : 0.0516
    TBM_Reward_Per_Trade_ATR                : 0.0475
    FVG_Distance_to_Price_ATR_ZScore        : 0.0471
    FVG_Distance_to_Price_ATR               : 0.0426
    FVG_Depth_ATR_ZScore                    : 0.0354
    Distance_to_Entry_ATR                   : 0.0340
    FVG_Size_Fuzzy_Score                    : 0.0322
    Displacement_Mag_ZScore                 : 0.0320
  Fold 5/5: Accuracy=0.707, F1=0.706

  Cross-Validation Results:
    Mean Accuracy: 0.774 ¬± 0.053
    Min Accuracy:  0.707
    Max Accuracy:  0.860
    Range:         0.154
    Mean F1-Score: 0.773 ¬± 0.053
    ‚úÖ STABLE: Std dev 0.053 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 5: 0.707 (deviation: -0.067)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: USDCHF
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for USDCHF...

================================================================================
Training XGBoost for USDCHF
================================================================================

üìÇ Loading data for USDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 201 samples
  Val:   46 samples
  Test:  46 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for USDCHF...
  Training samples: 201
  Features: 57

  Train accuracy: 0.925
  Val accuracy:   0.739
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1266
    FVG_Depth_ATR                           : 0.0603
    OB_Bullish_Valid                        : 0.0487
    OB_Quality_Fuzzy                        : 0.0452
    TBM_Reward_Per_Trade_ATR                : 0.0448
    TBM_Risk_Per_Trade_ATR                  : 0.0422
    FVG_Distance_to_Price_ATR_ZScore        : 0.0364
    FVG_Distance_to_Price_ATR               : 0.0355
    FVG_Size_Fuzzy_Score                    : 0.0334
    FVG_Depth_ATR_ZScore                    : 0.0306

üìä Evaluating on Validation set...

  Accuracy: 0.739
  Precision (macro): 0.684
  Recall (macro): 0.735
  F1-Score (macro): 0.692

  Win Rate (excl. timeouts):
    Predicted: 63.0%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           8         3
  True Win            9        26

  Overfitting Analysis:
    Training Accuracy: 0.925
    Validation Accuracy: 0.739
    Train-Val Gap: 0.186
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.739
  Precision (macro): 0.741
  Recall (macro): 0.739
  F1-Score (macro): 0.739

  Win Rate (excl. timeouts):
    Predicted: 45.7%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18         5
  True Win            7        16

üíæ Model pickle saved to /kaggle/working/USDCHF_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/USDCHF_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.1s

üß† Starting Neural Network training for USDCHF...

================================================================================
Training Neural Network for USDCHF
================================================================================

üìÇ Loading data for USDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 201 samples
  Val:   46 samples
  Test:  46 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for USDCHF...
  Device: cuda
  Training samples: 201
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 464
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7887, Train Acc: 0.780 | Val Loss: 0.8147, Val Acc: 0.696
  Epoch 20/200 - LR: 0.010000 - Train Loss: 0.6880, Train Acc: 0.832 | Val Loss: 0.8594, Val Acc: 0.587
  Epoch 30/200 - LR: 0.002500 - Train Loss: 0.5940, Train Acc: 0.933 | Val Loss: 0.8584, Val Acc: 0.696
  Epoch 40/200 - LR: 0.000625 - Train Loss: 0.5596, Train Acc: 0.959 | Val Loss: 0.8272, Val Acc: 0.761

  Early stopping at epoch 45 (patience=30)
Learning curves saved to: models/trained/USDCHF_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDCHF_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 19.82% (Threshold: 15%)
Total Epochs: 45
Training Duration: 0:00:03.206358

Final Metrics:
  Train Accuracy: 0.9591
  Val Accuracy:   0.7609
  Train Loss:     0.5628
  Val Loss:       0.8262

Best Epoch (Highest Val Accuracy):
  Epoch:          22
  Train Accuracy: 0.8966
  Val Accuracy:   0.8043
  Train Loss:     0.6324
  Val Loss:       0.7880
============================================================


  Final Train Accuracy: 0.959
  Final Val Accuracy:   0.761
  Train-Val Gap:        0.198 (19.8%)

üìä Evaluating on Validation set...

  Accuracy: 0.761
  Precision (macro): 0.667
  Recall (macro): 0.656
  F1-Score (macro): 0.661

  Win Rate (excl. timeouts):
    Predicted: 78.3%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           5         6
  True Win            5        30

üìä Evaluating on Test set...

  Accuracy: 0.609
  Precision (macro): 0.610
  Recall (macro): 0.609
  F1-Score (macro): 0.608

  Win Rate (excl. timeouts):
    Predicted: 54.3%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13        10
  True Win            8        15

üíæ Model pickle saved to /kaggle/working/USDCHF_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/USDCHF_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/USDCHF_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.2s

üîÑ Starting LSTM training for USDCHF...

================================================================================
Training LSTM for USDCHF
================================================================================

üìÇ Loading data for USDCHF...
  Excluding timeout samples (TBM_Label == 0)
  Train: 201 samples
  Val:   46 samples
  Test:  46 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for USDCHF...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 201
  Features: 57
  Creating sequences...
  Sequence shape: (181, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6477, Train Acc: 0.669 | Val Loss: 0.7532, Val Acc: 0.538
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.4468, Train Acc: 0.768 | Val Loss: 0.9233, Val Acc: 0.385
‚ö†Ô∏è Epoch 30: Exploding gradient detected (norm=11.19 > 10.0)
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.3954, Train Acc: 0.939 | Val Loss: 3.0970, Val Acc: 0.538

  Early stopping at epoch 33

  ‚ö†Ô∏è Training Warnings (1):
    - Epoch 30: Exploding gradient detected (norm=11.19 > 10.0)

  Final Train Accuracy: 0.906
  Final Val Accuracy:   0.269
  Train-Val Gap:        0.637 (63.7%)

üìä Evaluating on Validation set...

  Accuracy: 0.174
  Precision (macro): 0.220
  Recall (macro): 0.301
  F1-Score (macro): 0.168

  Win Rate (excl. timeouts):
    Predicted: 15.2%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           6         5
  True Win           33         2

üìä Evaluating on Test set...

  Accuracy: 0.500
  Precision (macro): 0.500
  Recall (macro): 0.500
  F1-Score (macro): 0.421

  Win Rate (excl. timeouts):
    Predicted: 13.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          20         3
  True Win           20         3

üíæ Model pickle saved to /kaggle/working/USDCHF_LSTM.pkl
üíæ Metadata saved to /kaggle/working/USDCHF_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/USDCHF_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 5.8s

================================================================================
Symbol USDCHF Training Summary:
  Total Duration: 15.6s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: USDJPY
################################################################################

################################################################################
# Training All Models for USDJPY
################################################################################

üå≤ Starting RandomForest training for USDJPY...

================================================================================
Training Random Forest for USDJPY
================================================================================

üìÇ Loading data for USDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 270 samples
  Val:   50 samples
  Test:  53 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for USDJPY...
  Training samples: 270
  Features: 57

  üìä Dataset has 270 samples (< 300), applying augmentation...
  Augmented: 270 ‚Üí 624 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for USDJPY...
  Training samples: 499
  Features: 57

  Train accuracy: 0.922
  Val accuracy:   0.816
  Train-Val gap:  0.106
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1759
    FVG_Distance_to_Price_ATR               : 0.0625
    TBM_Reward_Per_Trade_ATR                : 0.0576
    FVG_Distance_to_Price_ATR_ZScore        : 0.0537
    TBM_Risk_Per_Trade_ATR                  : 0.0506
    Distance_to_Entry_ATR                   : 0.0504
    TBM_Bars_to_Hit                         : 0.0318
    FVG_Depth_ATR                           : 0.0313
    FVG_Size_Fuzzy_Score                    : 0.0244
    Trend_Strength                          : 0.0242
  Fold 1/5: Accuracy=0.816, F1=0.814

üå≤ Training Random Forest for USDJPY...
  Training samples: 499
  Features: 57

  Train accuracy: 0.914
  Val accuracy:   0.800
  Train-Val gap:  0.114
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1621
    FVG_Distance_to_Price_ATR_ZScore        : 0.0631
    FVG_Distance_to_Price_ATR               : 0.0623
    TBM_Reward_Per_Trade_ATR                : 0.0593
    TBM_Risk_Per_Trade_ATR                  : 0.0588
    Distance_to_Entry_ATR                   : 0.0458
    FVG_Depth_ATR_ZScore                    : 0.0269
    FVG_Size_Fuzzy_Score                    : 0.0254
    TBM_Bars_to_Hit                         : 0.0238
    FVG_Depth_ATR                           : 0.0234
  Fold 2/5: Accuracy=0.800, F1=0.800

üå≤ Training Random Forest for USDJPY...
  Training samples: 499
  Features: 57

  Train accuracy: 0.930
  Val accuracy:   0.840
  Train-Val gap:  0.090
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1629
    TBM_Risk_Per_Trade_ATR                  : 0.0631
    FVG_Distance_to_Price_ATR_ZScore        : 0.0603
    TBM_Reward_Per_Trade_ATR                : 0.0547
    FVG_Distance_to_Price_ATR               : 0.0476
    Distance_to_Entry_ATR                   : 0.0371
    FVG_Depth_ATR_ZScore                    : 0.0345
    Trend_Strength                          : 0.0287
    FVG_Size_Fuzzy_Score                    : 0.0265
    Displacement_Mag_ZScore                 : 0.0237
  Fold 3/5: Accuracy=0.840, F1=0.839

üå≤ Training Random Forest for USDJPY...
  Training samples: 499
  Features: 57

  Train accuracy: 0.918
  Val accuracy:   0.808
  Train-Val gap:  0.110
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1663
    TBM_Risk_Per_Trade_ATR                  : 0.0763
    TBM_Reward_Per_Trade_ATR                : 0.0687
    Distance_to_Entry_ATR                   : 0.0558
    FVG_Distance_to_Price_ATR_ZScore        : 0.0488
    FVG_Distance_to_Price_ATR               : 0.0439
    TBM_Bars_to_Hit                         : 0.0276
    BOS_Dist_ATR_ZScore                     : 0.0230
    FVG_Bearish_Valid                       : 0.0228
    FVG_Depth_ATR_ZScore                    : 0.0218
  Fold 4/5: Accuracy=0.808, F1=0.807

üå≤ Training Random Forest for USDJPY...
  Training samples: 500
  Features: 57

  Train accuracy: 0.912
  Val accuracy:   0.790
  Train-Val gap:  0.122
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1708
    TBM_Risk_Per_Trade_ATR                  : 0.0728
    TBM_Reward_Per_Trade_ATR                : 0.0656
    FVG_Distance_to_Price_ATR_ZScore        : 0.0563
    Distance_to_Entry_ATR                   : 0.0465
    FVG_Distance_to_Price_ATR               : 0.0414
    FVG_Size_Fuzzy_Score                    : 0.0304
    FVG_Depth_ATR_ZScore                    : 0.0293
    TBM_Bars_to_Hit                         : 0.0286
    Trend_Strength_Fuzzy                    : 0.0271
  Fold 5/5: Accuracy=0.790, F1=0.790

  Cross-Validation Results:
    Mean Accuracy: 0.811 ¬± 0.017
    Min Accuracy:  0.790
    Max Accuracy:  0.840
    Range:         0.050
    Mean F1-Score: 0.810 ¬± 0.017
    ‚úÖ STABLE: Std dev 0.017 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 5: 0.790 (deviation: -0.021)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: USDJPY
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for USDJPY...

================================================================================
Training XGBoost for USDJPY
================================================================================

üìÇ Loading data for USDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 270 samples
  Val:   50 samples
  Test:  53 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for USDJPY...
  Training samples: 270
  Features: 57

  Train accuracy: 0.948
  Val accuracy:   0.720
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1566
    TBM_Reward_Per_Trade_ATR                : 0.0556
    FVG_Distance_to_Price_ATR               : 0.0467
    TBM_Risk_Per_Trade_ATR                  : 0.0403
    FVG_Distance_to_Price_ATR_ZScore        : 0.0396
    FVG_Bearish_Valid                       : 0.0387
    BOS_Dist_ATR                            : 0.0322
    FVG_Bearish                             : 0.0306
    Trend_Strength                          : 0.0267
    FVG_Depth_ATR_ZScore                    : 0.0261

üìä Evaluating on Validation set...

  Accuracy: 0.720
  Precision (macro): 0.721
  Recall (macro): 0.720
  F1-Score (macro): 0.720

  Win Rate (excl. timeouts):
    Predicted: 54.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          17         8
  True Win            6        19

  Overfitting Analysis:
    Training Accuracy: 0.948
    Validation Accuracy: 0.720
    Train-Val Gap: 0.228
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.660
  Precision (macro): 0.658
  Recall (macro): 0.668
  F1-Score (macro): 0.654

  Win Rate (excl. timeouts):
    Predicted: 50.9%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         6
  True Win           12        21

üíæ Model pickle saved to /kaggle/working/USDJPY_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/USDJPY_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.3s

üß† Starting Neural Network training for USDJPY...

================================================================================
Training Neural Network for USDJPY
================================================================================

üìÇ Loading data for USDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 270 samples
  Val:   50 samples
  Test:  53 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for USDJPY...
  Device: cuda
  Training samples: 270
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 624
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7476, Train Acc: 0.766 | Val Loss: 0.8855, Val Acc: 0.680
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6732, Train Acc: 0.865 | Val Loss: 0.9398, Val Acc: 0.620
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6564, Train Acc: 0.880 | Val Loss: 0.9808, Val Acc: 0.640
  Epoch 40/200 - LR: 0.000313 - Train Loss: 0.6107, Train Acc: 0.913 | Val Loss: 0.9667, Val Acc: 0.640

  Early stopping at epoch 42 (patience=30)
Learning curves saved to: models/trained/USDJPY_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDJPY_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 26.54% (Threshold: 15%)
Total Epochs: 42
Training Duration: 0:00:03.869365

Final Metrics:
  Train Accuracy: 0.9054
  Val Accuracy:   0.6400
  Train Loss:     0.6210
  Val Loss:       0.9660

Best Epoch (Highest Val Accuracy):
  Epoch:          5
  Train Accuracy: 0.7131
  Val Accuracy:   0.7000
  Train Loss:     0.8135
  Val Loss:       0.8594
============================================================


  Final Train Accuracy: 0.905
  Final Val Accuracy:   0.640
  Train-Val Gap:        0.265 (26.5%)

üìä Evaluating on Validation set...

  Accuracy: 0.640
  Precision (macro): 0.641
  Recall (macro): 0.640
  F1-Score (macro): 0.639

  Win Rate (excl. timeouts):
    Predicted: 54.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          15        10
  True Win            8        17

üìä Evaluating on Test set...

  Accuracy: 0.736
  Precision (macro): 0.721
  Recall (macro): 0.729
  F1-Score (macro): 0.724

  Win Rate (excl. timeouts):
    Predicted: 58.5%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14         6
  True Win            8        25

üíæ Model pickle saved to /kaggle/working/USDJPY_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/USDJPY_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/USDJPY_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.9s

üîÑ Starting LSTM training for USDJPY...

================================================================================
Training LSTM for USDJPY
================================================================================

üìÇ Loading data for USDJPY...
  Excluding timeout samples (TBM_Label == 0)
  Train: 270 samples
  Val:   50 samples
  Test:  53 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for USDJPY...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 270
  Features: 57
  Creating sequences...
  Sequence shape: (250, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.5878, Train Acc: 0.708 | Val Loss: 0.7682, Val Acc: 0.467
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.4166, Train Acc: 0.808 | Val Loss: 1.7287, Val Acc: 0.533
‚ö†Ô∏è Epoch 30: Exploding gradient detected (norm=11.94 > 10.0)
  Epoch 30/200 - LR: 0.005208 - Train Loss: 0.2286, Train Acc: 0.944 | Val Loss: 2.2910, Val Acc: 0.600
‚ö†Ô∏è Epoch 33: Severe overfitting detected (train=95.20%, val=50.00%)
‚ö†Ô∏è Epoch 35: Severe overfitting detected (train=96.00%, val=46.67%)
  Epoch 40/200 - LR: 0.007609 - Train Loss: 0.2633, Train Acc: 0.936 | Val Loss: 2.6663, Val Acc: 0.600

  Early stopping at epoch 42

  ‚ö†Ô∏è Training Warnings (3):
    - Epoch 30: Exploding gradient detected (norm=11.94 > 10.0)
    - Epoch 33: Severe overfitting detected (train=95.20%, val=50.00%)
    - Epoch 35: Severe overfitting detected (train=96.00%, val=46.67%)

  Final Train Accuracy: 0.920
  Final Val Accuracy:   0.433
  Train-Val Gap:        0.487 (48.7%)

üìä Evaluating on Validation set...

  Accuracy: 0.420
  Precision (macro): 0.413
  Recall (macro): 0.420
  F1-Score (macro): 0.408

  Win Rate (excl. timeouts):
    Predicted: 36.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          14        11
  True Win           18         7

üìä Evaluating on Test set...

  Accuracy: 0.472
  Precision (macro): 0.507
  Recall (macro): 0.507
  F1-Score (macro): 0.472

  Win Rate (excl. timeouts):
    Predicted: 35.8%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13         7
  True Win           21        12

üíæ Model pickle saved to /kaggle/working/USDJPY_LSTM.pkl
üíæ Metadata saved to /kaggle/working/USDJPY_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/USDJPY_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 8.5s

================================================================================
Symbol USDJPY Training Summary:
  Total Duration: 19.3s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

################################################################################
# TRAINING: XAUUSD
################################################################################

################################################################################
# Training All Models for XAUUSD
################################################################################

üå≤ Starting RandomForest training for XAUUSD...

================================================================================
Training Random Forest for XAUUSD
================================================================================

üìÇ Loading data for XAUUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 252 samples
  Val:   62 samples
  Test:  66 samples
  Selected 57 features
  Remapped labels: [0 1]

üå≤ Training Random Forest for XAUUSD...
  Training samples: 252
  Features: 57

  üìä Dataset has 252 samples (< 300), applying augmentation...
  Augmented: 252 ‚Üí 604 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for XAUUSD...
  Training samples: 483
  Features: 57

  Train accuracy: 0.923
  Val accuracy:   0.826
  Train-Val gap:  0.097
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1189
    FVG_Distance_to_Price_ATR_ZScore        : 0.0775
    TBM_Bars_to_Hit                         : 0.0479
    FVG_Distance_to_Price_ATR               : 0.0448
    TBM_Risk_Per_Trade_ATR                  : 0.0396
    TBM_Reward_Per_Trade_ATR                : 0.0376
    FVG_Depth_ATR_ZScore                    : 0.0306
    OB_Quality_Fuzzy                        : 0.0267
    RSI_Normalized                          : 0.0264
    FVG_Size_Fuzzy_Score                    : 0.0262
  Fold 1/5: Accuracy=0.826, F1=0.826

üå≤ Training Random Forest for XAUUSD...
  Training samples: 483
  Features: 57

  Train accuracy: 0.925
  Val accuracy:   0.810
  Train-Val gap:  0.116
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1276
    FVG_Distance_to_Price_ATR_ZScore        : 0.0601
    TBM_Bars_to_Hit                         : 0.0531
    FVG_Distance_to_Price_ATR               : 0.0519
    FVG_Depth_ATR_ZScore                    : 0.0380
    TBM_Risk_Per_Trade_ATR                  : 0.0349
    TBM_Reward_Per_Trade_ATR                : 0.0301
    OB_Quality_Fuzzy                        : 0.0295
    RSI                                     : 0.0273
    ATR_ZScore                              : 0.0260
  Fold 2/5: Accuracy=0.810, F1=0.810

üå≤ Training Random Forest for XAUUSD...
  Training samples: 483
  Features: 57

  Train accuracy: 0.930
  Val accuracy:   0.835
  Train-Val gap:  0.095
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1226
    FVG_Distance_to_Price_ATR_ZScore        : 0.0569
    TBM_Bars_to_Hit                         : 0.0559
    FVG_Distance_to_Price_ATR               : 0.0490
    TBM_Risk_Per_Trade_ATR                  : 0.0374
    atr                                     : 0.0345
    FVG_Depth_ATR_ZScore                    : 0.0292
    OB_Quality_Fuzzy                        : 0.0289
    TBM_Reward_Per_Trade_ATR                : 0.0279
    Displacement_Mag_ZScore                 : 0.0275
  Fold 3/5: Accuracy=0.835, F1=0.834

üå≤ Training Random Forest for XAUUSD...
  Training samples: 483
  Features: 57

  Train accuracy: 0.938
  Val accuracy:   0.793
  Train-Val gap:  0.144
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1076
    FVG_Distance_to_Price_ATR_ZScore        : 0.0610
    TBM_Bars_to_Hit                         : 0.0451
    TBM_Reward_Per_Trade_ATR                : 0.0405
    TBM_Risk_Per_Trade_ATR                  : 0.0392
    RSI                                     : 0.0370
    FVG_Distance_to_Price_ATR               : 0.0350
    OB_Quality_Fuzzy                        : 0.0333
    ATR_ZScore                              : 0.0328
    atr                                     : 0.0314
  Fold 4/5: Accuracy=0.793, F1=0.793

üå≤ Training Random Forest for XAUUSD...
  Training samples: 484
  Features: 57

  Train accuracy: 0.921
  Val accuracy:   0.833
  Train-Val gap:  0.088
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Top 10 Most Important Features:
    OB_Age                                  : 0.1286
    FVG_Distance_to_Price_ATR               : 0.0635
    TBM_Bars_to_Hit                         : 0.0573
    FVG_Distance_to_Price_ATR_ZScore        : 0.0507
    TBM_Risk_Per_Trade_ATR                  : 0.0443
    TBM_Reward_Per_Trade_ATR                : 0.0367
    atr                                     : 0.0309
    Trend_Bias_Indicator                    : 0.0262
    Distance_to_Entry_ATR                   : 0.0261
    OB_Quality_Fuzzy                        : 0.0259
  Fold 5/5: Accuracy=0.833, F1=0.830

  Cross-Validation Results:
    Mean Accuracy: 0.820 ¬± 0.016
    Min Accuracy:  0.793
    Max Accuracy:  0.835
    Range:         0.041
    Mean F1-Score: 0.819 ¬± 0.015
    ‚úÖ STABLE: Std dev 0.016 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.793 (deviation: -0.026)

‚ùå RandomForest training failed: 'is_stable'
   Symbol: XAUUSD
   Error Type: KeyError
   Traceback: Traceback (most recent call last):
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 566, in train_all_for_symbol
    results['RandomForest'] = self.train_random_forest(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/train_all_models.py", line 362, in train_random_forest
    history = model.train(
              ^^^^^^^^^^^^
  File "/kaggle/working/integrated-pipeline/models/random_forest_model.py", line 149, in train
    self.training_history['cv_is_stable'] = cv_results['is_stable']
                                            ~~~~~~~~~~^^^^^^^^^^^^^
KeyError: 'is_stable'


üöÄ Starting XGBoost training for XAUUSD...

================================================================================
Training XGBoost for XAUUSD
================================================================================

üìÇ Loading data for XAUUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 252 samples
  Val:   62 samples
  Test:  66 samples
  Selected 57 features
  Remapped labels: [0 1]

üöÄ Training XGBoost for XAUUSD...
  Training samples: 252
  Features: 57

  Train accuracy: 0.940
  Val accuracy:   0.661
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1224
    OB_Bearish                              : 0.0583
    TBM_Reward_Per_Trade_ATR                : 0.0536
    FVG_Distance_to_Price_ATR               : 0.0488
    TBM_Bars_to_Hit                         : 0.0425
    FVG_Distance_to_Price_ATR_ZScore        : 0.0398
    TBM_Risk_Per_Trade_ATR                  : 0.0355
    OB_Displacement_ATR                     : 0.0298
    ATR_ZScore                              : 0.0291
    Displacement_Mag_ZScore                 : 0.0285

üìä Evaluating on Validation set...

  Accuracy: 0.661
  Precision (macro): 0.660
  Recall (macro): 0.659
  F1-Score (macro): 0.659

  Win Rate (excl. timeouts):
    Predicted: 54.8%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18        11
  True Win           10        23

  Overfitting Analysis:
    Training Accuracy: 0.940
    Validation Accuracy: 0.661
    Train-Val Gap: 0.279
    ‚ö†Ô∏è OVERFITTING DETECTED (gap > 15%)

üìä Evaluating on Test set...

  Accuracy: 0.667
  Precision (macro): 0.623
  Recall (macro): 0.629
  F1-Score (macro): 0.625

  Win Rate (excl. timeouts):
    Predicted: 65.2%
    Actual:    68.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11        10
  True Win           12        33

üíæ Model pickle saved to /kaggle/working/XAUUSD_XGBoost.pkl
üíæ Metadata saved to /kaggle/working/XAUUSD_XGBoost_metadata.json

‚úÖ Model save complete: /kaggle/working
‚úÖ XGBoost completed in 1.2s

üß† Starting Neural Network training for XAUUSD...

================================================================================
Training Neural Network for XAUUSD
================================================================================

üìÇ Loading data for XAUUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 252 samples
  Val:   62 samples
  Test:  66 samples
  Selected 57 features
  Remapped labels: [0 1]

üß† Training Neural Network for XAUUSD...
  Device: cuda
  Training samples: 252
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 604
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7304, Train Acc: 0.795 | Val Loss: 0.8894, Val Acc: 0.597
  Epoch 20/200 - LR: 0.005000 - Train Loss: 0.6807, Train Acc: 0.838 | Val Loss: 0.8675, Val Acc: 0.677
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6088, Train Acc: 0.916 | Val Loss: 0.9429, Val Acc: 0.629
‚ö†Ô∏è Epoch 38: Severe overfitting detected (train=95.86%, val=58.06%)
  Epoch 40/200 - LR: 0.000625 - Train Loss: 0.5945, Train Acc: 0.922 | Val Loss: 1.0306, Val Acc: 0.629

  Early stopping at epoch 41 (patience=30)
Learning curves saved to: models/trained/XAUUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/XAUUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ‚ö† WARNING
Train-Val Gap: 30.60% (Threshold: 15%)
Total Epochs: 41
Training Duration: 0:00:03.652221

Final Metrics:
  Train Accuracy: 0.9189
  Val Accuracy:   0.6129
  Train Loss:     0.5883
  Val Loss:       1.0145

Best Epoch (Highest Val Accuracy):
  Epoch:          7
  Train Accuracy: 0.7599
  Val Accuracy:   0.6935
  Train Loss:     0.7809
  Val Loss:       0.8852
============================================================


  ‚ö†Ô∏è Training Warnings (1):
    - Epoch 38: Severe overfitting detected (train=95.86%, val=58.06%)

  Final Train Accuracy: 0.919
  Final Val Accuracy:   0.613
  Train-Val Gap:        0.306 (30.6%)

üìä Evaluating on Validation set...

  Accuracy: 0.613
  Precision (macro): 0.613
  Recall (macro): 0.613
  F1-Score (macro): 0.613

  Win Rate (excl. timeouts):
    Predicted: 50.0%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          18        11
  True Win           13        20

üìä Evaluating on Test set...

  Accuracy: 0.561
  Precision (macro): 0.500
  Recall (macro): 0.500
  F1-Score (macro): 0.500

  Win Rate (excl. timeouts):
    Predicted: 66.7%
    Actual:    68.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss           7        14
  True Win           15        30

üíæ Model pickle saved to /kaggle/working/XAUUSD_NeuralNetwork.pkl
üíæ Metadata saved to /kaggle/working/XAUUSD_NeuralNetwork_metadata.json
üíæ Scaler saved to /kaggle/working/XAUUSD_NeuralNetwork_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ Neural Network completed in 4.7s

üîÑ Starting LSTM training for XAUUSD...

================================================================================
Training LSTM for XAUUSD
================================================================================

üìÇ Loading data for XAUUSD...
  Excluding timeout samples (TBM_Label == 0)
  Train: 252 samples
  Val:   62 samples
  Test:  66 samples
  Selected 57 features
  Remapped labels: [0 1]

üîÑ Training LSTM for XAUUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 252
  Features: 57
  Creating sequences...
  Sequence shape: (232, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.6213, Train Acc: 0.664 | Val Loss: 1.0795, Val Acc: 0.429
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.3988, Train Acc: 0.823 | Val Loss: 0.7840, Val Acc: 0.595
‚ö†Ô∏è Epoch 27: Exploding gradient detected (norm=12.27 > 10.0)
  Epoch 30/200 - LR: 0.005208 - Train Loss: 0.2628, Train Acc: 0.897 | Val Loss: 2.5370, Val Acc: 0.452
‚ö†Ô∏è Epoch 31: Exploding gradient detected (norm=18.46 > 10.0)

  Early stopping at epoch 32

  ‚ö†Ô∏è Training Warnings (2):
    - Epoch 27: Exploding gradient detected (norm=12.27 > 10.0)
    - Epoch 31: Exploding gradient detected (norm=18.46 > 10.0)

  Final Train Accuracy: 0.879
  Final Val Accuracy:   0.405
  Train-Val Gap:        0.475 (47.5%)

üìä Evaluating on Validation set...

  Accuracy: 0.435
  Precision (macro): 0.436
  Recall (macro): 0.436
  F1-Score (macro): 0.435

  Win Rate (excl. timeouts):
    Predicted: 48.4%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          13        16
  True Win           19        14

üìä Evaluating on Test set...

  Accuracy: 0.485
  Precision (macro): 0.496
  Recall (macro): 0.495
  F1-Score (macro): 0.473

  Win Rate (excl. timeouts):
    Predicted: 47.0%
    Actual:    68.2%

  Confusion Matrix:
              Pred Loss  Pred Win
  True Loss          11        10
  True Win           24        21

üíæ Model pickle saved to /kaggle/working/XAUUSD_LSTM.pkl
üíæ Metadata saved to /kaggle/working/XAUUSD_LSTM_metadata.json
üíæ Scaler saved to /kaggle/working/XAUUSD_LSTM_scaler.pkl

‚úÖ Model save complete: /kaggle/working
‚úÖ LSTM completed in 6.5s

================================================================================
Symbol XAUUSD Training Summary:
  Total Duration: 16.9s
  Successful Models: 3/4
  Failed Models: 1/4
================================================================================

‚úÖ Model training completed

================================================================================
üìà RESULTS SUMMARY
================================================================================

Symbol     Model                Val Acc      Test Acc     Status         
---------------------------------------------------------------------------
AUDCAD     RandomForest         ERROR        ERROR        ‚ùå Failed       
AUDCAD     XGBoost              0.630        0.627        ‚úÖ Success      
AUDCAD     NeuralNetwork        0.783        0.627        ‚úÖ Success      
AUDCAD     LSTM                 0.543        0.407        ‚ö†Ô∏è  Low Acc    
AUDCHF     RandomForest         ERROR        ERROR        ‚ùå Failed       
AUDCHF     XGBoost              0.473        0.711        ‚úÖ Success      
AUDCHF     NeuralNetwork        0.564        0.622        ‚úÖ Success      
AUDCHF     LSTM                 0.455        0.489        ‚ö†Ô∏è  Low Acc    
AUDJPY     RandomForest         ERROR        ERROR        ‚ùå Failed       
AUDJPY     XGBoost              0.689        0.647        ‚úÖ Success      
AUDJPY     NeuralNetwork        0.689        0.686        ‚úÖ Success      
AUDJPY     LSTM                 0.489        0.471        ‚ö†Ô∏è  Low Acc    
AUDNZD     RandomForest         ERROR        ERROR        ‚ùå Failed       
AUDNZD     XGBoost              0.710        0.756        ‚úÖ Success      
AUDNZD     NeuralNetwork        0.645        0.610        ‚úÖ Success      
AUDNZD     LSTM                 0.452        0.537        ‚úÖ Success      
AUDUSD     RandomForest         ERROR        ERROR        ‚ùå Failed       
AUDUSD     XGBoost              0.585        0.611        ‚úÖ Success      
AUDUSD     NeuralNetwork        0.509        0.519        ‚úÖ Success      
AUDUSD     LSTM                 0.453        0.463        ‚ö†Ô∏è  Low Acc    
EURUSD     RandomForest         ERROR        ERROR        ‚ùå Failed       
EURUSD     XGBoost              0.684        0.660        ‚úÖ Success      
EURUSD     NeuralNetwork        0.579        0.553        ‚úÖ Success      
EURUSD     LSTM                 0.579        0.468        ‚ö†Ô∏è  Low Acc    
GBPUSD     RandomForest         ERROR        ERROR        ‚ùå Failed       
GBPUSD     XGBoost              0.688        0.682        ‚úÖ Success      
GBPUSD     NeuralNetwork        0.625        0.614        ‚úÖ Success      
GBPUSD     LSTM                 0.354        0.614        ‚úÖ Success      
USDCAD     RandomForest         ERROR        ERROR        ‚ùå Failed       
USDCAD     XGBoost              0.625        0.651        ‚úÖ Success      
USDCAD     NeuralNetwork        0.667        0.558        ‚úÖ Success      
USDCAD     LSTM                 0.479        0.581        ‚úÖ Success      
USDCHF     RandomForest         ERROR        ERROR        ‚ùå Failed       
USDCHF     XGBoost              0.739        0.739        ‚úÖ Success      
USDCHF     NeuralNetwork        0.761        0.609        ‚úÖ Success      
USDCHF     LSTM                 0.174        0.500        ‚ö†Ô∏è  Low Acc    
USDJPY     RandomForest         ERROR        ERROR        ‚ùå Failed       
USDJPY     XGBoost              0.720        0.660        ‚úÖ Success      
USDJPY     NeuralNetwork        0.640        0.736        ‚úÖ Success      
USDJPY     LSTM                 0.420        0.472        ‚ö†Ô∏è  Low Acc    
XAUUSD     RandomForest         ERROR        ERROR        ‚ùå Failed       
XAUUSD     XGBoost              0.661        0.667        ‚úÖ Success      
XAUUSD     NeuralNetwork        0.613        0.561        ‚úÖ Success      
XAUUSD     LSTM                 0.435        0.485        ‚ö†Ô∏è  Low Acc    

üíæ Results saved: /kaggle/working/training_results.json

================================================================================
üìÅ OUTPUT FILES
================================================================================

Data Files:
  - consolidated_ohlc_data.csv (39.09 MB)
  - processed_smc_data.csv (200.71 MB)
  - processed_smc_data_test.csv (10.09 MB)
  - processed_smc_data_train.csv (46.93 MB)
  - processed_smc_data_val.csv (10.08 MB)

Model Files:
  - AUDCAD_LSTM.pkl (348.45 MB)
  - AUDCAD_LSTM_scaler.pkl (0.00 MB)
  - AUDCAD_NeuralNetwork.pkl (0.80 MB)
  - AUDCAD_NeuralNetwork_scaler.pkl (0.00 MB)
  - AUDCAD_XGBoost.pkl (0.18 MB)
  - AUDCHF_LSTM.pkl (348.45 MB)
  - AUDCHF_LSTM_scaler.pkl (0.00 MB)
  - AUDCHF_NeuralNetwork.pkl (0.80 MB)
  - AUDCHF_NeuralNetwork_scaler.pkl (0.00 MB)
  - AUDCHF_XGBoost.pkl (0.18 MB)
  - AUDJPY_LSTM.pkl (348.45 MB)
  - AUDJPY_LSTM_scaler.pkl (0.00 MB)
  - AUDJPY_NeuralNetwork.pkl (0.80 MB)
  - AUDJPY_NeuralNetwork_scaler.pkl (0.00 MB)
  - AUDJPY_XGBoost.pkl (0.17 MB)
  - AUDNZD_LSTM.pkl (348.45 MB)
  - AUDNZD_LSTM_scaler.pkl (0.00 MB)
  - AUDNZD_NeuralNetwork.pkl (0.80 MB)
  - AUDNZD_NeuralNetwork_scaler.pkl (0.00 MB)
  - AUDNZD_XGBoost.pkl (0.17 MB)
  - AUDUSD_LSTM.pkl (348.45 MB)
  - AUDUSD_LSTM_scaler.pkl (0.00 MB)
  - AUDUSD_NeuralNetwork.pkl (0.80 MB)
  - AUDUSD_NeuralNetwork_scaler.pkl (0.00 MB)
  - AUDUSD_XGBoost.pkl (0.18 MB)
  - EURUSD_LSTM.pkl (348.45 MB)
  - EURUSD_LSTM_scaler.pkl (0.00 MB)
  - EURUSD_NeuralNetwork.pkl (0.80 MB)
  - EURUSD_NeuralNetwork_scaler.pkl (0.00 MB)
  - EURUSD_XGBoost.pkl (0.17 MB)
  - GBPUSD_LSTM.pkl (348.45 MB)
  - GBPUSD_LSTM_scaler.pkl (0.00 MB)
  - GBPUSD_NeuralNetwork.pkl (0.80 MB)
  - GBPUSD_NeuralNetwork_scaler.pkl (0.00 MB)
  - GBPUSD_XGBoost.pkl (0.17 MB)
  - USDCAD_LSTM.pkl (348.45 MB)
  - USDCAD_LSTM_scaler.pkl (0.00 MB)
  - USDCAD_NeuralNetwork.pkl (0.80 MB)
  - USDCAD_NeuralNetwork_scaler.pkl (0.00 MB)
  - USDCAD_XGBoost.pkl (0.16 MB)
  - USDCHF_LSTM.pkl (348.45 MB)
  - USDCHF_LSTM_scaler.pkl (0.00 MB)
  - USDCHF_NeuralNetwork.pkl (0.80 MB)
  - USDCHF_NeuralNetwork_scaler.pkl (0.00 MB)
  - USDCHF_XGBoost.pkl (0.17 MB)
  - USDJPY_LSTM.pkl (348.45 MB)
  - USDJPY_LSTM_scaler.pkl (0.00 MB)
  - USDJPY_NeuralNetwork.pkl (0.80 MB)
  - USDJPY_NeuralNetwork_scaler.pkl (0.00 MB)
  - USDJPY_XGBoost.pkl (0.18 MB)
  - XAUUSD_LSTM.pkl (348.45 MB)
  - XAUUSD_LSTM_scaler.pkl (0.00 MB)
  - XAUUSD_NeuralNetwork.pkl (0.80 MB)
  - XAUUSD_NeuralNetwork_scaler.pkl (0.00 MB)
  - XAUUSD_XGBoost.pkl (0.18 MB)

Result Files:
  - AUDCAD_LSTM_metadata.json (0.01 MB)
  - AUDCAD_NeuralNetwork_metadata.json (0.01 MB)
  - AUDCAD_XGBoost_metadata.json (0.00 MB)
  - AUDCHF_LSTM_metadata.json (0.01 MB)
  - AUDCHF_NeuralNetwork_metadata.json (0.01 MB)
  - AUDCHF_XGBoost_metadata.json (0.00 MB)
  - AUDJPY_LSTM_metadata.json (0.00 MB)
  - AUDJPY_NeuralNetwork_metadata.json (0.01 MB)
  - AUDJPY_XGBoost_metadata.json (0.00 MB)
  - AUDNZD_LSTM_metadata.json (0.01 MB)
  - AUDNZD_NeuralNetwork_metadata.json (0.00 MB)
  - AUDNZD_XGBoost_metadata.json (0.00 MB)
  - AUDUSD_LSTM_metadata.json (0.01 MB)
  - AUDUSD_NeuralNetwork_metadata.json (0.01 MB)
  - AUDUSD_XGBoost_metadata.json (0.00 MB)
  - EURUSD_LSTM_metadata.json (0.01 MB)
  - EURUSD_NeuralNetwork_metadata.json (0.01 MB)
  - EURUSD_XGBoost_metadata.json (0.00 MB)
  - GBPUSD_LSTM_metadata.json (0.00 MB)
  - GBPUSD_NeuralNetwork_metadata.json (0.01 MB)
  - GBPUSD_XGBoost_metadata.json (0.00 MB)
  - USDCAD_LSTM_metadata.json (0.01 MB)
  - USDCAD_NeuralNetwork_metadata.json (0.01 MB)
  - USDCAD_XGBoost_metadata.json (0.00 MB)
  - USDCHF_LSTM_metadata.json (0.00 MB)
  - USDCHF_NeuralNetwork_metadata.json (0.01 MB)
  - USDCHF_XGBoost_metadata.json (0.00 MB)
  - USDJPY_LSTM_metadata.json (0.01 MB)
  - USDJPY_NeuralNetwork_metadata.json (0.01 MB)
  - USDJPY_XGBoost_metadata.json (0.00 MB)
  - XAUUSD_LSTM_metadata.json (0.00 MB)
  - XAUUSD_NeuralNetwork_metadata.json (0.01 MB)
  - XAUUSD_XGBoost_metadata.json (0.00 MB)
  - processed_smc_data_feature_list.txt (0.00 MB)
  - processed_smc_data_quality_stats.txt (0.00 MB)
  - training_results.json (0.17 MB)

================================================================================
‚úÖ PIPELINE COMPLETE!
================================================================================

üéØ Next Steps:
  1. Review training_results.json
  2. Download .pkl model files from Output tab
  3. Deploy best models to trading system

üìä Summary:
  Symbols: 11
  Models per symbol: 4
  Total models: 44

‚ú® Check /kaggle/working/ for all outputs!

================================================================================
‚úÖ PIPELINE EXECUTION COMPLETE
================================================================================

================================================================================
üéâ ALL DONE!
================================================================================

Next steps:
  1. Review performance reports in models/trained/reports/
  2. Check deployment_manifest.json for model recommendations
  3. Review training_results.json for detailed metrics

================================================================================

‚úÖ Cloned to: /content/integrated-pipeline

üîç Verifying RandomForest fix...
‚úÖ Fix is present

üì¶ Installing dependencies...
‚úÖ Installed

================================================================================
üß™ TESTING RANDOMFOREST
================================================================================

üå≤ Training RandomForest with cross-validation...

üå≤ Training Random Forest for TEST...
  Training samples: 200
  Features: 57

  üìä Dataset has 200 samples (< 300), applying augmentation...
  Augmented: 200 ‚Üí 404 samples

  üîÑ Performing cross-validation...

üîÑ Performing 5-fold cross-validation...

üå≤ Training Random Forest for TEST...
  Training samples: 323
  Features: 57

  Train accuracy: 0.991
  Val accuracy:   0.815
  Train-Val gap:  0.176
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.815, F1=0.815

üå≤ Training Random Forest for TEST...
  Training samples: 323
  Features: 57

  Train accuracy: 0.988
  Val accuracy:   0.901
  Train-Val gap:  0.086
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.901, F1=0.900

üå≤ Training Random Forest for TEST...
  Training samples: 323
  Features: 57

  Train accuracy: 0.997
  Val accuracy:   0.901
  Train-Val gap:  0.096
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.901, F1=0.901

üå≤ Training Random Forest for TEST...
  Training samples: 323
  Features: 57

  Train accuracy: 0.985
  Val accuracy:   0.815
  Train-Val gap:  0.170
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.815, F1=0.815

üå≤ Training Random Forest for TEST...
  Training samples: 324
  Features: 57

  Train accuracy: 0.997
  Val accuracy:   0.850
  Train-Val gap:  0.147
  ‚úÖ Good generalization (gap ‚â§ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.850, F1=0.850

  Cross-Validation Results:
    Mean Accuracy: 0.856 ¬± 0.039
    Min Accuracy:  0.815
    Max Accuracy:  0.901
    Range:         0.086
    Mean F1-Score: 0.856 ¬± 0.039
    ‚úÖ STABLE: Std dev 0.039 ‚â§ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 1: 0.815 (deviation: -0.042)
      Fold 4: 0.815 (deviation: -0.042)

  Train accuracy: 0.983
  Val accuracy:   0.500
  Train-Val gap:  0.483
  ‚ö†Ô∏è Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)

================================================================================
‚úÖ SUCCESS - RandomForest is FIXED!
================================================================================

CV Mean Accuracy: 0.856
CV Std: 0.039
CV Stable: True
Val Accuracy: 0.500

üéâ Ready to run full training pipeline!