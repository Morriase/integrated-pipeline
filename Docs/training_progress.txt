🤖 TRAINING ALL MODELS
================================================================================
Training 11 symbols × 4 models = 44 total models
Expected: 44/44 complete (with RandomForest fix)
Duration: ~30 minutes
================================================================================


🔍 Checking data availability...
  ✓ Train data: /kaggle/working/processed_smc_data_train.csv
  ✓ Val data:   /kaggle/working/processed_smc_data_val.csv
  ✓ Test data:  /kaggle/working/processed_smc_data_test.csv

📊 Available symbols: ['AUDCAD', 'AUDCHF', 'AUDJPY', 'AUDNZD', 'AUDUSD', 'EURUSD', 'GBPUSD', 'USDCAD', 'USDCHF', 'USDJPY', 'XAUUSD']

################################################################################
# Training AUDCAD
################################################################################

################################################################################
# Training All Models for AUDCAD
################################################################################

🌲 Starting RandomForest training for AUDCAD...

================================================================================
Training Random Forest for AUDCAD
================================================================================

📂 Loading data for AUDCAD...
  Train: 243 samples
  Val:   50 samples
  Test:  60 samples
  Selected 57 features

🌲 Training Random Forest for AUDCAD...
  Training samples: 243
  Features: 57

  📊 Dataset has 243 samples (< 300), applying augmentation...
  Augmented: 243 → 690 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for AUDCAD...
  Training samples: 552
  Features: 57

  Train accuracy: 0.866
  Val accuracy:   0.855
  Train-Val gap:  0.011
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.855, F1=0.853

🌲 Training Random Forest for AUDCAD...
  Training samples: 552
  Features: 57

  Train accuracy: 0.873
  Val accuracy:   0.754
  Train-Val gap:  0.120
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.754, F1=0.748

🌲 Training Random Forest for AUDCAD...
  Training samples: 552
  Features: 57

  Train accuracy: 0.861
  Val accuracy:   0.790
  Train-Val gap:  0.071
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.790, F1=0.785

🌲 Training Random Forest for AUDCAD...
  Training samples: 552
  Features: 57

  Train accuracy: 0.895
  Val accuracy:   0.804
  Train-Val gap:  0.091
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.804, F1=0.801

🌲 Training Random Forest for AUDCAD...
  Training samples: 552
  Features: 57

  Train accuracy: 0.880
  Val accuracy:   0.855
  Train-Val gap:  0.025
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.855, F1=0.855

  Cross-Validation Results:
    Mean Accuracy: 0.812 ± 0.039
    Min Accuracy:  0.754
    Max Accuracy:  0.855
    Range:         0.101
    Mean F1-Score: 0.808 ± 0.041
    ✅ STABLE: Std dev 0.039 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.754 (deviation: -0.058)

  Train accuracy: 0.981
  Val accuracy:   0.620
  Train-Val gap:  0.361
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.1155
    TBM_Risk_Per_Trade_ATR                  : 0.0904
    TBM_Reward_Per_Trade_ATR                : 0.0880
    Distance_to_Entry_ATR                   : 0.0653
    FVG_Distance_to_Price_ATR_ZScore        : 0.0488
    FVG_Quality_Fuzzy                       : 0.0418
    ATR_ZScore                              : 0.0391
    FVG_Distance_to_Price_ATR               : 0.0386
    FVG_Size_Fuzzy_Score                    : 0.0382
    FVG_Depth_ATR                           : 0.0364

📊 Evaluating on Validation set...

  Accuracy: 0.620
  Precision (macro): 0.622
  Recall (macro): 0.619
  F1-Score (macro): 0.620

  Win Rate (excl. timeouts):
    Predicted: 69.6%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6           0        10
  True Timeout        1           3         0
  True Win            7           1        22

  Overfitting Analysis:
    Training Accuracy: 0.981
    Validation Accuracy: 0.620
    Train-Val Gap: 0.361
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.683
  Precision (macro): 0.627
  Recall (macro): 0.785
  F1-Score (macro): 0.678

  Win Rate (excl. timeouts):
    Predicted: 52.5%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          19           0        10
  True Timeout        0           1         0
  True Win            8           1        21

💾 Model pickle saved to /kaggle/working/models/trained/AUDCAD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCAD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.1s

🚀 Starting XGBoost training for AUDCAD...

================================================================================
Training XGBoost for AUDCAD
================================================================================

📂 Loading data for AUDCAD...
  Train: 243 samples
  Val:   50 samples
  Test:  60 samples
  Selected 57 features

🚀 Training XGBoost for AUDCAD...
  Training samples: 243
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.640
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0622
    TBM_Bars_to_Hit                         : 0.0500
    TBM_Reward_Per_Trade_ATR                : 0.0479
    TBM_Risk_Per_Trade_ATR                  : 0.0441
    BOS_Wick_Confirm                        : 0.0331
    Distance_to_Entry_ATR                   : 0.0303
    FVG_Depth_ATR                           : 0.0300
    FVG_Distance_to_Price_ATR               : 0.0282
    OB_Bearish_Valid                        : 0.0266
    FVG_Bearish_Valid                       : 0.0262

📊 Evaluating on Validation set...

  Accuracy: 0.640
  Precision (macro): 0.723
  Recall (macro): 0.650
  F1-Score (macro): 0.680

  Win Rate (excl. timeouts):
    Predicted: 63.0%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           8           0         8
  True Timeout        1           3         0
  True Win            9           0        21

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.640
    Train-Val Gap: 0.360
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.650
  Precision (macro): 0.763
  Recall (macro): 0.762
  F1-Score (macro): 0.762

  Win Rate (excl. timeouts):
    Predicted: 55.9%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          17           0        12
  True Timeout        0           1         0
  True Win            9           0        21

💾 Model pickle saved to /kaggle/working/models/trained/AUDCAD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCAD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.3s

🧠 Starting Neural Network training for AUDCAD...

================================================================================
Training Neural Network for AUDCAD
================================================================================

📂 Loading data for AUDCAD...
  Train: 243 samples
  Val:   50 samples
  Test:  60 samples
  Selected 57 features

🧠 Training Neural Network for AUDCAD...
  Device: cuda
  Training samples: 243
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 690
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7183, Train Acc: 0.816 | Val Loss: 1.0221, Val Acc: 0.680
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6312, Train Acc: 0.899 | Val Loss: 0.9804, Val Acc: 0.680
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6029, Train Acc: 0.932 | Val Loss: 1.0415, Val Acc: 0.680

  Early stopping at epoch 34 (patience=30)
Learning curves saved to: models/trained/AUDCAD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDCAD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 24.03% (Threshold: 15%)
Total Epochs: 34
Training Duration: 0:00:03.978547

Final Metrics:
  Train Accuracy: 0.9203
  Val Accuracy:   0.6800
  Train Loss:     0.6110
  Val Loss:       1.0158

Best Epoch (Highest Val Accuracy):
  Epoch:          16
  Train Accuracy: 0.8783
  Val Accuracy:   0.7000
  Train Loss:     0.6552
  Val Loss:       0.9962
============================================================


  Final Train Accuracy: 0.920
  Final Val Accuracy:   0.680
  Train-Val Gap:        0.240 (24.0%)

📊 Evaluating on Validation set...

  Accuracy: 0.680
  Precision (macro): 0.579
  Recall (macro): 0.561
  F1-Score (macro): 0.552

  Win Rate (excl. timeouts):
    Predicted: 82.6%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           4           2        10
  True Timeout        2           2         0
  True Win            2           0        28

📊 Evaluating on Test set...

  Accuracy: 0.617
  Precision (macro): 0.419
  Recall (macro): 0.417
  F1-Score (macro): 0.416

  Win Rate (excl. timeouts):
    Predicted: 57.6%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          16           0        13
  True Timeout        1           0         0
  True Win            8           1        21

💾 Model pickle saved to /kaggle/working/models/trained/AUDCAD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCAD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDCAD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 7.7s

🔄 Starting LSTM training for AUDCAD...

================================================================================
Training LSTM for AUDCAD
================================================================================

📂 Loading data for AUDCAD...
  Train: 243 samples
  Val:   50 samples
  Test:  60 samples
  Selected 57 features

🔄 Training LSTM for AUDCAD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 243
  Features: 57
  Creating sequences...
  Sequence shape: (223, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7406, Train Acc: 0.641 | Val Loss: 1.0662, Val Acc: 0.600
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.4778, Train Acc: 0.771 | Val Loss: 2.0258, Val Acc: 0.567
  Epoch 30/200 - LR: 0.005209 - Train Loss: 0.3233, Train Acc: 0.874 | Val Loss: 1.7567, Val Acc: 0.667
⚠️ Epoch 33: Exploding gradient detected (norm=10.48 > 10.0)

  Early stopping at epoch 34

  ⚠️ Training Warnings (1):
    - Epoch 33: Exploding gradient detected (norm=10.48 > 10.0)

  Final Train Accuracy: 0.879
  Final Val Accuracy:   0.500
  Train-Val Gap:        0.379 (37.9%)

📊 Evaluating on Validation set...

  Accuracy: 0.320
  Precision (macro): 0.362
  Recall (macro): 0.289
  F1-Score (macro): 0.281

  Win Rate (excl. timeouts):
    Predicted: 28.3%
    Actual:    65.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           4          10         2
  True Timeout        1           1         2
  True Win            8          11        11

📊 Evaluating on Test set...

  Accuracy: 0.367
  Precision (macro): 0.376
  Recall (macro): 0.570
  F1-Score (macro): 0.316

  Win Rate (excl. timeouts):
    Predicted: 35.6%
    Actual:    50.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          10           9        10
  True Timeout        0           1         0
  True Win            8          11        11

💾 Model pickle saved to /kaggle/working/models/trained/AUDCAD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCAD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDCAD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 6.5s

================================================================================
Symbol AUDCAD Training Summary:
  Total Duration: 20.7s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training AUDCHF
################################################################################

################################################################################
# Training All Models for AUDCHF
################################################################################

🌲 Starting RandomForest training for AUDCHF...

================================================================================
Training Random Forest for AUDCHF
================================================================================

📂 Loading data for AUDCHF...
  Train: 279 samples
  Val:   60 samples
  Test:  50 samples
  Selected 57 features

🌲 Training Random Forest for AUDCHF...
  Training samples: 279
  Features: 57

  📊 Dataset has 279 samples (< 300), applying augmentation...
  Augmented: 279 → 792 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for AUDCHF...
  Training samples: 633
  Features: 57

  Train accuracy: 0.899
  Val accuracy:   0.805
  Train-Val gap:  0.094
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.805, F1=0.801

🌲 Training Random Forest for AUDCHF...
  Training samples: 633
  Features: 57

  Train accuracy: 0.900
  Val accuracy:   0.818
  Train-Val gap:  0.083
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.818, F1=0.814

🌲 Training Random Forest for AUDCHF...
  Training samples: 634
  Features: 57

  Train accuracy: 0.913
  Val accuracy:   0.848
  Train-Val gap:  0.065
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.848, F1=0.847

🌲 Training Random Forest for AUDCHF...
  Training samples: 634
  Features: 57

  Train accuracy: 0.901
  Val accuracy:   0.861
  Train-Val gap:  0.040
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.861, F1=0.859

🌲 Training Random Forest for AUDCHF...
  Training samples: 634
  Features: 57

  Train accuracy: 0.913
  Val accuracy:   0.880
  Train-Val gap:  0.034
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.880, F1=0.877

  Cross-Validation Results:
    Mean Accuracy: 0.842 ± 0.027
    Min Accuracy:  0.805
    Max Accuracy:  0.880
    Range:         0.075
    Mean F1-Score: 0.840 ± 0.029
    ✅ STABLE: Std dev 0.027 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 1: 0.805 (deviation: -0.037)

  Train accuracy: 0.957
  Val accuracy:   0.533
  Train-Val gap:  0.424
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.1359
    Distance_to_Entry_ATR                   : 0.0982
    TBM_Risk_Per_Trade_ATR                  : 0.0851
    TBM_Reward_Per_Trade_ATR                : 0.0826
    OB_Age                                  : 0.0416
    FVG_Distance_to_Price_ATR_ZScore        : 0.0413
    ATR_ZScore                              : 0.0404
    FVG_Distance_to_Price_ATR               : 0.0381
    FVG_Depth_ATR_ZScore                    : 0.0380
    FVG_Depth_ATR                           : 0.0284

📊 Evaluating on Validation set...

  Accuracy: 0.533
  Precision (macro): 0.541
  Recall (macro): 0.605
  F1-Score (macro): 0.564

  Win Rate (excl. timeouts):
    Predicted: 49.1%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           1        10
  True Timeout        1           4         0
  True Win           14           2        17

  Overfitting Analysis:
    Training Accuracy: 0.957
    Validation Accuracy: 0.533
    Train-Val Gap: 0.424
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.700
  Precision (macro): 0.795
  Recall (macro): 0.731
  F1-Score (macro): 0.750

  Win Rate (excl. timeouts):
    Predicted: 60.0%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          14           0        10
  True Timeout        0           4         1
  True Win            4           0        17

💾 Model pickle saved to /kaggle/working/models/trained/AUDCHF_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCHF_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 4.8s

🚀 Starting XGBoost training for AUDCHF...

================================================================================
Training XGBoost for AUDCHF
================================================================================

📂 Loading data for AUDCHF...
  Train: 279 samples
  Val:   60 samples
  Test:  50 samples
  Selected 57 features

🚀 Training XGBoost for AUDCHF...
  Training samples: 279
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.450
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0886
    TBM_Bars_to_Hit                         : 0.0572
    TBM_Risk_Per_Trade_ATR                  : 0.0455
    TBM_Reward_Per_Trade_ATR                : 0.0400
    Distance_to_Entry_ATR                   : 0.0391
    FVG_Depth_ATR                           : 0.0388
    FVG_Distance_to_Price_ATR               : 0.0338
    BOS_Commitment_Flag                     : 0.0331
    FVG_Bullish_Valid                       : 0.0329
    ChoCH_Detected                          : 0.0313

📊 Evaluating on Validation set...

  Accuracy: 0.450
  Precision (macro): 0.607
  Recall (macro): 0.544
  F1-Score (macro): 0.569

  Win Rate (excl. timeouts):
    Predicted: 49.1%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           0        13
  True Timeout        0           4         1
  True Win           19           0        14

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.450
    Train-Val Gap: 0.550
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.700
  Precision (macro): 0.784
  Recall (macro): 0.727
  F1-Score (macro): 0.750

  Win Rate (excl. timeouts):
    Predicted: 51.1%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          16           0         8
  True Timeout        0           4         1
  True Win            6           0        15

💾 Model pickle saved to /kaggle/working/models/trained/AUDCHF_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCHF_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for AUDCHF...

================================================================================
Training Neural Network for AUDCHF
================================================================================

📂 Loading data for AUDCHF...
  Train: 279 samples
  Val:   60 samples
  Test:  50 samples
  Selected 57 features

🧠 Training Neural Network for AUDCHF...
  Device: cuda
  Training samples: 279
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 792
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7307, Train Acc: 0.801 | Val Loss: 1.0350, Val Acc: 0.433
  Epoch 20/200 - LR: 0.001250 - Train Loss: 0.6691, Train Acc: 0.869 | Val Loss: 1.1182, Val Acc: 0.433
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6633, Train Acc: 0.867 | Val Loss: 1.1827, Val Acc: 0.433

  Early stopping at epoch 32 (patience=30)
Learning curves saved to: models/trained/AUDCHF_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDCHF_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 43.89% (Threshold: 15%)
Total Epochs: 32
Training Duration: 0:00:03.822039

Final Metrics:
  Train Accuracy: 0.8889
  Val Accuracy:   0.4500
  Train Loss:     0.6367
  Val Loss:       1.1897

Best Epoch (Highest Val Accuracy):
  Epoch:          11
  Train Accuracy: 0.8472
  Val Accuracy:   0.5667
  Train Loss:     0.6907
  Val Loss:       1.0667
============================================================


  Final Train Accuracy: 0.889
  Final Val Accuracy:   0.450
  Train-Val Gap:        0.439 (43.9%)

📊 Evaluating on Validation set...

  Accuracy: 0.450
  Precision (macro): 0.413
  Recall (macro): 0.473
  F1-Score (macro): 0.434

  Win Rate (excl. timeouts):
    Predicted: 56.4%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6           3        13
  True Timeout        1           3         1
  True Win           13           2        18

📊 Evaluating on Test set...

  Accuracy: 0.600
  Precision (macro): 0.657
  Recall (macro): 0.656
  F1-Score (macro): 0.651

  Win Rate (excl. timeouts):
    Predicted: 55.6%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           1        11
  True Timeout        0           4         1
  True Win            7           0        14

💾 Model pickle saved to /kaggle/working/models/trained/AUDCHF_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCHF_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDCHF_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.8s

🔄 Starting LSTM training for AUDCHF...

================================================================================
Training LSTM for AUDCHF
================================================================================

📂 Loading data for AUDCHF...
  Train: 279 samples
  Val:   60 samples
  Test:  50 samples
  Selected 57 features

🔄 Training LSTM for AUDCHF...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 279
  Features: 57
  Creating sequences...
  Sequence shape: (259, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.7781, Train Acc: 0.653 | Val Loss: 1.2375, Val Acc: 0.350
⚠️ Epoch 20: Exploding gradient detected (norm=10.37 > 10.0)
  Epoch 20/200 - LR: 0.002804 - Train Loss: 0.6616, Train Acc: 0.699 | Val Loss: 1.2044, Val Acc: 0.325
⚠️ Epoch 24: Exploding gradient detected (norm=12.50 > 10.0)
  Epoch 30/200 - LR: 0.005207 - Train Loss: 0.4648, Train Acc: 0.849 | Val Loss: 2.0796, Val Acc: 0.425
⚠️ Epoch 33: Exploding gradient detected (norm=10.29 > 10.0)

  Early stopping at epoch 33

  ⚠️ Training Warnings (3):
    - Epoch 20: Exploding gradient detected (norm=10.37 > 10.0)
    - Epoch 24: Exploding gradient detected (norm=12.50 > 10.0)
    - Epoch 33: Exploding gradient detected (norm=10.29 > 10.0)

  Final Train Accuracy: 0.784
  Final Val Accuracy:   0.375
  Train-Val Gap:        0.409 (40.9%)

📊 Evaluating on Validation set...

  Accuracy: 0.267
  Precision (macro): 0.305
  Recall (macro): 0.259
  F1-Score (macro): 0.241

  Win Rate (excl. timeouts):
    Predicted: 20.0%
    Actual:    60.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           8          10         4
  True Timeout        2           1         2
  True Win           14          12         7

📊 Evaluating on Test set...

  Accuracy: 0.320
  Precision (macro): 0.318
  Recall (macro): 0.435
  F1-Score (macro): 0.276

  Win Rate (excl. timeouts):
    Predicted: 6.7%
    Actual:    46.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11          11         2
  True Timeout        1           4         0
  True Win           13           7         1

💾 Model pickle saved to /kaggle/working/models/trained/AUDCHF_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDCHF_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDCHF_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 7.2s

================================================================================
Symbol AUDCHF Training Summary:
  Total Duration: 18.1s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training AUDJPY
################################################################################

################################################################################
# Training All Models for AUDJPY
################################################################################

🌲 Starting RandomForest training for AUDJPY...

================================================================================
Training Random Forest for AUDJPY
================================================================================

📂 Loading data for AUDJPY...
  Train: 240 samples
  Val:   49 samples
  Test:  56 samples
  Selected 57 features

🌲 Training Random Forest for AUDJPY...
  Training samples: 240
  Features: 57

  📊 Dataset has 240 samples (< 300), applying augmentation...
  Augmented: 240 → 738 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for AUDJPY...
  Training samples: 590
  Features: 57

  Train accuracy: 0.893
  Val accuracy:   0.824
  Train-Val gap:  0.069
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.824, F1=0.823

🌲 Training Random Forest for AUDJPY...
  Training samples: 590
  Features: 57

  Train accuracy: 0.903
  Val accuracy:   0.770
  Train-Val gap:  0.133
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.770, F1=0.765

🌲 Training Random Forest for AUDJPY...
  Training samples: 590
  Features: 57

  Train accuracy: 0.905
  Val accuracy:   0.858
  Train-Val gap:  0.047
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.858, F1=0.855

🌲 Training Random Forest for AUDJPY...
  Training samples: 591
  Features: 57

  Train accuracy: 0.909
  Val accuracy:   0.796
  Train-Val gap:  0.113
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.796, F1=0.796

🌲 Training Random Forest for AUDJPY...
  Training samples: 591
  Features: 57

  Train accuracy: 0.898
  Val accuracy:   0.857
  Train-Val gap:  0.041
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.857, F1=0.855

  Cross-Validation Results:
    Mean Accuracy: 0.821 ± 0.034
    Min Accuracy:  0.770
    Max Accuracy:  0.858
    Range:         0.088
    Mean F1-Score: 0.819 ± 0.035
    ✅ STABLE: Std dev 0.034 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.770 (deviation: -0.051)

  Train accuracy: 0.967
  Val accuracy:   0.673
  Train-Val gap:  0.294
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    Distance_to_Entry_ATR                   : 0.0937
    TBM_Bars_to_Hit                         : 0.0923
    TBM_Risk_Per_Trade_ATR                  : 0.0890
    TBM_Reward_Per_Trade_ATR                : 0.0816
    OB_Age                                  : 0.0410
    atr                                     : 0.0332
    Trend_Bias_Indicator                    : 0.0308
    FVG_Depth_ATR_ZScore                    : 0.0290
    BOS_Dist_ATR_ZScore                     : 0.0259
    FVG_Quality_Fuzzy                       : 0.0232

📊 Evaluating on Validation set...

  Accuracy: 0.673
  Precision (macro): 0.703
  Recall (macro): 0.760
  F1-Score (macro): 0.728

  Win Rate (excl. timeouts):
    Predicted: 53.3%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           1         7
  True Timeout        0           4         0
  True Win            8           0        17

  Overfitting Analysis:
    Training Accuracy: 0.967
    Validation Accuracy: 0.673
    Train-Val Gap: 0.294
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.554
  Precision (macro): 0.519
  Recall (macro): 0.614
  F1-Score (macro): 0.543

  Win Rate (excl. timeouts):
    Predicted: 49.0%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          10           5         8
  True Timeout        1           4         0
  True Win           10           1        17

💾 Model pickle saved to /kaggle/working/models/trained/AUDJPY_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDJPY_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.0s

🚀 Starting XGBoost training for AUDJPY...

================================================================================
Training XGBoost for AUDJPY
================================================================================

📂 Loading data for AUDJPY...
  Train: 240 samples
  Val:   49 samples
  Test:  56 samples
  Selected 57 features

🚀 Training XGBoost for AUDJPY...
  Training samples: 240
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.673
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0637
    TBM_Reward_Per_Trade_ATR                : 0.0444
    Distance_to_Entry_ATR                   : 0.0428
    ChoCH_Direction                         : 0.0416
    TBM_Risk_Per_Trade_ATR                  : 0.0408
    TBM_Bars_to_Hit                         : 0.0394
    ChoCH_Detected                          : 0.0377
    BOS_Close_Confirm                       : 0.0320
    OB_Bullish_Valid                        : 0.0317
    OB_Bearish                              : 0.0313

📊 Evaluating on Validation set...

  Accuracy: 0.673
  Precision (macro): 0.674
  Recall (macro): 0.617
  F1-Score (macro): 0.637

  Win Rate (excl. timeouts):
    Predicted: 62.2%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           1         8
  True Timeout        0           2         2
  True Win            5           0        20

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.673
    Train-Val Gap: 0.327
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.643
  Precision (macro): 0.751
  Recall (macro): 0.574
  F1-Score (macro): 0.619

  Win Rate (excl. timeouts):
    Predicted: 56.9%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          14           0         9
  True Timeout        1           2         2
  True Win            8           0        20

💾 Model pickle saved to /kaggle/working/models/trained/AUDJPY_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDJPY_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for AUDJPY...

================================================================================
Training Neural Network for AUDJPY
================================================================================

📂 Loading data for AUDJPY...
  Train: 240 samples
  Val:   49 samples
  Test:  56 samples
  Selected 57 features

🧠 Training Neural Network for AUDJPY...
  Device: cuda
  Training samples: 240
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 738
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7923, Train Acc: 0.793 | Val Loss: 0.9673, Val Acc: 0.571
⚠️ Epoch 13: Exploding gradient detected (norm=88477.73 > 10.0)
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6838, Train Acc: 0.885 | Val Loss: 0.9831, Val Acc: 0.612
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6305, Train Acc: 0.902 | Val Loss: 0.9836, Val Acc: 0.633

  Early stopping at epoch 37 (patience=30)
Learning curves saved to: models/trained/AUDJPY_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDJPY_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 26.71% (Threshold: 15%)
Total Epochs: 37
Training Duration: 0:00:03.949301

Final Metrics:
  Train Accuracy: 0.8997
  Val Accuracy:   0.6327
  Train Loss:     0.6614
  Val Loss:       1.0120

Best Epoch (Highest Val Accuracy):
  Epoch:          2
  Train Accuracy: 0.6802
  Val Accuracy:   0.6531
  Train Loss:     0.8845
  Val Loss:       0.8807
============================================================


  ⚠️ Training Warnings (1):
    - Epoch 13: Exploding gradient detected (norm=88477.73 > 10.0)

  Final Train Accuracy: 0.900
  Final Val Accuracy:   0.633
  Train-Val Gap:        0.267 (26.7%)

📊 Evaluating on Validation set...

  Accuracy: 0.633
  Precision (macro): 0.541
  Recall (macro): 0.520
  F1-Score (macro): 0.527

  Win Rate (excl. timeouts):
    Predicted: 57.8%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           2         7
  True Timeout        1           1         2
  True Win            6           0        19

📊 Evaluating on Test set...

  Accuracy: 0.589
  Precision (macro): 0.532
  Recall (macro): 0.531
  F1-Score (macro): 0.530

  Win Rate (excl. timeouts):
    Predicted: 56.9%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           3         9
  True Timeout        1           2         2
  True Win            8           0        20

💾 Model pickle saved to /kaggle/working/models/trained/AUDJPY_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDJPY_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDJPY_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.9s

🔄 Starting LSTM training for AUDJPY...

================================================================================
Training LSTM for AUDJPY
================================================================================

📂 Loading data for AUDJPY...
  Train: 240 samples
  Val:   49 samples
  Test:  56 samples
  Selected 57 features

🔄 Training LSTM for AUDJPY...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 240
  Features: 57
  Creating sequences...
  Sequence shape: (220, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7907, Train Acc: 0.618 | Val Loss: 0.9409, Val Acc: 0.414
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.6587, Train Acc: 0.691 | Val Loss: 1.7543, Val Acc: 0.448
  Epoch 30/200 - LR: 0.005209 - Train Loss: 0.5300, Train Acc: 0.868 | Val Loss: 2.2104, Val Acc: 0.483

  Early stopping at epoch 33

  Final Train Accuracy: 0.855
  Final Val Accuracy:   0.552
  Train-Val Gap:        0.303 (30.3%)

📊 Evaluating on Validation set...

  Accuracy: 0.388
  Precision (macro): 0.443
  Recall (macro): 0.553
  F1-Score (macro): 0.378

  Win Rate (excl. timeouts):
    Predicted: 28.9%
    Actual:    55.6%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6          10         4
  True Timeout        0           4         0
  True Win            7           9         9

📊 Evaluating on Test set...

  Accuracy: 0.250
  Precision (macro): 0.319
  Recall (macro): 0.346
  F1-Score (macro): 0.247

  Win Rate (excl. timeouts):
    Predicted: 17.6%
    Actual:    54.9%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6          13         4
  True Timeout        1           3         1
  True Win           10          13         5

💾 Model pickle saved to /kaggle/working/models/trained/AUDJPY_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDJPY_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDJPY_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 6.2s

================================================================================
Symbol AUDJPY Training Summary:
  Total Duration: 17.3s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training AUDNZD
################################################################################

################################################################################
# Training All Models for AUDNZD
################################################################################

🌲 Starting RandomForest training for AUDNZD...

================================================================================
Training Random Forest for AUDNZD
================================================================================

📂 Loading data for AUDNZD...
  Train: 178 samples
  Val:   39 samples
  Test:  42 samples
  Selected 57 features

🌲 Training Random Forest for AUDNZD...
  Training samples: 178
  Features: 57

  📊 Dataset has 178 samples (< 300), applying augmentation...
  Augmented: 178 → 765 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for AUDNZD...
  Training samples: 612
  Features: 57

  Train accuracy: 0.900
  Val accuracy:   0.843
  Train-Val gap:  0.057
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.843, F1=0.839

🌲 Training Random Forest for AUDNZD...
  Training samples: 612
  Features: 57

  Train accuracy: 0.889
  Val accuracy:   0.797
  Train-Val gap:  0.092
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.797, F1=0.791

🌲 Training Random Forest for AUDNZD...
  Training samples: 612
  Features: 57

  Train accuracy: 0.889
  Val accuracy:   0.791
  Train-Val gap:  0.098
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.791, F1=0.783

🌲 Training Random Forest for AUDNZD...
  Training samples: 612
  Features: 57

  Train accuracy: 0.884
  Val accuracy:   0.784
  Train-Val gap:  0.100
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.784, F1=0.779

🌲 Training Random Forest for AUDNZD...
  Training samples: 612
  Features: 57

  Train accuracy: 0.889
  Val accuracy:   0.771
  Train-Val gap:  0.118
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.771, F1=0.767

  Cross-Validation Results:
    Mean Accuracy: 0.797 ± 0.024
    Min Accuracy:  0.771
    Max Accuracy:  0.843
    Range:         0.072
    Mean F1-Score: 0.792 ± 0.025
    ✅ STABLE: Std dev 0.024 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 5: 0.771 (deviation: -0.026)

  Train accuracy: 0.945
  Val accuracy:   0.692
  Train-Val gap:  0.253
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.0764
    TBM_Risk_Per_Trade_ATR                  : 0.0658
    Distance_to_Entry_ATR                   : 0.0547
    TBM_Reward_Per_Trade_ATR                : 0.0475
    FVG_Size_Fuzzy_Score                    : 0.0460
    FVG_Depth_ATR                           : 0.0457
    OB_Age                                  : 0.0454
    FVG_Distance_to_Price_ATR_ZScore        : 0.0339
    BOS_Dist_ATR_ZScore                     : 0.0335
    FVG_Distance_to_Price_ATR               : 0.0315

📊 Evaluating on Validation set...

  Accuracy: 0.692
  Precision (macro): 0.771
  Recall (macro): 0.690
  F1-Score (macro): 0.707

  Win Rate (excl. timeouts):
    Predicted: 38.7%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           0         2
  True Timeout        1           5         2
  True Win            7           0        10

  Overfitting Analysis:
    Training Accuracy: 0.945
    Validation Accuracy: 0.692
    Train-Val Gap: 0.253
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.690
  Precision (macro): 0.480
  Recall (macro): 0.469
  F1-Score (macro): 0.474

  Win Rate (excl. timeouts):
    Predicted: 51.2%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           2         4
  True Timeout        0           0         1
  True Win            6           0        17

💾 Model pickle saved to /kaggle/working/models/trained/AUDNZD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDNZD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.0s

🚀 Starting XGBoost training for AUDNZD...

================================================================================
Training XGBoost for AUDNZD
================================================================================

📂 Loading data for AUDNZD...
  Train: 178 samples
  Val:   39 samples
  Test:  42 samples
  Selected 57 features

🚀 Training XGBoost for AUDNZD...
  Training samples: 178
  Features: 57

  Train accuracy: 0.994
  Val accuracy:   0.615
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0909
    TBM_Risk_Per_Trade_ATR                  : 0.0510
    TBM_Bars_to_Hit                         : 0.0479
    ChoCH_Detected                          : 0.0474
    Distance_to_Entry_ATR                   : 0.0457
    TBM_Reward_Per_Trade_ATR                : 0.0440
    BOS_Dist_ATR                            : 0.0323
    FVG_Distance_to_Price_ATR               : 0.0312
    FVG_Depth_ATR_ZScore                    : 0.0306
    FVG_Distance_to_Price_ATR_ZScore        : 0.0294

📊 Evaluating on Validation set...

  Accuracy: 0.615
  Precision (macro): 0.721
  Recall (macro): 0.575
  F1-Score (macro): 0.598

  Win Rate (excl. timeouts):
    Predicted: 54.8%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           0         5
  True Timeout        2           3         3
  True Win            5           0        12

  Overfitting Analysis:
    Training Accuracy: 0.994
    Validation Accuracy: 0.615
    Train-Val Gap: 0.379
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.643
  Precision (macro): 0.438
  Recall (macro): 0.440
  F1-Score (macro): 0.438

  Win Rate (excl. timeouts):
    Predicted: 48.8%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           1         5
  True Timeout        0           0         1
  True Win            8           0        15

💾 Model pickle saved to /kaggle/working/models/trained/AUDNZD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDNZD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for AUDNZD...

================================================================================
Training Neural Network for AUDNZD
================================================================================

📂 Loading data for AUDNZD...
  Train: 178 samples
  Val:   39 samples
  Test:  42 samples
  Selected 57 features

🧠 Training Neural Network for AUDNZD...
  Device: cuda
  Training samples: 178
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 765
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7368, Train Acc: 0.821 | Val Loss: 1.0604, Val Acc: 0.615
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6569, Train Acc: 0.893 | Val Loss: 1.0398, Val Acc: 0.641
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6403, Train Acc: 0.905 | Val Loss: 1.0334, Val Acc: 0.590
  Epoch 40/200 - LR: 0.000156 - Train Loss: 0.6264, Train Acc: 0.907 | Val Loss: 1.0734, Val Acc: 0.590

  Early stopping at epoch 46 (patience=30)
Learning curves saved to: models/trained/AUDNZD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDNZD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 28.53% (Threshold: 15%)
Total Epochs: 46
Training Duration: 0:00:04.789119

Final Metrics:
  Train Accuracy: 0.9007
  Val Accuracy:   0.6154
  Train Loss:     0.6303
  Val Loss:       1.0844

Best Epoch (Highest Val Accuracy):
  Epoch:          12
  Train Accuracy: 0.8222
  Val Accuracy:   0.6410
  Train Loss:     0.7149
  Val Loss:       0.9779
============================================================


  Final Train Accuracy: 0.901
  Final Val Accuracy:   0.615
  Train-Val Gap:        0.285 (28.5%)

📊 Evaluating on Validation set...

  Accuracy: 0.615
  Precision (macro): 0.651
  Recall (macro): 0.579
  F1-Score (macro): 0.593

  Win Rate (excl. timeouts):
    Predicted: 48.4%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          10           0         4
  True Timeout        1           3         4
  True Win            5           1        11

📊 Evaluating on Test set...

  Accuracy: 0.643
  Precision (macro): 0.427
  Recall (macro): 0.440
  F1-Score (macro): 0.433

  Win Rate (excl. timeouts):
    Predicted: 51.2%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           0         6
  True Timeout        0           0         1
  True Win            8           0        15

💾 Model pickle saved to /kaggle/working/models/trained/AUDNZD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDNZD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDNZD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 5.8s

🔄 Starting LSTM training for AUDNZD...

================================================================================
Training LSTM for AUDNZD
================================================================================

📂 Loading data for AUDNZD...
  Train: 178 samples
  Val:   39 samples
  Test:  42 samples
  Selected 57 features

🔄 Training LSTM for AUDNZD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 178
  Features: 57
  Creating sequences...
  Sequence shape: (158, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7599, Train Acc: 0.601 | Val Loss: 1.2419, Val Acc: 0.526
  Epoch 20/200 - LR: 0.002807 - Train Loss: 0.5020, Train Acc: 0.728 | Val Loss: 2.9234, Val Acc: 0.421
  Epoch 30/200 - LR: 0.005213 - Train Loss: 0.6202, Train Acc: 0.810 | Val Loss: 4.6095, Val Acc: 0.316

  Early stopping at epoch 32

  Final Train Accuracy: 0.848
  Final Val Accuracy:   0.158
  Train-Val Gap:        0.690 (69.0%)

📊 Evaluating on Validation set...

  Accuracy: 0.179
  Precision (macro): 0.180
  Recall (macro): 0.230
  F1-Score (macro): 0.175

  Win Rate (excl. timeouts):
    Predicted: 16.1%
    Actual:    54.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           1          10         3
  True Timeout        1           4         3
  True Win            9           6         2

📊 Evaluating on Test set...

  Accuracy: 0.238
  Precision (macro): 0.313
  Recall (macro): 0.165
  F1-Score (macro): 0.212

  Win Rate (excl. timeouts):
    Predicted: 22.0%
    Actual:    56.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           5           9         4
  True Timeout        1           0         0
  True Win            7          11         5

💾 Model pickle saved to /kaggle/working/models/trained/AUDNZD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDNZD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDNZD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 4.9s

================================================================================
Symbol AUDNZD Training Summary:
  Total Duration: 16.8s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training AUDUSD
################################################################################

################################################################################
# Training All Models for AUDUSD
################################################################################

🌲 Starting RandomForest training for AUDUSD...

================================================================================
Training Random Forest for AUDUSD
================================================================================

📂 Loading data for AUDUSD...
  Train: 262 samples
  Val:   57 samples
  Test:  58 samples
  Selected 57 features

🌲 Training Random Forest for AUDUSD...
  Training samples: 262
  Features: 57

  📊 Dataset has 262 samples (< 300), applying augmentation...
  Augmented: 262 → 774 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for AUDUSD...
  Training samples: 619
  Features: 57

  Train accuracy: 0.856
  Val accuracy:   0.768
  Train-Val gap:  0.088
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.768, F1=0.764

🌲 Training Random Forest for AUDUSD...
  Training samples: 619
  Features: 57

  Train accuracy: 0.889
  Val accuracy:   0.794
  Train-Val gap:  0.095
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.794, F1=0.792

🌲 Training Random Forest for AUDUSD...
  Training samples: 619
  Features: 57

  Train accuracy: 0.898
  Val accuracy:   0.819
  Train-Val gap:  0.079
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.819, F1=0.817

🌲 Training Random Forest for AUDUSD...
  Training samples: 619
  Features: 57

  Train accuracy: 0.887
  Val accuracy:   0.742
  Train-Val gap:  0.145
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.742, F1=0.740

🌲 Training Random Forest for AUDUSD...
  Training samples: 620
  Features: 57

  Train accuracy: 0.900
  Val accuracy:   0.818
  Train-Val gap:  0.082
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.818, F1=0.818

  Cross-Validation Results:
    Mean Accuracy: 0.788 ± 0.030
    Min Accuracy:  0.742
    Max Accuracy:  0.819
    Range:         0.077
    Mean F1-Score: 0.786 ± 0.030
    ✅ STABLE: Std dev 0.030 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.742 (deviation: -0.046)

  Train accuracy: 0.970
  Val accuracy:   0.579
  Train-Val gap:  0.391
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.1255
    Distance_to_Entry_ATR                   : 0.0832
    TBM_Reward_Per_Trade_ATR                : 0.0659
    TBM_Risk_Per_Trade_ATR                  : 0.0602
    OB_Age                                  : 0.0497
    FVG_Depth_ATR                           : 0.0401
    FVG_Distance_to_Price_ATR               : 0.0398
    FVG_Size_Fuzzy_Score                    : 0.0383
    FVG_Distance_to_Price_ATR_ZScore        : 0.0338
    FVG_Quality_Fuzzy                       : 0.0332

📊 Evaluating on Validation set...

  Accuracy: 0.579
  Precision (macro): 0.533
  Recall (macro): 0.558
  F1-Score (macro): 0.539

  Win Rate (excl. timeouts):
    Predicted: 56.6%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          13           2        12
  True Timeout        1           2         1
  True Win            7           1        18

  Overfitting Analysis:
    Training Accuracy: 0.970
    Validation Accuracy: 0.579
    Train-Val Gap: 0.391
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.638
  Precision (macro): 0.656
  Recall (macro): 0.748
  F1-Score (macro): 0.681

  Win Rate (excl. timeouts):
    Predicted: 42.6%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          15           2         5
  True Timeout        0           4         0
  True Win           14           0        18

💾 Model pickle saved to /kaggle/working/models/trained/AUDUSD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDUSD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.0s

🚀 Starting XGBoost training for AUDUSD...

================================================================================
Training XGBoost for AUDUSD
================================================================================

📂 Loading data for AUDUSD...
  Train: 262 samples
  Val:   57 samples
  Test:  58 samples
  Selected 57 features

🚀 Training XGBoost for AUDUSD...
  Training samples: 262
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.596
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0941
    OB_Bearish_Valid                        : 0.0441
    OB_Bullish                              : 0.0423
    TBM_Bars_to_Hit                         : 0.0420
    FVG_Quality_Fuzzy                       : 0.0396
    ChoCH_Direction                         : 0.0357
    Bullish_Trend_Fuzzy                     : 0.0343
    TBM_Reward_Per_Trade_ATR                : 0.0340
    Distance_to_Entry_ATR                   : 0.0313
    ChoCH_Detected                          : 0.0307

📊 Evaluating on Validation set...

  Accuracy: 0.596
  Precision (macro): 0.651
  Recall (macro): 0.642
  F1-Score (macro): 0.632

  Win Rate (excl. timeouts):
    Predicted: 66.0%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           1        15
  True Timeout        0           3         1
  True Win            6           0        20

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.596
    Train-Val Gap: 0.404
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.534
  Precision (macro): 0.561
  Recall (macro): 0.511
  F1-Score (macro): 0.532

  Win Rate (excl. timeouts):
    Predicted: 59.3%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           1        12
  True Timeout        1           2         1
  True Win           12           0        20

💾 Model pickle saved to /kaggle/working/models/trained/AUDUSD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDUSD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for AUDUSD...

================================================================================
Training Neural Network for AUDUSD
================================================================================

📂 Loading data for AUDUSD...
  Train: 262 samples
  Val:   57 samples
  Test:  58 samples
  Selected 57 features

🧠 Training Neural Network for AUDUSD...
  Device: cuda
  Training samples: 262
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 774
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7353, Train Acc: 0.813 | Val Loss: 1.0340, Val Acc: 0.561
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6746, Train Acc: 0.850 | Val Loss: 1.2029, Val Acc: 0.439
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6525, Train Acc: 0.897 | Val Loss: 1.1438, Val Acc: 0.544

  Early stopping at epoch 33 (patience=30)
Learning curves saved to: models/trained/AUDUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/AUDUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 34.30% (Threshold: 15%)
Total Epochs: 33
Training Duration: 0:00:03.691304

Final Metrics:
  Train Accuracy: 0.9044
  Val Accuracy:   0.5614
  Train Loss:     0.6384
  Val Loss:       1.1470

Best Epoch (Highest Val Accuracy):
  Epoch:          17
  Train Accuracy: 0.8463
  Val Accuracy:   0.5789
  Train Loss:     0.6860
  Val Loss:       1.1170
============================================================


  Final Train Accuracy: 0.904
  Final Val Accuracy:   0.561
  Train-Val Gap:        0.343 (34.3%)

📊 Evaluating on Validation set...

  Accuracy: 0.561
  Precision (macro): 0.595
  Recall (macro): 0.546
  F1-Score (macro): 0.561

  Win Rate (excl. timeouts):
    Predicted: 60.4%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           1        14
  True Timeout        1           2         1
  True Win            8           0        18

📊 Evaluating on Test set...

  Accuracy: 0.500
  Precision (macro): 0.490
  Recall (macro): 0.418
  F1-Score (macro): 0.439

  Win Rate (excl. timeouts):
    Predicted: 59.3%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           0        13
  True Timeout        3           1         0
  True Win           12           1        19

💾 Model pickle saved to /kaggle/working/models/trained/AUDUSD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDUSD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDUSD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.7s

🔄 Starting LSTM training for AUDUSD...

================================================================================
Training LSTM for AUDUSD
================================================================================

📂 Loading data for AUDUSD...
  Train: 262 samples
  Val:   57 samples
  Test:  58 samples
  Selected 57 features

🔄 Training LSTM for AUDUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 262
  Features: 57
  Creating sequences...
  Sequence shape: (242, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.7752, Train Acc: 0.595 | Val Loss: 1.1615, Val Acc: 0.351
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.7481, Train Acc: 0.711 | Val Loss: 1.2622, Val Acc: 0.351
⚠️ Epoch 23: Exploding gradient detected (norm=15.97 > 10.0)
⚠️ Epoch 30: Exploding gradient detected (norm=28.86 > 10.0)
  Epoch 30/200 - LR: 0.005208 - Train Loss: 0.6503, Train Acc: 0.888 | Val Loss: 1.8348, Val Acc: 0.432

  Early stopping at epoch 34

  ⚠️ Training Warnings (2):
    - Epoch 23: Exploding gradient detected (norm=15.97 > 10.0)
    - Epoch 30: Exploding gradient detected (norm=28.86 > 10.0)

  Final Train Accuracy: 0.880
  Final Val Accuracy:   0.378
  Train-Val Gap:        0.502 (50.2%)

📊 Evaluating on Validation set...

  Accuracy: 0.246
  Precision (macro): 0.302
  Recall (macro): 0.317
  F1-Score (macro): 0.237

  Win Rate (excl. timeouts):
    Predicted: 28.3%
    Actual:    49.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           7          10        10
  True Timeout        0           2         2
  True Win            6          15         5

📊 Evaluating on Test set...

  Accuracy: 0.276
  Precision (macro): 0.300
  Recall (macro): 0.404
  F1-Score (macro): 0.260

  Win Rate (excl. timeouts):
    Predicted: 37.0%
    Actual:    59.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           4           7        11
  True Timeout        1           3         0
  True Win            7          16         9

💾 Model pickle saved to /kaggle/working/models/trained/AUDUSD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/AUDUSD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/AUDUSD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 7.1s

================================================================================
Symbol AUDUSD Training Summary:
  Total Duration: 18.0s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training EURUSD
################################################################################

################################################################################
# Training All Models for EURUSD
################################################################################

🌲 Starting RandomForest training for EURUSD...

================================================================================
Training Random Forest for EURUSD
================================================================================

📂 Loading data for EURUSD...
  Train: 228 samples
  Val:   60 samples
  Test:  49 samples
  Selected 57 features

🌲 Training Random Forest for EURUSD...
  Training samples: 228
  Features: 57

  📊 Dataset has 228 samples (< 300), applying augmentation...
  Augmented: 228 → 678 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for EURUSD...
  Training samples: 542
  Features: 57

  Train accuracy: 0.917
  Val accuracy:   0.816
  Train-Val gap:  0.101
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.816, F1=0.812

🌲 Training Random Forest for EURUSD...
  Training samples: 542
  Features: 57

  Train accuracy: 0.917
  Val accuracy:   0.787
  Train-Val gap:  0.130
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.787, F1=0.780

🌲 Training Random Forest for EURUSD...
  Training samples: 542
  Features: 57

  Train accuracy: 0.924
  Val accuracy:   0.853
  Train-Val gap:  0.071
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.853, F1=0.854

🌲 Training Random Forest for EURUSD...
  Training samples: 543
  Features: 57

  Train accuracy: 0.910
  Val accuracy:   0.815
  Train-Val gap:  0.095
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.815, F1=0.815

🌲 Training Random Forest for EURUSD...
  Training samples: 543
  Features: 57

  Train accuracy: 0.926
  Val accuracy:   0.830
  Train-Val gap:  0.097
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.830, F1=0.827

  Cross-Validation Results:
    Mean Accuracy: 0.820 ± 0.022
    Min Accuracy:  0.787
    Max Accuracy:  0.853
    Range:         0.066
    Mean F1-Score: 0.818 ± 0.024
    ✅ STABLE: Std dev 0.022 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.787 (deviation: -0.033)

  Train accuracy: 0.988
  Val accuracy:   0.667
  Train-Val gap:  0.322
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    Distance_to_Entry_ATR                   : 0.0999
    TBM_Risk_Per_Trade_ATR                  : 0.0767
    TBM_Bars_to_Hit                         : 0.0756
    TBM_Reward_Per_Trade_ATR                : 0.0719
    OB_Age                                  : 0.0531
    FVG_Depth_ATR                           : 0.0456
    FVG_Distance_to_Price_ATR_ZScore        : 0.0337
    FVG_Quality_Fuzzy                       : 0.0293
    FVG_Size_Fuzzy_Score                    : 0.0287
    Trend_Bias_Indicator_ZScore             : 0.0271

📊 Evaluating on Validation set...

  Accuracy: 0.667
  Precision (macro): 0.620
  Recall (macro): 0.781
  F1-Score (macro): 0.662

  Win Rate (excl. timeouts):
    Predicted: 49.1%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          14           0         5
  True Timeout        0           3         0
  True Win           12           3        23

  Overfitting Analysis:
    Training Accuracy: 0.988
    Validation Accuracy: 0.667
    Train-Val Gap: 0.322
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.673
  Precision (macro): 0.456
  Recall (macro): 0.466
  F1-Score (macro): 0.460

  Win Rate (excl. timeouts):
    Predicted: 53.2%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          14           1         6
  True Timeout        2           0         0
  True Win            7           0        19

💾 Model pickle saved to /kaggle/working/models/trained/EURUSD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/EURUSD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.1s

🚀 Starting XGBoost training for EURUSD...

================================================================================
Training XGBoost for EURUSD
================================================================================

📂 Loading data for EURUSD...
  Train: 228 samples
  Val:   60 samples
  Test:  49 samples
  Selected 57 features

🚀 Training XGBoost for EURUSD...
  Training samples: 228
  Features: 57

  Train accuracy: 0.991
  Val accuracy:   0.700
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0917
    BOS_Commitment_Flag                     : 0.0747
    TBM_Reward_Per_Trade_ATR                : 0.0444
    Distance_to_Entry_ATR                   : 0.0368
    OB_Size_ATR                             : 0.0343
    FVG_Distance_to_Price_ATR               : 0.0327
    BOS_Close_Confirm                       : 0.0323
    FVG_Distance_to_Price_ATR_ZScore        : 0.0306
    TBM_Risk_Per_Trade_ATR                  : 0.0295
    TBM_Bars_to_Hit                         : 0.0269

📊 Evaluating on Validation set...

  Accuracy: 0.700
  Precision (macro): 0.635
  Recall (macro): 0.611
  F1-Score (macro): 0.605

  Win Rate (excl. timeouts):
    Predicted: 49.1%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          16           0         3
  True Timeout        0           1         2
  True Win           12           1        25

  Overfitting Analysis:
    Training Accuracy: 0.991
    Validation Accuracy: 0.700
    Train-Val Gap: 0.291
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.755
  Precision (macro): 0.504
  Recall (macro): 0.526
  F1-Score (macro): 0.513

  Win Rate (excl. timeouts):
    Predicted: 51.1%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          17           0         4
  True Timeout        2           0         0
  True Win            6           0        20

💾 Model pickle saved to /kaggle/working/models/trained/EURUSD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/EURUSD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for EURUSD...

================================================================================
Training Neural Network for EURUSD
================================================================================

📂 Loading data for EURUSD...
  Train: 228 samples
  Val:   60 samples
  Test:  49 samples
  Selected 57 features

🧠 Training Neural Network for EURUSD...
  Device: cuda
  Training samples: 228
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 678
  Epoch 10/200 - LR: 0.005000 - Train Loss: 0.7097, Train Acc: 0.827 | Val Loss: 0.9467, Val Acc: 0.517
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6735, Train Acc: 0.867 | Val Loss: 0.9769, Val Acc: 0.533
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6279, Train Acc: 0.900 | Val Loss: 0.9921, Val Acc: 0.567

  Early stopping at epoch 34 (patience=30)
Learning curves saved to: models/trained/EURUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/EURUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 33.45% (Threshold: 15%)
Total Epochs: 34
Training Duration: 0:00:03.404279

Final Metrics:
  Train Accuracy: 0.9012
  Val Accuracy:   0.5667
  Train Loss:     0.6192
  Val Loss:       1.0260

Best Epoch (Highest Val Accuracy):
  Epoch:          2
  Train Accuracy: 0.7153
  Val Accuracy:   0.6833
  Train Loss:     0.8045
  Val Loss:       0.9237
============================================================


  Final Train Accuracy: 0.901
  Final Val Accuracy:   0.567
  Train-Val Gap:        0.335 (33.5%)

📊 Evaluating on Validation set...

  Accuracy: 0.567
  Precision (macro): 0.560
  Recall (macro): 0.617
  F1-Score (macro): 0.565

  Win Rate (excl. timeouts):
    Predicted: 43.9%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          13           0         6
  True Timeout        1           2         0
  True Win           17           2        19

📊 Evaluating on Test set...

  Accuracy: 0.551
  Precision (macro): 0.361
  Recall (macro): 0.371
  F1-Score (macro): 0.363

  Win Rate (excl. timeouts):
    Predicted: 66.0%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           8           1        12
  True Timeout        2           0         0
  True Win            7           0        19

💾 Model pickle saved to /kaggle/working/models/trained/EURUSD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/EURUSD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/EURUSD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.4s

🔄 Starting LSTM training for EURUSD...

================================================================================
Training LSTM for EURUSD
================================================================================

📂 Loading data for EURUSD...
  Train: 228 samples
  Val:   60 samples
  Test:  49 samples
  Selected 57 features

🔄 Training LSTM for EURUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 228
  Features: 57
  Creating sequences...
  Sequence shape: (208, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7909, Train Acc: 0.572 | Val Loss: 0.9178, Val Acc: 0.550
⚠️ Validation loss divergence: increasing for 10 consecutive epochs
⚠️ Validation loss divergence: increasing for 10 consecutive epochs
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.4236, Train Acc: 0.822 | Val Loss: 1.8874, Val Acc: 0.450
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.5364, Train Acc: 0.880 | Val Loss: 2.0469, Val Acc: 0.625
⚠️ Epoch 36: Exploding gradient detected (norm=12.99 > 10.0)
⚠️ Epoch 36: Exploding gradient detected (norm=11.22 > 10.0)

  Early stopping at epoch 36

  ⚠️ Training Warnings (4):
    - Validation loss divergence: increasing for 10 consecutive epochs
    - Validation loss divergence: increasing for 10 consecutive epochs
    - Epoch 36: Exploding gradient detected (norm=12.99 > 10.0)
    - Epoch 36: Exploding gradient detected (norm=11.22 > 10.0)

  Final Train Accuracy: 0.928
  Final Val Accuracy:   0.400
  Train-Val Gap:        0.528 (52.8%)

📊 Evaluating on Validation set...

  Accuracy: 0.283
  Precision (macro): 0.293
  Recall (macro): 0.278
  F1-Score (macro): 0.231

  Win Rate (excl. timeouts):
    Predicted: 33.3%
    Actual:    66.7%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           3          10         6
  True Timeout        1           1         1
  True Win           12          13        13

📊 Evaluating on Test set...

  Accuracy: 0.265
  Precision (macro): 0.344
  Recall (macro): 0.182
  F1-Score (macro): 0.238

  Win Rate (excl. timeouts):
    Predicted: 25.5%
    Actual:    55.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           5          12         4
  True Timeout        1           0         1
  True Win            6          12         8

💾 Model pickle saved to /kaggle/working/models/trained/EURUSD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/EURUSD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/EURUSD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 6.3s

================================================================================
Symbol EURUSD Training Summary:
  Total Duration: 17.0s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training GBPUSD
################################################################################

################################################################################
# Training All Models for GBPUSD
################################################################################

🌲 Starting RandomForest training for GBPUSD...

================================================================================
Training Random Forest for GBPUSD
================================================================================

📂 Loading data for GBPUSD...
  Train: 206 samples
  Val:   52 samples
  Test:  46 samples
  Selected 57 features

🌲 Training Random Forest for GBPUSD...
  Training samples: 206
  Features: 57

  📊 Dataset has 206 samples (< 300), applying augmentation...
  Augmented: 206 → 642 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for GBPUSD...
  Training samples: 513
  Features: 57

  Train accuracy: 0.932
  Val accuracy:   0.783
  Train-Val gap:  0.149
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.783, F1=0.772

🌲 Training Random Forest for GBPUSD...
  Training samples: 513
  Features: 57

  Train accuracy: 0.934
  Val accuracy:   0.767
  Train-Val gap:  0.166
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.767, F1=0.760

🌲 Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.946
  Val accuracy:   0.852
  Train-Val gap:  0.094
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.852, F1=0.847

🌲 Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.942
  Val accuracy:   0.773
  Train-Val gap:  0.168
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.773, F1=0.767

🌲 Training Random Forest for GBPUSD...
  Training samples: 514
  Features: 57

  Train accuracy: 0.926
  Val accuracy:   0.875
  Train-Val gap:  0.051
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.875, F1=0.874

  Cross-Validation Results:
    Mean Accuracy: 0.810 ± 0.044
    Min Accuracy:  0.767
    Max Accuracy:  0.875
    Range:         0.108
    Mean F1-Score: 0.804 ± 0.047
    ✅ STABLE: Std dev 0.044 ≤ 0.10

  Train accuracy: 0.991
  Val accuracy:   0.596
  Train-Val gap:  0.395
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    Distance_to_Entry_ATR                   : 0.0933
    TBM_Reward_Per_Trade_ATR                : 0.0770
    TBM_Bars_to_Hit                         : 0.0710
    TBM_Risk_Per_Trade_ATR                  : 0.0685
    FVG_Depth_ATR                           : 0.0591
    Trend_Strength_Fuzzy                    : 0.0572
    OB_Age                                  : 0.0513
    BOS_Dist_ATR_ZScore                     : 0.0406
    Trend_Strength                          : 0.0384
    FVG_Depth_ATR_ZScore                    : 0.0351

📊 Evaluating on Validation set...

  Accuracy: 0.596
  Precision (macro): 0.567
  Recall (macro): 0.500
  F1-Score (macro): 0.517

  Win Rate (excl. timeouts):
    Predicted: 52.1%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          13           0         8
  True Timeout        3           1         0
  True Win            9           1        17

  Overfitting Analysis:
    Training Accuracy: 0.991
    Validation Accuracy: 0.596
    Train-Val Gap: 0.395
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.565
  Precision (macro): 0.499
  Recall (macro): 0.545
  F1-Score (macro): 0.516

  Win Rate (excl. timeouts):
    Predicted: 50.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           1         9
  True Timeout        1           1         0
  True Win            8           1        13

💾 Model pickle saved to /kaggle/working/models/trained/GBPUSD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/GBPUSD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 4.9s

🚀 Starting XGBoost training for GBPUSD...

================================================================================
Training XGBoost for GBPUSD
================================================================================

📂 Loading data for GBPUSD...
  Train: 206 samples
  Val:   52 samples
  Test:  46 samples
  Selected 57 features

🚀 Training XGBoost for GBPUSD...
  Training samples: 206
  Features: 57

  Train accuracy: 0.995
  Val accuracy:   0.635
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1059
    FVG_Bearish                             : 0.0467
    OB_Size_ATR                             : 0.0443
    ChoCH_Detected                          : 0.0394
    BOS_Close_Confirm                       : 0.0356
    TBM_Reward_Per_Trade_ATR                : 0.0349
    Overbought_Fuzzy                        : 0.0340
    OB_Size_ATR_ZScore                      : 0.0310
    Distance_to_Entry_ATR                   : 0.0304
    FVG_Distance_to_Price_ATR               : 0.0282

📊 Evaluating on Validation set...

  Accuracy: 0.635
  Precision (macro): 0.753
  Recall (macro): 0.528
  F1-Score (macro): 0.563

  Win Rate (excl. timeouts):
    Predicted: 52.1%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          14           0         7
  True Timeout        3           1         0
  True Win            9           0        18

  Overfitting Analysis:
    Training Accuracy: 0.995
    Validation Accuracy: 0.635
    Train-Val Gap: 0.361
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.652
  Precision (macro): 0.765
  Recall (macro): 0.606
  F1-Score (macro): 0.654

  Win Rate (excl. timeouts):
    Predicted: 61.4%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           0        10
  True Timeout        1           1         0
  True Win            5           0        17

💾 Model pickle saved to /kaggle/working/models/trained/GBPUSD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/GBPUSD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for GBPUSD...

================================================================================
Training Neural Network for GBPUSD
================================================================================

📂 Loading data for GBPUSD...
  Train: 206 samples
  Val:   52 samples
  Test:  46 samples
  Selected 57 features

🧠 Training Neural Network for GBPUSD...
  Device: cuda
  Training samples: 206
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 642
⚠️ Epoch 1: Exploding gradient detected (norm=18226.31 > 10.0)
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7710, Train Acc: 0.791 | Val Loss: 0.9909, Val Acc: 0.538
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6655, Train Acc: 0.879 | Val Loss: 1.0042, Val Acc: 0.654
⚠️ Epoch 21: Exploding gradient detected (norm=57.05 > 10.0)
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6510, Train Acc: 0.933 | Val Loss: 1.0529, Val Acc: 0.635

  Early stopping at epoch 35 (patience=30)
Learning curves saved to: models/trained/GBPUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/GBPUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 31.45% (Threshold: 15%)
Total Epochs: 35
Training Duration: 0:00:03.404899

Final Metrics:
  Train Accuracy: 0.9299
  Val Accuracy:   0.6154
  Train Loss:     0.5946
  Val Loss:       1.0506

Best Epoch (Highest Val Accuracy):
  Epoch:          14
  Train Accuracy: 0.8676
  Val Accuracy:   0.6731
  Train Loss:     0.6674
  Val Loss:       0.9624
============================================================


  ⚠️ Training Warnings (2):
    - Epoch 1: Exploding gradient detected (norm=18226.31 > 10.0)
    - Epoch 21: Exploding gradient detected (norm=57.05 > 10.0)

  Final Train Accuracy: 0.930
  Final Val Accuracy:   0.615
  Train-Val Gap:        0.315 (31.5%)

📊 Evaluating on Validation set...

  Accuracy: 0.615
  Precision (macro): 0.729
  Recall (macro): 0.579
  F1-Score (macro): 0.626

  Win Rate (excl. timeouts):
    Predicted: 56.2%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          12           0         9
  True Timeout        2           2         0
  True Win            9           0        18

📊 Evaluating on Test set...

  Accuracy: 0.609
  Precision (macro): 0.576
  Recall (macro): 0.576
  F1-Score (macro): 0.576

  Win Rate (excl. timeouts):
    Predicted: 52.3%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          13           0         9
  True Timeout        1           1         0
  True Win            7           1        14

💾 Model pickle saved to /kaggle/working/models/trained/GBPUSD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/GBPUSD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/GBPUSD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.4s

🔄 Starting LSTM training for GBPUSD...

================================================================================
Training LSTM for GBPUSD
================================================================================

📂 Loading data for GBPUSD...
  Train: 206 samples
  Val:   52 samples
  Test:  46 samples
  Selected 57 features

🔄 Training LSTM for GBPUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 206
  Features: 57
  Creating sequences...
  Sequence shape: (186, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7137, Train Acc: 0.629 | Val Loss: 1.2036, Val Acc: 0.281
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.6301, Train Acc: 0.758 | Val Loss: 1.3754, Val Acc: 0.406
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.2367, Train Acc: 0.898 | Val Loss: 3.1997, Val Acc: 0.438

  Early stopping at epoch 34

  Final Train Accuracy: 0.801
  Final Val Accuracy:   0.562
  Train-Val Gap:        0.239 (23.9%)

📊 Evaluating on Validation set...

  Accuracy: 0.365
  Precision (macro): 0.398
  Recall (macro): 0.337
  F1-Score (macro): 0.333

  Win Rate (excl. timeouts):
    Predicted: 31.2%
    Actual:    56.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           6         6
  True Timeout        0           1         3
  True Win            5          13         9

📊 Evaluating on Test set...

  Accuracy: 0.435
  Precision (macro): 0.495
  Recall (macro): 0.606
  F1-Score (macro): 0.403

  Win Rate (excl. timeouts):
    Predicted: 29.5%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           8          11         3
  True Timeout        0           2         0
  True Win            5           7        10

💾 Model pickle saved to /kaggle/working/models/trained/GBPUSD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/GBPUSD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/GBPUSD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 5.7s

================================================================================
Symbol GBPUSD Training Summary:
  Total Duration: 16.1s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training USDCAD
################################################################################

################################################################################
# Training All Models for USDCAD
################################################################################

🌲 Starting RandomForest training for USDCAD...

================================================================================
Training Random Forest for USDCAD
================================================================================

📂 Loading data for USDCAD...
  Train: 209 samples
  Val:   49 samples
  Test:  46 samples
  Selected 57 features

🌲 Training Random Forest for USDCAD...
  Training samples: 209
  Features: 57

  📊 Dataset has 209 samples (< 300), applying augmentation...
  Augmented: 209 → 720 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.910
  Val accuracy:   0.847
  Train-Val gap:  0.062
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.847, F1=0.847

🌲 Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.922
  Val accuracy:   0.757
  Train-Val gap:  0.165
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.757, F1=0.754

🌲 Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.924
  Val accuracy:   0.840
  Train-Val gap:  0.083
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.840, F1=0.837

🌲 Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.938
  Val accuracy:   0.889
  Train-Val gap:  0.049
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.889, F1=0.888

🌲 Training Random Forest for USDCAD...
  Training samples: 576
  Features: 57

  Train accuracy: 0.903
  Val accuracy:   0.819
  Train-Val gap:  0.083
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.819, F1=0.818

  Cross-Validation Results:
    Mean Accuracy: 0.831 ± 0.043
    Min Accuracy:  0.757
    Max Accuracy:  0.889
    Range:         0.132
    Mean F1-Score: 0.829 ± 0.044
    ✅ STABLE: Std dev 0.043 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 2: 0.757 (deviation: -0.074)

  Train accuracy: 0.982
  Val accuracy:   0.694
  Train-Val gap:  0.288
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.1483
    Distance_to_Entry_ATR                   : 0.0787
    TBM_Reward_Per_Trade_ATR                : 0.0704
    TBM_Risk_Per_Trade_ATR                  : 0.0604
    FVG_Size_Fuzzy_Score                    : 0.0392
    OB_Age                                  : 0.0381
    ChoCH_Detected                          : 0.0377
    FVG_Quality_Fuzzy                       : 0.0294
    FVG_Distance_to_Price_ATR_ZScore        : 0.0281
    FVG_Depth_ATR                           : 0.0275

📊 Evaluating on Validation set...

  Accuracy: 0.694
  Precision (macro): 0.565
  Recall (macro): 0.803
  F1-Score (macro): 0.575

  Win Rate (excl. timeouts):
    Predicted: 43.8%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          20           3         8
  True Timeout        0           1         0
  True Win            2           2        13

  Overfitting Analysis:
    Training Accuracy: 0.982
    Validation Accuracy: 0.694
    Train-Val Gap: 0.288
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.739
  Precision (macro): 0.679
  Recall (macro): 0.707
  F1-Score (macro): 0.682

  Win Rate (excl. timeouts):
    Predicted: 65.1%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           1         7
  True Timeout        1           2         0
  True Win            2           1        21

💾 Model pickle saved to /kaggle/working/models/trained/USDCAD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCAD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.0s

🚀 Starting XGBoost training for USDCAD...

================================================================================
Training XGBoost for USDCAD
================================================================================

📂 Loading data for USDCAD...
  Train: 209 samples
  Val:   49 samples
  Test:  46 samples
  Selected 57 features

🚀 Training XGBoost for USDCAD...
  Training samples: 209
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.633
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0716
    TBM_Bars_to_Hit                         : 0.0582
    TBM_Reward_Per_Trade_ATR                : 0.0531
    TBM_Risk_Per_Trade_ATR                  : 0.0433
    FVG_Depth_ATR_ZScore                    : 0.0372
    OB_Size_ATR                             : 0.0335
    ChoCH_Detected                          : 0.0324
    BOS_Close_Confirm                       : 0.0312
    FVG_Distance_to_Price_ATR               : 0.0306
    OB_Bullish_Valid                        : 0.0298

📊 Evaluating on Validation set...

  Accuracy: 0.633
  Precision (macro): 0.614
  Recall (macro): 0.780
  F1-Score (macro): 0.643

  Win Rate (excl. timeouts):
    Predicted: 58.3%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          16           1        14
  True Timeout        0           1         0
  True Win            3           0        14

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.633
    Train-Val Gap: 0.367
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.696
  Precision (macro): 0.785
  Recall (macro): 0.675
  F1-Score (macro): 0.714

  Win Rate (excl. timeouts):
    Predicted: 67.4%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          10           0         9
  True Timeout        1           2         0
  True Win            4           0        20

💾 Model pickle saved to /kaggle/working/models/trained/USDCAD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCAD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.3s

🧠 Starting Neural Network training for USDCAD...

================================================================================
Training Neural Network for USDCAD
================================================================================

📂 Loading data for USDCAD...
  Train: 209 samples
  Val:   49 samples
  Test:  46 samples
  Selected 57 features

🧠 Training Neural Network for USDCAD...
  Device: cuda
  Training samples: 209
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 720
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7247, Train Acc: 0.839 | Val Loss: 0.8950, Val Acc: 0.633
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6282, Train Acc: 0.900 | Val Loss: 0.9182, Val Acc: 0.694
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.5895, Train Acc: 0.938 | Val Loss: 0.9120, Val Acc: 0.673

  Early stopping at epoch 36 (patience=30)
Learning curves saved to: models/trained/USDCAD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDCAD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 29.83% (Threshold: 15%)
Total Epochs: 36
Training Duration: 0:00:03.737056

Final Metrics:
  Train Accuracy: 0.9514
  Val Accuracy:   0.6531
  Train Loss:     0.5780
  Val Loss:       0.9380

Best Epoch (Highest Val Accuracy):
  Epoch:          12
  Train Accuracy: 0.8458
  Val Accuracy:   0.7143
  Train Loss:     0.6977
  Val Loss:       0.8927
============================================================


  Final Train Accuracy: 0.951
  Final Val Accuracy:   0.653
  Train-Val Gap:        0.298 (29.8%)

📊 Evaluating on Validation set...

  Accuracy: 0.653
  Precision (macro): 0.557
  Recall (macro): 0.773
  F1-Score (macro): 0.602

  Win Rate (excl. timeouts):
    Predicted: 45.8%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          19           2        10
  True Timeout        0           1         0
  True Win            5           0        12

📊 Evaluating on Test set...

  Accuracy: 0.609
  Precision (macro): 0.511
  Recall (macro): 0.512
  F1-Score (macro): 0.493

  Win Rate (excl. timeouts):
    Predicted: 69.8%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           7           2        10
  True Timeout        1           1         1
  True Win            3           1        20

💾 Model pickle saved to /kaggle/working/models/trained/USDCAD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCAD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDCAD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.9s

🔄 Starting LSTM training for USDCAD...

================================================================================
Training LSTM for USDCAD
================================================================================

📂 Loading data for USDCAD...
  Train: 209 samples
  Val:   49 samples
  Test:  46 samples
  Selected 57 features

🔄 Training LSTM for USDCAD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 209
  Features: 57
  Creating sequences...
  Sequence shape: (189, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.7893, Train Acc: 0.577 | Val Loss: 1.0078, Val Acc: 0.448
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.5090, Train Acc: 0.772 | Val Loss: 1.7202, Val Acc: 0.379
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.5103, Train Acc: 0.857 | Val Loss: 1.7148, Val Acc: 0.345

  Early stopping at epoch 34

  Final Train Accuracy: 0.884
  Final Val Accuracy:   0.448
  Train-Val Gap:        0.435 (43.5%)

📊 Evaluating on Validation set...

  Accuracy: 0.286
  Precision (macro): 0.355
  Recall (macro): 0.526
  F1-Score (macro): 0.257

  Win Rate (excl. timeouts):
    Predicted: 39.6%
    Actual:    35.4%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           7          11        13
  True Timeout        0           1         0
  True Win            3           8         6

📊 Evaluating on Test set...

  Accuracy: 0.304
  Precision (macro): 0.346
  Recall (macro): 0.310
  F1-Score (macro): 0.277

  Win Rate (excl. timeouts):
    Predicted: 32.6%
    Actual:    55.8%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           5           8         6
  True Timeout        1           1         1
  True Win            5          11         8

💾 Model pickle saved to /kaggle/working/models/trained/USDCAD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCAD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDCAD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 5.7s

================================================================================
Symbol USDCAD Training Summary:
  Total Duration: 16.8s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training USDCHF
################################################################################

################################################################################
# Training All Models for USDCHF
################################################################################

🌲 Starting RandomForest training for USDCHF...

================================================================================
Training Random Forest for USDCHF
================================================================================

📂 Loading data for USDCHF...
  Train: 219 samples
  Val:   51 samples
  Test:  48 samples
  Selected 57 features

🌲 Training Random Forest for USDCHF...
  Training samples: 219
  Features: 57

  📊 Dataset has 219 samples (< 300), applying augmentation...
  Augmented: 219 → 696 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for USDCHF...
  Training samples: 556
  Features: 57

  Train accuracy: 0.906
  Val accuracy:   0.879
  Train-Val gap:  0.028
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.879, F1=0.877

🌲 Training Random Forest for USDCHF...
  Training samples: 557
  Features: 57

  Train accuracy: 0.917
  Val accuracy:   0.820
  Train-Val gap:  0.097
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.820, F1=0.816

🌲 Training Random Forest for USDCHF...
  Training samples: 557
  Features: 57

  Train accuracy: 0.914
  Val accuracy:   0.820
  Train-Val gap:  0.094
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.820, F1=0.816

🌲 Training Random Forest for USDCHF...
  Training samples: 557
  Features: 57

  Train accuracy: 0.908
  Val accuracy:   0.799
  Train-Val gap:  0.110
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.799, F1=0.794

🌲 Training Random Forest for USDCHF...
  Training samples: 557
  Features: 57

  Train accuracy: 0.923
  Val accuracy:   0.835
  Train-Val gap:  0.088
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.835, F1=0.833

  Cross-Validation Results:
    Mean Accuracy: 0.830 ± 0.027
    Min Accuracy:  0.799
    Max Accuracy:  0.879
    Range:         0.080
    Mean F1-Score: 0.827 ± 0.028
    ✅ STABLE: Std dev 0.027 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.799 (deviation: -0.032)

  Train accuracy: 0.976
  Val accuracy:   0.627
  Train-Val gap:  0.348
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    Distance_to_Entry_ATR                   : 0.1089
    TBM_Bars_to_Hit                         : 0.0883
    TBM_Reward_Per_Trade_ATR                : 0.0875
    TBM_Risk_Per_Trade_ATR                  : 0.0825
    OB_Age                                  : 0.0496
    FVG_Depth_ATR                           : 0.0463
    FVG_Depth_ATR_ZScore                    : 0.0452
    FVG_Distance_to_Price_ATR               : 0.0378
    FVG_Quality_Fuzzy                       : 0.0373
    FVG_Size_Fuzzy_Score                    : 0.0362

📊 Evaluating on Validation set...

  Accuracy: 0.627
  Precision (macro): 0.563
  Recall (macro): 0.679
  F1-Score (macro): 0.593

  Win Rate (excl. timeouts):
    Predicted: 54.3%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           7           0         4
  True Timeout        0           4         1
  True Win            9           5        21

  Overfitting Analysis:
    Training Accuracy: 0.976
    Validation Accuracy: 0.627
    Train-Val Gap: 0.348
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.812
  Precision (macro): 0.875
  Recall (macro): 0.717
  F1-Score (macro): 0.767

  Win Rate (excl. timeouts):
    Predicted: 45.7%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          20           0         3
  True Timeout        1           1         0
  True Win            5           0        18

💾 Model pickle saved to /kaggle/working/models/trained/USDCHF_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCHF_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.0s

🚀 Starting XGBoost training for USDCHF...

================================================================================
Training XGBoost for USDCHF
================================================================================

📂 Loading data for USDCHF...
  Train: 219 samples
  Val:   51 samples
  Test:  48 samples
  Selected 57 features

🚀 Training XGBoost for USDCHF...
  Training samples: 219
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.745
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1009
    Distance_to_Entry_ATR                   : 0.0596
    TBM_Bars_to_Hit                         : 0.0562
    FVG_Depth_ATR                           : 0.0473
    TBM_Reward_Per_Trade_ATR                : 0.0367
    OB_Size_ATR                             : 0.0366
    TBM_Risk_Per_Trade_ATR                  : 0.0347
    FVG_Distance_to_Price_ATR               : 0.0333
    FVG_Distance_to_Price_ATR_ZScore        : 0.0287
    OB_Size_ATR_ZScore                      : 0.0281

📊 Evaluating on Validation set...

  Accuracy: 0.745
  Precision (macro): 0.664
  Recall (macro): 0.777
  F1-Score (macro): 0.700

  Win Rate (excl. timeouts):
    Predicted: 58.7%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           0         2
  True Timeout        0           4         1
  True Win            6           4        25

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.745
    Train-Val Gap: 0.255
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.667
  Precision (macro): 0.616
  Recall (macro): 0.616
  F1-Score (macro): 0.616

  Win Rate (excl. timeouts):
    Predicted: 50.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          15           1         7
  True Timeout        1           1         0
  True Win            7           0        16

💾 Model pickle saved to /kaggle/working/models/trained/USDCHF_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCHF_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.2s

🧠 Starting Neural Network training for USDCHF...

================================================================================
Training Neural Network for USDCHF
================================================================================

📂 Loading data for USDCHF...
  Train: 219 samples
  Val:   51 samples
  Test:  48 samples
  Selected 57 features

🧠 Training Neural Network for USDCHF...
  Device: cuda
  Training samples: 219
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 696
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7118, Train Acc: 0.820 | Val Loss: 0.8738, Val Acc: 0.706
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6583, Train Acc: 0.868 | Val Loss: 0.9460, Val Acc: 0.608
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6031, Train Acc: 0.924 | Val Loss: 0.8900, Val Acc: 0.706

  Early stopping at epoch 38 (patience=30)
Learning curves saved to: models/trained/USDCHF_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDCHF_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 27.44% (Threshold: 15%)
Total Epochs: 38
Training Duration: 0:00:03.853252

Final Metrics:
  Train Accuracy: 0.9411
  Val Accuracy:   0.6667
  Train Loss:     0.5891
  Val Loss:       0.9120

Best Epoch (Highest Val Accuracy):
  Epoch:          7
  Train Accuracy: 0.7931
  Val Accuracy:   0.7451
  Train Loss:     0.7439
  Val Loss:       0.8238
============================================================


  Final Train Accuracy: 0.941
  Final Val Accuracy:   0.667
  Train-Val Gap:        0.274 (27.4%)

📊 Evaluating on Validation set...

  Accuracy: 0.667
  Precision (macro): 0.579
  Recall (macro): 0.635
  F1-Score (macro): 0.600

  Win Rate (excl. timeouts):
    Predicted: 71.7%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           4           0         7
  True Timeout        0           4         1
  True Win            6           3        26

📊 Evaluating on Test set...

  Accuracy: 0.604
  Precision (macro): 0.409
  Recall (macro): 0.420
  F1-Score (macro): 0.406

  Win Rate (excl. timeouts):
    Predicted: 65.2%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          11           0        12
  True Timeout        1           0         1
  True Win            5           0        18

💾 Model pickle saved to /kaggle/working/models/trained/USDCHF_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCHF_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDCHF_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 4.8s

🔄 Starting LSTM training for USDCHF...

================================================================================
Training LSTM for USDCHF
================================================================================

📂 Loading data for USDCHF...
  Train: 219 samples
  Val:   51 samples
  Test:  48 samples
  Selected 57 features

🔄 Training LSTM for USDCHF...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 219
  Features: 57
  Creating sequences...
  Sequence shape: (199, 20, 57)
  Epoch 10/200 - LR: 0.001045 - Train Loss: 0.6865, Train Acc: 0.683 | Val Loss: 0.8021, Val Acc: 0.484
  Epoch 20/200 - LR: 0.002806 - Train Loss: 0.5735, Train Acc: 0.764 | Val Loss: 1.5050, Val Acc: 0.355
  Epoch 30/200 - LR: 0.005210 - Train Loss: 0.5857, Train Acc: 0.819 | Val Loss: 0.7977, Val Acc: 0.613

  Early stopping at epoch 33

  Final Train Accuracy: 0.869
  Final Val Accuracy:   0.581
  Train-Val Gap:        0.289 (28.9%)

📊 Evaluating on Validation set...

  Accuracy: 0.451
  Precision (macro): 0.467
  Recall (macro): 0.629
  F1-Score (macro): 0.444

  Win Rate (excl. timeouts):
    Predicted: 34.8%
    Actual:    76.1%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6           1         4
  True Timeout        0           5         0
  True Win            9          14        12

📊 Evaluating on Test set...

  Accuracy: 0.354
  Precision (macro): 0.381
  Recall (macro): 0.551
  F1-Score (macro): 0.325

  Win Rate (excl. timeouts):
    Predicted: 37.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           5          11         7
  True Timeout        0           2         0
  True Win            6           7        10

💾 Model pickle saved to /kaggle/working/models/trained/USDCHF_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDCHF_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDCHF_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 6.1s

================================================================================
Symbol USDCHF Training Summary:
  Total Duration: 17.1s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training USDJPY
################################################################################

################################################################################
# Training All Models for USDJPY
################################################################################

🌲 Starting RandomForest training for USDJPY...

================================================================================
Training Random Forest for USDJPY
================================================================================

📂 Loading data for USDJPY...
  Train: 295 samples
  Val:   55 samples
  Test:  55 samples
  Selected 57 features

🌲 Training Random Forest for USDJPY...
  Training samples: 295
  Features: 57

  📊 Dataset has 295 samples (< 300), applying augmentation...
  Augmented: 295 → 936 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for USDJPY...
  Training samples: 748
  Features: 57

  Train accuracy: 0.909
  Val accuracy:   0.809
  Train-Val gap:  0.101
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.809, F1=0.806

🌲 Training Random Forest for USDJPY...
  Training samples: 749
  Features: 57

  Train accuracy: 0.912
  Val accuracy:   0.840
  Train-Val gap:  0.072
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.840, F1=0.839

🌲 Training Random Forest for USDJPY...
  Training samples: 749
  Features: 57

  Train accuracy: 0.920
  Val accuracy:   0.856
  Train-Val gap:  0.064
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.856, F1=0.856

🌲 Training Random Forest for USDJPY...
  Training samples: 749
  Features: 57

  Train accuracy: 0.912
  Val accuracy:   0.786
  Train-Val gap:  0.126
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.786, F1=0.785

🌲 Training Random Forest for USDJPY...
  Training samples: 749
  Features: 57

  Train accuracy: 0.912
  Val accuracy:   0.856
  Train-Val gap:  0.056
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.856, F1=0.854

  Cross-Validation Results:
    Mean Accuracy: 0.829 ± 0.028
    Min Accuracy:  0.786
    Max Accuracy:  0.856
    Range:         0.070
    Mean F1-Score: 0.828 ± 0.028
    ✅ STABLE: Std dev 0.028 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.786 (deviation: -0.043)

  Train accuracy: 0.987
  Val accuracy:   0.782
  Train-Val gap:  0.205
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Bars_to_Hit                         : 0.1300
    TBM_Risk_Per_Trade_ATR                  : 0.0779
    OB_Age                                  : 0.0772
    TBM_Reward_Per_Trade_ATR                : 0.0722
    Distance_to_Entry_ATR                   : 0.0665
    FVG_Distance_to_Price_ATR               : 0.0389
    FVG_Size_Fuzzy_Score                    : 0.0378
    FVG_Quality_Fuzzy                       : 0.0342
    FVG_Distance_to_Price_ATR_ZScore        : 0.0307
    FVG_Depth_ATR_ZScore                    : 0.0283

📊 Evaluating on Validation set...

  Accuracy: 0.782
  Precision (macro): 0.789
  Recall (macro): 0.787
  F1-Score (macro): 0.786

  Win Rate (excl. timeouts):
    Predicted: 44.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          21           0         4
  True Timeout        1           4         0
  True Win            6           1        18

  Overfitting Analysis:
    Training Accuracy: 0.987
    Validation Accuracy: 0.782
    Train-Val Gap: 0.205
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.745
  Precision (macro): 0.725
  Recall (macro): 0.839
  F1-Score (macro): 0.761

  Win Rate (excl. timeouts):
    Predicted: 47.2%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          17           0         3
  True Timeout        0           2         0
  True Win           10           1        22

💾 Model pickle saved to /kaggle/working/models/trained/USDJPY_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDJPY_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.1s

🚀 Starting XGBoost training for USDJPY...

================================================================================
Training XGBoost for USDJPY
================================================================================

📂 Loading data for USDJPY...
  Train: 295 samples
  Val:   55 samples
  Test:  55 samples
  Selected 57 features

🚀 Training XGBoost for USDJPY...
  Training samples: 295
  Features: 57

  Train accuracy: 0.997
  Val accuracy:   0.691
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.1028
    OB_Bullish_Valid                        : 0.0672
    FVG_Distance_to_Price_ATR               : 0.0450
    TBM_Bars_to_Hit                         : 0.0447
    TBM_Reward_Per_Trade_ATR                : 0.0443
    Distance_to_Entry_ATR                   : 0.0340
    BOS_Wick_Confirm                        : 0.0297
    TBM_Risk_Per_Trade_ATR                  : 0.0290
    OB_Bearish_Valid                        : 0.0250
    FVG_Quality_Fuzzy                       : 0.0246

📊 Evaluating on Validation set...

  Accuracy: 0.691
  Precision (macro): 0.707
  Recall (macro): 0.667
  F1-Score (macro): 0.684

  Win Rate (excl. timeouts):
    Predicted: 52.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          17           0         8
  True Timeout        2           3         0
  True Win            6           1        18

  Overfitting Analysis:
    Training Accuracy: 0.997
    Validation Accuracy: 0.691
    Train-Val Gap: 0.306
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.673
  Precision (macro): 0.611
  Recall (macro): 0.616
  F1-Score (macro): 0.612

  Win Rate (excl. timeouts):
    Predicted: 56.6%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          13           0         7
  True Timeout        1           1         0
  True Win            9           1        23

💾 Model pickle saved to /kaggle/working/models/trained/USDJPY_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDJPY_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.3s

🧠 Starting Neural Network training for USDJPY...

================================================================================
Training Neural Network for USDJPY
================================================================================

📂 Loading data for USDJPY...
  Train: 295 samples
  Val:   55 samples
  Test:  55 samples
  Selected 57 features

🧠 Training Neural Network for USDJPY...
  Device: cuda
  Training samples: 295
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 936
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7393, Train Acc: 0.808 | Val Loss: 0.8941, Val Acc: 0.691
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6642, Train Acc: 0.869 | Val Loss: 0.9745, Val Acc: 0.600
  Epoch 30/200 - LR: 0.001250 - Train Loss: 0.6378, Train Acc: 0.899 | Val Loss: 0.9693, Val Acc: 0.655

  Early stopping at epoch 37 (patience=30)
Learning curves saved to: models/trained/USDJPY_NN_learning_curves.png
Overfitting metrics saved to: models/trained/USDJPY_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 30.49% (Threshold: 15%)
Total Epochs: 37
Training Duration: 0:00:04.814986

Final Metrics:
  Train Accuracy: 0.9049
  Val Accuracy:   0.6000
  Train Loss:     0.6219
  Val Loss:       1.0087

Best Epoch (Highest Val Accuracy):
  Epoch:          13
  Train Accuracy: 0.8312
  Val Accuracy:   0.7091
  Train Loss:     0.7154
  Val Loss:       0.9216
============================================================


  Final Train Accuracy: 0.905
  Final Val Accuracy:   0.600
  Train-Val Gap:        0.305 (30.5%)

📊 Evaluating on Validation set...

  Accuracy: 0.600
  Precision (macro): 0.594
  Recall (macro): 0.653
  F1-Score (macro): 0.589

  Win Rate (excl. timeouts):
    Predicted: 68.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           9           2        14
  True Timeout        1           4         0
  True Win            3           2        20

📊 Evaluating on Test set...

  Accuracy: 0.727
  Precision (macro): 0.642
  Recall (macro): 0.783
  F1-Score (macro): 0.659

  Win Rate (excl. timeouts):
    Predicted: 69.8%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          10           1         9
  True Timeout        0           2         0
  True Win            3           2        28

💾 Model pickle saved to /kaggle/working/models/trained/USDJPY_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDJPY_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDJPY_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 5.8s

🔄 Starting LSTM training for USDJPY...

================================================================================
Training LSTM for USDJPY
================================================================================

📂 Loading data for USDJPY...
  Train: 295 samples
  Val:   55 samples
  Test:  55 samples
  Selected 57 features

🔄 Training LSTM for USDJPY...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 295
  Features: 57
  Creating sequences...
  Sequence shape: (275, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.7654, Train Acc: 0.640 | Val Loss: 1.2655, Val Acc: 0.429
  Epoch 20/200 - LR: 0.002804 - Train Loss: 0.6400, Train Acc: 0.731 | Val Loss: 1.6852, Val Acc: 0.343
⚠️ Epoch 25: Exploding gradient detected (norm=14.57 > 10.0)
⚠️ Epoch 29: Exploding gradient detected (norm=10.77 > 10.0)
  Epoch 30/200 - LR: 0.005207 - Train Loss: 0.4750, Train Acc: 0.858 | Val Loss: 2.6158, Val Acc: 0.371
⚠️ Epoch 31: Exploding gradient detected (norm=20.78 > 10.0)

  Early stopping at epoch 33

  ⚠️ Training Warnings (3):
    - Epoch 25: Exploding gradient detected (norm=14.57 > 10.0)
    - Epoch 29: Exploding gradient detected (norm=10.77 > 10.0)
    - Epoch 31: Exploding gradient detected (norm=20.78 > 10.0)

  Final Train Accuracy: 0.895
  Final Val Accuracy:   0.457
  Train-Val Gap:        0.437 (43.7%)

📊 Evaluating on Validation set...

  Accuracy: 0.327
  Precision (macro): 0.351
  Recall (macro): 0.347
  F1-Score (macro): 0.303

  Win Rate (excl. timeouts):
    Predicted: 38.0%
    Actual:    50.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           6          10         9
  True Timeout        2           2         1
  True Win            5          10        10

📊 Evaluating on Test set...

  Accuracy: 0.418
  Precision (macro): 0.425
  Recall (macro): 0.265
  F1-Score (macro): 0.322

  Win Rate (excl. timeouts):
    Predicted: 43.4%
    Actual:    62.3%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           5          10         5
  True Timeout        0           0         2
  True Win            4          11        18

💾 Model pickle saved to /kaggle/working/models/trained/USDJPY_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/USDJPY_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/USDJPY_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 7.5s

================================================================================
Symbol USDJPY Training Summary:
  Total Duration: 19.7s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

################################################################################
# Training XAUUSD
################################################################################

################################################################################
# Training All Models for XAUUSD
################################################################################

🌲 Starting RandomForest training for XAUUSD...

================================================================================
Training Random Forest for XAUUSD
================================================================================

📂 Loading data for XAUUSD...
  Train: 271 samples
  Val:   63 samples
  Test:  66 samples
  Selected 57 features

🌲 Training Random Forest for XAUUSD...
  Training samples: 271
  Features: 57

  📊 Dataset has 271 samples (< 300), applying augmentation...
  Augmented: 271 → 906 samples

  🔄 Performing cross-validation...

🔄 Performing 5-fold cross-validation...

🌲 Training Random Forest for XAUUSD...
  Training samples: 724
  Features: 57

  Train accuracy: 0.913
  Val accuracy:   0.830
  Train-Val gap:  0.083
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 1/5: Accuracy=0.830, F1=0.828

🌲 Training Random Forest for XAUUSD...
  Training samples: 725
  Features: 57

  Train accuracy: 0.931
  Val accuracy:   0.878
  Train-Val gap:  0.053
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 2/5: Accuracy=0.878, F1=0.877

🌲 Training Random Forest for XAUUSD...
  Training samples: 725
  Features: 57

  Train accuracy: 0.923
  Val accuracy:   0.856
  Train-Val gap:  0.066
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 3/5: Accuracy=0.856, F1=0.854

🌲 Training Random Forest for XAUUSD...
  Training samples: 725
  Features: 57

  Train accuracy: 0.946
  Val accuracy:   0.818
  Train-Val gap:  0.129
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 4/5: Accuracy=0.818, F1=0.814

🌲 Training Random Forest for XAUUSD...
  Training samples: 725
  Features: 57

  Train accuracy: 0.926
  Val accuracy:   0.834
  Train-Val gap:  0.091
  ✅ Good generalization (gap ≤ 15%)

  Feature importance computed (feature names not available)
  Fold 5/5: Accuracy=0.834, F1=0.834

  Cross-Validation Results:
    Mean Accuracy: 0.843 ± 0.022
    Min Accuracy:  0.818
    Max Accuracy:  0.878
    Range:         0.061
    Mean F1-Score: 0.841 ± 0.022
    ✅ STABLE: Std dev 0.022 ≤ 0.10

    Poor-Performing Folds (below mean - std):
      Fold 4: 0.818 (deviation: -0.026)

  Train accuracy: 0.981
  Val accuracy:   0.619
  Train-Val gap:  0.362
  ⚠️ Warning: Overfitting detected (gap > 15%)

  Top 10 Most Important Features:
    TBM_Risk_Per_Trade_ATR                  : 0.1009
    TBM_Reward_Per_Trade_ATR                : 0.0954
    TBM_Bars_to_Hit                         : 0.0916
    Distance_to_Entry_ATR                   : 0.0737
    OB_Age                                  : 0.0588
    FVG_Distance_to_Price_ATR               : 0.0487
    FVG_Depth_ATR                           : 0.0429
    FVG_Quality_Fuzzy                       : 0.0380
    FVG_Distance_to_Price_ATR_ZScore        : 0.0342
    FVG_Size_Fuzzy_Score                    : 0.0324

📊 Evaluating on Validation set...

  Accuracy: 0.619
  Precision (macro): 0.428
  Recall (macro): 0.422
  F1-Score (macro): 0.423

  Win Rate (excl. timeouts):
    Predicted: 45.2%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          20           0         9
  True Timeout        1           0         0
  True Win           12           2        19

  Overfitting Analysis:
    Training Accuracy: 0.981
    Validation Accuracy: 0.619
    Train-Val Gap: 0.362
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.545
  Precision (macro): 0.598
  Recall (macro): 0.275
  F1-Score (macro): 0.292

  Win Rate (excl. timeouts):
    Predicted: 77.8%
    Actual:    100.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           0           0         0
  True Timeout       11           1         9
  True Win           10           0        35

💾 Model pickle saved to /kaggle/working/models/trained/XAUUSD_RandomForest.pkl
💾 Metadata saved to /kaggle/working/models/trained/XAUUSD_RandomForest_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ RandomForest completed in 5.2s

🚀 Starting XGBoost training for XAUUSD...

================================================================================
Training XGBoost for XAUUSD
================================================================================

📂 Loading data for XAUUSD...
  Train: 271 samples
  Val:   63 samples
  Test:  66 samples
  Selected 57 features

🚀 Training XGBoost for XAUUSD...
  Training samples: 271
  Features: 57

  Train accuracy: 1.000
  Val accuracy:   0.619
  Best iteration: 200

  Top 10 Most Important Features:
    OB_Age                                  : 0.0801
    FVG_Depth_ATR                           : 0.0502
    TBM_Bars_to_Hit                         : 0.0452
    TBM_Reward_Per_Trade_ATR                : 0.0396
    TBM_Risk_Per_Trade_ATR                  : 0.0396
    FVG_Distance_to_Price_ATR               : 0.0354
    ChoCH_Detected                          : 0.0336
    Distance_to_Entry_ATR                   : 0.0317
    FVG_Distance_to_Price_ATR_ZScore        : 0.0314
    OB_Displacement_ATR                     : 0.0263

📊 Evaluating on Validation set...

  Accuracy: 0.619
  Precision (macro): 0.433
  Recall (macro): 0.419
  F1-Score (macro): 0.426

  Win Rate (excl. timeouts):
    Predicted: 51.6%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          18           0        11
  True Timeout        1           0         0
  True Win            9           3        21

  Overfitting Analysis:
    Training Accuracy: 1.000
    Validation Accuracy: 0.619
    Train-Val Gap: 0.381
    ⚠️ OVERFITTING DETECTED (gap > 15%)

📊 Evaluating on Test set...

  Accuracy: 0.561
  Precision (macro): 0.262
  Recall (macro): 0.274
  F1-Score (macro): 0.268

  Win Rate (excl. timeouts):
    Predicted: 82.2%
    Actual:    100.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           0           0         0
  True Timeout       11           0        10
  True Win            8           0        37

💾 Model pickle saved to /kaggle/working/models/trained/XAUUSD_XGBoost.pkl
💾 Metadata saved to /kaggle/working/models/trained/XAUUSD_XGBoost_metadata.json

✅ Model save complete: /kaggle/working/models/trained
✅ XGBoost completed in 1.3s

🧠 Starting Neural Network training for XAUUSD...

================================================================================
Training Neural Network for XAUUSD
================================================================================

📂 Loading data for XAUUSD...
  Train: 271 samples
  Val:   63 samples
  Test:  66 samples
  Selected 57 features

🧠 Training Neural Network for XAUUSD...
  Device: cuda
  Training samples: 271
  Features: 57
  Architecture: 57 -> 512 -> 256 -> 128 -> 64 -> 3

  Dataset has < 300 samples. Applying data augmentation...
  Augmented training samples: 906
  Epoch 10/200 - LR: 0.010000 - Train Loss: 0.7332, Train Acc: 0.804 | Val Loss: 0.9782, Val Acc: 0.524
  Epoch 20/200 - LR: 0.002500 - Train Loss: 0.6414, Train Acc: 0.886 | Val Loss: 1.0140, Val Acc: 0.587
  Epoch 30/200 - LR: 0.000625 - Train Loss: 0.6286, Train Acc: 0.902 | Val Loss: 1.0158, Val Acc: 0.587

  Early stopping at epoch 36 (patience=30)
Learning curves saved to: models/trained/XAUUSD_NN_learning_curves.png
Overfitting metrics saved to: models/trained/XAUUSD_NN_overfitting_metrics.json

============================================================
OVERFITTING MONITOR SUMMARY
============================================================
Status: ⚠ WARNING
Train-Val Gap: 30.19% (Threshold: 15%)
Total Epochs: 36
Training Duration: 0:00:04.676304

Final Metrics:
  Train Accuracy: 0.9051
  Val Accuracy:   0.6032
  Train Loss:     0.6263
  Val Loss:       1.0393

Best Epoch (Highest Val Accuracy):
  Epoch:          17
  Train Accuracy: 0.8565
  Val Accuracy:   0.6032
  Train Loss:     0.6704
  Val Loss:       0.9730
============================================================


  Final Train Accuracy: 0.905
  Final Val Accuracy:   0.603
  Train-Val Gap:        0.302 (30.2%)

📊 Evaluating on Validation set...

  Accuracy: 0.603
  Precision (macro): 0.430
  Recall (macro): 0.414
  F1-Score (macro): 0.413

  Win Rate (excl. timeouts):
    Predicted: 37.1%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss          22           0         7
  True Timeout        1           0         0
  True Win           14           3        16

📊 Evaluating on Test set...

  Accuracy: 0.394
  Precision (macro): 0.565
  Recall (macro): 0.201
  F1-Score (macro): 0.236

  Win Rate (excl. timeouts):
    Predicted: 55.6%
    Actual:    100.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           0           0         0
  True Timeout        9           1        11
  True Win           20           0        25

💾 Model pickle saved to /kaggle/working/models/trained/XAUUSD_NeuralNetwork.pkl
💾 Metadata saved to /kaggle/working/models/trained/XAUUSD_NeuralNetwork_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/XAUUSD_NeuralNetwork_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ Neural Network completed in 5.7s

🔄 Starting LSTM training for XAUUSD...

================================================================================
Training LSTM for XAUUSD
================================================================================

📂 Loading data for XAUUSD...
  Train: 271 samples
  Val:   63 samples
  Test:  66 samples
  Selected 57 features

🔄 Training LSTM for XAUUSD...
  Device: cuda
  Lookback window: 20 candles
  Training samples: 271
  Features: 57
  Creating sequences...
  Sequence shape: (251, 20, 57)
  Epoch 10/200 - LR: 0.001044 - Train Loss: 0.7230, Train Acc: 0.665 | Val Loss: 0.9309, Val Acc: 0.465
  Epoch 20/200 - LR: 0.002805 - Train Loss: 0.4992, Train Acc: 0.773 | Val Loss: 1.9961, Val Acc: 0.419
  Epoch 30/200 - LR: 0.005208 - Train Loss: 0.5076, Train Acc: 0.849 | Val Loss: 1.3808, Val Acc: 0.465

  Early stopping at epoch 32

  Final Train Accuracy: 0.857
  Final Val Accuracy:   0.372
  Train-Val Gap:        0.484 (48.4%)

📊 Evaluating on Validation set...

  Accuracy: 0.270
  Precision (macro): 0.259
  Recall (macro): 0.501
  F1-Score (macro): 0.224

  Win Rate (excl. timeouts):
    Predicted: 43.5%
    Actual:    53.2%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           4          10        15
  True Timeout        0           1         0
  True Win           10          11        12

📊 Evaluating on Test set...

  Accuracy: 0.500
  Precision (macro): 0.400
  Recall (macro): 0.329
  F1-Score (macro): 0.356

  Win Rate (excl. timeouts):
    Predicted: 51.1%
    Actual:    100.0%

  Confusion Matrix:
              Pred Loss  Pred Timeout  Pred Win
  True Loss           0           0         0
  True Timeout        4          10         7
  True Win            9          13        23

💾 Model pickle saved to /kaggle/working/models/trained/XAUUSD_LSTM.pkl
💾 Metadata saved to /kaggle/working/models/trained/XAUUSD_LSTM_metadata.json
💾 Scaler saved to /kaggle/working/models/trained/XAUUSD_LSTM_scaler.pkl

✅ Model save complete: /kaggle/working/models/trained
✅ LSTM completed in 6.7s

================================================================================
Symbol XAUUSD Training Summary:
  Total Duration: 18.9s
  Successful Models: 4/4
  Failed Models: 0/4
================================================================================

================================================================================
✅ TRAINING COMPLETE!
================================================================================

Results: 44/44 models successful

Download from Output tab:
  - training_results.json
  - models/trained/*.pkl files
  - models/trained/*_metadata.json files